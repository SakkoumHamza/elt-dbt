[0m18:20:43.883029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c7460>]}


============================== 18:20:43.888525 | 23021954-9c6e-45f0-9b77-d8efe06d46fe ==============================
[0m18:20:43.888525 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:20:43.889257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init first_elt', 'send_anonymous_usage_stats': 'True'}
[0m18:20:43.900748 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object.. Dictionary: {'dir': PosixPath('/Users/mac/.dbt')}
[0m18:20:43.901327 [info ] [MainThread]: Creating dbt configuration folder at 
[0m18:20:43.902946 [debug] [MainThread]: Starter project path: /opt/anaconda3/envs/DE/lib/python3.9/site-packages/dbt/include/starter_project
[0m18:20:43.909355 [info ] [MainThread]: 
Your new dbt project "first_elt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m18:20:43.909885 [info ] [MainThread]: Setting up your profile.
[0m18:26:40.084544 [info ] [MainThread]: Profile first_elt written to /Users/mac/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m18:26:40.977863 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 357.1547, "process_in_blocks": "0", "process_kernel_time": 0.14888, "process_mem_max_rss": "95358976", "process_out_blocks": "0", "process_user_time": 1.319682}
[0m18:26:40.978639 [debug] [MainThread]: Command `dbt init` succeeded at 18:26:40.978484 after 357.16 seconds
[0m18:26:40.979232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11239ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112145610>]}
[0m18:26:40.979802 [debug] [MainThread]: Flushing usage events
[0m18:26:41.754342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:04.420052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a436a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b759d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b759460>]}


============================== 18:27:04.425320 | 2ebcf01c-20bd-428b-ade3-764584977c90 ==============================
[0m18:27:04.425320 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:27:04.426149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:27:04.445532 [info ] [MainThread]: dbt version: 1.9.4
[0m18:27:04.446078 [info ] [MainThread]: python version: 3.9.21
[0m18:27:04.446523 [info ] [MainThread]: python path: /opt/anaconda3/envs/DE/bin/python
[0m18:27:04.446962 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:27:04.519589 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m18:27:04.520102 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m18:27:04.520493 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Documents/Projets /DE/dbt_project.yml
[0m18:27:04.521327 [info ] [MainThread]: adapter type: postgres
[0m18:27:04.521749 [info ] [MainThread]: adapter version: 1.9.0
[0m18:27:04.522155 [info ] [MainThread]: Configuration:
[0m18:27:04.522544 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:27:04.523049 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:27:04.523430 [info ] [MainThread]: Required dependencies:
[0m18:27:04.523875 [debug] [MainThread]: Executing "git --help"
[0m18:27:04.537713 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:27:04.538800 [debug] [MainThread]: STDERR: "b''"
[0m18:27:04.539329 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:27:04.539836 [info ] [MainThread]: Connection:
[0m18:27:04.540360 [info ] [MainThread]:   host: localhost
[0m18:27:04.540789 [info ] [MainThread]:   port: 5432
[0m18:27:04.541207 [info ] [MainThread]:   user: mac
[0m18:27:04.541626 [info ] [MainThread]:   database: elt_project
[0m18:27:04.542046 [info ] [MainThread]:   schema: public
[0m18:27:04.542466 [info ] [MainThread]:   connect_timeout: 10
[0m18:27:04.542952 [info ] [MainThread]:   role: None
[0m18:27:04.543420 [info ] [MainThread]:   search_path: None
[0m18:27:04.543839 [info ] [MainThread]:   keepalives_idle: 0
[0m18:27:04.544253 [info ] [MainThread]:   sslmode: None
[0m18:27:04.544836 [info ] [MainThread]:   sslcert: None
[0m18:27:04.545307 [info ] [MainThread]:   sslkey: None
[0m18:27:04.545732 [info ] [MainThread]:   sslrootcert: None
[0m18:27:04.546149 [info ] [MainThread]:   application_name: dbt
[0m18:27:04.546570 [info ] [MainThread]:   retries: 1
[0m18:27:04.547417 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:27:06.192676 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:27:06.274295 [debug] [MainThread]: Using postgres connection "debug"
[0m18:27:06.274783 [debug] [MainThread]: On debug: select 1 as id
[0m18:27:06.275176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:06.331100 [debug] [MainThread]: SQL status: SELECT 1 in 0.056 seconds
[0m18:27:06.332355 [debug] [MainThread]: On debug: Close
[0m18:27:06.332880 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:27:06.333371 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:27:06.333820 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/mac/Documents/Projets /DE/dbt_project.yml> not found

[0m18:27:06.336635 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.993278, "process_in_blocks": "0", "process_kernel_time": 0.353694, "process_mem_max_rss": "103845888", "process_out_blocks": "0", "process_user_time": 1.761165}
[0m18:27:06.337261 [debug] [MainThread]: Command `dbt debug` failed at 18:27:06.337116 after 1.99 seconds
[0m18:27:06.337764 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:27:06.338275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a436a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b722580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba70e20>]}
[0m18:27:06.339021 [debug] [MainThread]: Flushing usage events
[0m18:27:07.002521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:28.659892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107073b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108397ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083973a0>]}


============================== 18:29:28.663990 | 2d643654-5fb9-483a-8da8-eac7cdc612b8 ==============================
[0m18:29:28.663990 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:29:28.664658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:29:28.675984 [info ] [MainThread]: dbt version: 1.9.4
[0m18:29:28.676557 [info ] [MainThread]: python version: 3.9.21
[0m18:29:28.677071 [info ] [MainThread]: python path: /opt/anaconda3/envs/DE/bin/python
[0m18:29:28.677540 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:29:28.738898 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m18:29:28.739410 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m18:29:28.739837 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Documents/Projets/DE/dbt_project.yml
[0m18:29:28.740467 [info ] [MainThread]: adapter type: postgres
[0m18:29:28.740903 [info ] [MainThread]: adapter version: 1.9.0
[0m18:29:28.741336 [info ] [MainThread]: Configuration:
[0m18:29:28.741752 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:29:28.742168 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:29:28.742693 [info ] [MainThread]: Required dependencies:
[0m18:29:28.743297 [debug] [MainThread]: Executing "git --help"
[0m18:29:28.754625 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:29:28.755675 [debug] [MainThread]: STDERR: "b''"
[0m18:29:28.756173 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:29:28.756679 [info ] [MainThread]: Connection:
[0m18:29:28.757234 [info ] [MainThread]:   host: localhost
[0m18:29:28.757677 [info ] [MainThread]:   port: 5432
[0m18:29:28.758084 [info ] [MainThread]:   user: mac
[0m18:29:28.758526 [info ] [MainThread]:   database: elt_project
[0m18:29:28.759007 [info ] [MainThread]:   schema: public
[0m18:29:28.759424 [info ] [MainThread]:   connect_timeout: 10
[0m18:29:28.759848 [info ] [MainThread]:   role: None
[0m18:29:28.760277 [info ] [MainThread]:   search_path: None
[0m18:29:28.760787 [info ] [MainThread]:   keepalives_idle: 0
[0m18:29:28.761412 [info ] [MainThread]:   sslmode: None
[0m18:29:28.762101 [info ] [MainThread]:   sslcert: None
[0m18:29:28.762682 [info ] [MainThread]:   sslkey: None
[0m18:29:28.763178 [info ] [MainThread]:   sslrootcert: None
[0m18:29:28.763597 [info ] [MainThread]:   application_name: dbt
[0m18:29:28.764009 [info ] [MainThread]:   retries: 1
[0m18:29:28.764809 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:29:28.870166 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:29:28.917468 [debug] [MainThread]: Using postgres connection "debug"
[0m18:29:28.917961 [debug] [MainThread]: On debug: select 1 as id
[0m18:29:28.918361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:28.955652 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m18:29:28.956867 [debug] [MainThread]: On debug: Close
[0m18:29:28.957471 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:29:28.957980 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:29:28.958424 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/mac/Documents/Projets/DE/dbt_project.yml> not found

[0m18:29:28.961254 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.36583892, "process_in_blocks": "0", "process_kernel_time": 0.215429, "process_mem_max_rss": "103976960", "process_out_blocks": "0", "process_user_time": 1.433791}
[0m18:29:28.961910 [debug] [MainThread]: Command `dbt debug` failed at 18:29:28.961772 after 0.37 seconds
[0m18:29:28.962425 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:29:28.962930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107073b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879eb50>]}
[0m18:29:28.963502 [debug] [MainThread]: Flushing usage events
[0m18:29:35.100906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:10.594816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e68cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e683d0>]}


============================== 18:30:10.598903 | ad93dbb8-175f-4734-aebf-defb340ef495 ==============================
[0m18:30:10.598903 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:30:10.599584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:10.611326 [info ] [MainThread]: dbt version: 1.9.4
[0m18:30:10.611877 [info ] [MainThread]: python version: 3.9.21
[0m18:30:10.612321 [info ] [MainThread]: python path: /opt/anaconda3/envs/DE/bin/python
[0m18:30:10.612756 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:30:10.674825 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m18:30:10.675453 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m18:30:10.675937 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Documents/Projets/DE/dbt_project.yml
[0m18:30:10.676554 [info ] [MainThread]: adapter type: postgres
[0m18:30:10.677024 [info ] [MainThread]: adapter version: 1.9.0
[0m18:30:10.677464 [info ] [MainThread]: Configuration:
[0m18:30:10.677877 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:30:10.678286 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:30:10.678635 [info ] [MainThread]: Required dependencies:
[0m18:30:10.679104 [debug] [MainThread]: Executing "git --help"
[0m18:30:10.690579 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:30:10.691635 [debug] [MainThread]: STDERR: "b''"
[0m18:30:10.692150 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:30:10.692633 [info ] [MainThread]: Connection:
[0m18:30:10.693156 [info ] [MainThread]:   host: localhost
[0m18:30:10.693583 [info ] [MainThread]:   port: 5432
[0m18:30:10.694062 [info ] [MainThread]:   user: mac
[0m18:30:10.694680 [info ] [MainThread]:   database: elt_project
[0m18:30:10.695256 [info ] [MainThread]:   schema: public
[0m18:30:10.695709 [info ] [MainThread]:   connect_timeout: 10
[0m18:30:10.696129 [info ] [MainThread]:   role: None
[0m18:30:10.696542 [info ] [MainThread]:   search_path: None
[0m18:30:10.696958 [info ] [MainThread]:   keepalives_idle: 0
[0m18:30:10.697374 [info ] [MainThread]:   sslmode: None
[0m18:30:10.697789 [info ] [MainThread]:   sslcert: None
[0m18:30:10.698213 [info ] [MainThread]:   sslkey: None
[0m18:30:10.698635 [info ] [MainThread]:   sslrootcert: None
[0m18:30:10.699037 [info ] [MainThread]:   application_name: dbt
[0m18:30:10.699441 [info ] [MainThread]:   retries: 1
[0m18:30:10.700281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:30:10.808477 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:30:10.849452 [debug] [MainThread]: Using postgres connection "debug"
[0m18:30:10.849936 [debug] [MainThread]: On debug: select 1 as id
[0m18:30:10.850329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:10.884417 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m18:30:10.885554 [debug] [MainThread]: On debug: Close
[0m18:30:10.886020 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:30:10.886497 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:30:10.886905 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/mac/Documents/Projets/DE/dbt_project.yml> not found

[0m18:30:10.889662 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.36047265, "process_in_blocks": "0", "process_kernel_time": 0.212635, "process_mem_max_rss": "104415232", "process_out_blocks": "0", "process_user_time": 1.434565}
[0m18:30:10.890261 [debug] [MainThread]: Command `dbt debug` failed at 18:30:10.890123 after 0.36 seconds
[0m18:30:10.890757 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:30:10.891252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624f850>]}
[0m18:30:10.891822 [debug] [MainThread]: Flushing usage events
[0m18:30:11.619703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:40.890617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110896a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb84c0>]}


============================== 18:30:40.894673 | 11986c5b-c7bd-4a44-8c4f-953b78420d93 ==============================
[0m18:30:40.894673 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:30:40.895339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:40.906387 [info ] [MainThread]: dbt version: 1.9.4
[0m18:30:40.906938 [info ] [MainThread]: python version: 3.9.21
[0m18:30:40.907376 [info ] [MainThread]: python path: /opt/anaconda3/envs/DE/bin/python
[0m18:30:40.908021 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:30:40.972217 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m18:30:40.972737 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m18:30:40.973162 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Documents/Projets/DE/dbt_project.yml
[0m18:30:40.973783 [info ] [MainThread]: adapter type: postgres
[0m18:30:40.974206 [info ] [MainThread]: adapter version: 1.9.0
[0m18:30:41.078047 [info ] [MainThread]: Configuration:
[0m18:30:41.078575 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:30:41.078990 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:30:41.079414 [info ] [MainThread]: Required dependencies:
[0m18:30:41.079898 [debug] [MainThread]: Executing "git --help"
[0m18:30:41.091963 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:30:41.093046 [debug] [MainThread]: STDERR: "b''"
[0m18:30:41.093686 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:30:41.094305 [info ] [MainThread]: Connection:
[0m18:30:41.094926 [info ] [MainThread]:   host: localhost
[0m18:30:41.095368 [info ] [MainThread]:   port: 5432
[0m18:30:41.095773 [info ] [MainThread]:   user: mac
[0m18:30:41.096197 [info ] [MainThread]:   database: elt_project
[0m18:30:41.096610 [info ] [MainThread]:   schema: public
[0m18:30:41.097024 [info ] [MainThread]:   connect_timeout: 10
[0m18:30:41.097439 [info ] [MainThread]:   role: None
[0m18:30:41.097849 [info ] [MainThread]:   search_path: None
[0m18:30:41.098263 [info ] [MainThread]:   keepalives_idle: 0
[0m18:30:41.098675 [info ] [MainThread]:   sslmode: None
[0m18:30:41.099094 [info ] [MainThread]:   sslcert: None
[0m18:30:41.099506 [info ] [MainThread]:   sslkey: None
[0m18:30:41.099916 [info ] [MainThread]:   sslrootcert: None
[0m18:30:41.100330 [info ] [MainThread]:   application_name: dbt
[0m18:30:41.100742 [info ] [MainThread]:   retries: 1
[0m18:30:41.101556 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:30:41.204515 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:30:41.244179 [debug] [MainThread]: Using postgres connection "debug"
[0m18:30:41.244645 [debug] [MainThread]: On debug: select 1 as id
[0m18:30:41.245031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:41.278552 [debug] [MainThread]: SQL status: SELECT 1 in 0.033 seconds
[0m18:30:41.279686 [debug] [MainThread]: On debug: Close
[0m18:30:41.280157 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:30:41.280613 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:30:41.283416 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45977205, "process_in_blocks": "0", "process_kernel_time": 0.212357, "process_mem_max_rss": "105918464", "process_out_blocks": "0", "process_user_time": 1.554158}
[0m18:30:41.284031 [debug] [MainThread]: Command `dbt debug` succeeded at 18:30:41.283892 after 0.46 seconds
[0m18:30:41.284509 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:30:41.285006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110896a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb67eb0>]}
[0m18:30:41.285585 [debug] [MainThread]: Flushing usage events
[0m18:30:42.000083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:36.353903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118231c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111823ac0>]}


============================== 18:35:36.358183 | 1612c9a4-db71-40b2-8b76-e52ce82d2527 ==============================
[0m18:35:36.358183 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:35:36.358896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:35:36.549633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fbd00>]}
[0m18:35:36.614280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad3b50>]}
[0m18:35:36.615226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:36.740849 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:35:36.742038 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:35:36.742578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c66e20>]}
[0m18:35:37.612938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m18:35:37.618253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff7130>]}
[0m18:35:37.666217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m18:35:37.670675 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m18:35:37.689535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f3ca0>]}
[0m18:35:37.690441 [info ] [MainThread]: Found 433 macros
[0m18:35:37.691120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1612c9a4-db71-40b2-8b76-e52ce82d2527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f3c40>]}
[0m18:35:37.692692 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:35:37.693480 [debug] [MainThread]: Command end result
[0m18:35:37.716520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m18:35:37.718193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m18:35:37.721914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m18:35:37.724659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4431864, "process_in_blocks": "0", "process_kernel_time": 0.216929, "process_mem_max_rss": "104701952", "process_out_blocks": "0", "process_user_time": 2.534032}
[0m18:35:37.725292 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:37.725167 after 1.44 seconds
[0m18:35:37.725813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fefd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fca580>]}
[0m18:35:37.726316 [debug] [MainThread]: Flushing usage events
[0m18:35:38.566332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:54.187056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e24c0>]}


============================== 18:40:54.192778 | 50f63016-9438-4117-b53a-f3bcdb61ae6b ==============================
[0m18:40:54.192778 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:40:54.193523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:54.215201 [info ] [MainThread]: dbt version: 1.9.4
[0m18:40:54.215778 [info ] [MainThread]: python version: 3.9.21
[0m18:40:54.216231 [info ] [MainThread]: python path: /opt/anaconda3/envs/DE/bin/python
[0m18:40:54.216802 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m18:40:54.349172 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m18:40:54.349754 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m18:40:54.350187 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Documents/Projets/DE/dbt_project.yml
[0m18:40:54.351041 [info ] [MainThread]: adapter type: postgres
[0m18:40:54.351498 [info ] [MainThread]: adapter version: 1.9.0
[0m18:40:54.458464 [info ] [MainThread]: Configuration:
[0m18:40:54.458989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:40:54.459419 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:40:54.460008 [info ] [MainThread]: Required dependencies:
[0m18:40:54.460462 [debug] [MainThread]: Executing "git --help"
[0m18:40:54.474357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:40:54.475515 [debug] [MainThread]: STDERR: "b''"
[0m18:40:54.476054 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:40:54.476551 [info ] [MainThread]: Connection:
[0m18:40:54.477102 [info ] [MainThread]:   host: localhost
[0m18:40:54.477540 [info ] [MainThread]:   port: 5432
[0m18:40:54.477964 [info ] [MainThread]:   user: mac
[0m18:40:54.478394 [info ] [MainThread]:   database: elt_project
[0m18:40:54.478813 [info ] [MainThread]:   schema: public
[0m18:40:54.479226 [info ] [MainThread]:   connect_timeout: 10
[0m18:40:54.479639 [info ] [MainThread]:   role: None
[0m18:40:54.480051 [info ] [MainThread]:   search_path: None
[0m18:40:54.480464 [info ] [MainThread]:   keepalives_idle: 0
[0m18:40:54.480889 [info ] [MainThread]:   sslmode: None
[0m18:40:54.481302 [info ] [MainThread]:   sslcert: None
[0m18:40:54.481861 [info ] [MainThread]:   sslkey: None
[0m18:40:54.482547 [info ] [MainThread]:   sslrootcert: None
[0m18:40:54.483133 [info ] [MainThread]:   application_name: dbt
[0m18:40:54.483803 [info ] [MainThread]:   retries: 1
[0m18:40:54.484693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:40:54.602569 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:40:54.656735 [debug] [MainThread]: Using postgres connection "debug"
[0m18:40:54.657367 [debug] [MainThread]: On debug: select 1 as id
[0m18:40:54.657867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:54.701543 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m18:40:54.702700 [debug] [MainThread]: On debug: Close
[0m18:40:54.703185 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:40:54.703666 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:40:54.707146 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.60156864, "process_in_blocks": "0", "process_kernel_time": 0.344818, "process_mem_max_rss": "106164224", "process_out_blocks": "0", "process_user_time": 1.827185}
[0m18:40:54.707780 [debug] [MainThread]: Command `dbt debug` succeeded at 18:40:54.707637 after 0.60 seconds
[0m18:40:54.708265 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:40:54.708772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104191eb0>]}
[0m18:40:54.709354 [debug] [MainThread]: Flushing usage events
[0m18:40:55.559737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:10.505544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a9d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a9db20>]}


============================== 18:41:10.510114 | d7f83011-ad9f-4d28-b59c-5c4dbace3ede ==============================
[0m18:41:10.510114 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:41:10.510844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:10.693103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f83011-ad9f-4d28-b59c-5c4dbace3ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e5160>]}
[0m18:41:10.755831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7f83011-ad9f-4d28-b59c-5c4dbace3ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cfa5b0>]}
[0m18:41:10.756764 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:41:10.878976 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:41:10.980525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:10.981006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:10.981822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m18:41:10.987350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7f83011-ad9f-4d28-b59c-5c4dbace3ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114753130>]}
[0m18:41:11.037433 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m18:41:11.040857 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m18:41:11.055416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7f83011-ad9f-4d28-b59c-5c4dbace3ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114761820>]}
[0m18:41:11.056086 [info ] [MainThread]: Found 433 macros
[0m18:41:11.056579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7f83011-ad9f-4d28-b59c-5c4dbace3ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114761880>]}
[0m18:41:11.058331 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:41:11.060623 [debug] [MainThread]: Command end result
[0m18:41:11.083109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m18:41:11.084789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m18:41:11.088497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m18:41:11.091220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6640391, "process_in_blocks": "0", "process_kernel_time": 0.213439, "process_mem_max_rss": "105009152", "process_out_blocks": "0", "process_user_time": 1.836183}
[0m18:41:11.091912 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:11.091777 after 0.66 seconds
[0m18:41:11.092466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114761820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114761880>]}
[0m18:41:11.092978 [debug] [MainThread]: Flushing usage events
[0m18:41:11.811449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:54.732091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f0bb0>]}


============================== 20:44:54.741023 | dcbd6be4-3504-43da-adbc-00c3a3976a0e ==============================
[0m20:44:54.741023 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:44:54.742139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:54.990891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcbd6be4-3504-43da-adbc-00c3a3976a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4350d0>]}
[0m20:44:55.055389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcbd6be4-3504-43da-adbc-00c3a3976a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e885940>]}
[0m20:44:55.056619 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:44:55.196257 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:44:55.317246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:55.317720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:55.318493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:44:55.325526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcbd6be4-3504-43da-adbc-00c3a3976a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a5130>]}
[0m20:44:55.381393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:44:55.385695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:44:55.420902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcbd6be4-3504-43da-adbc-00c3a3976a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ac970>]}
[0m20:44:55.421748 [info ] [MainThread]: Found 433 macros
[0m20:44:55.422310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbd6be4-3504-43da-adbc-00c3a3976a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ac910>]}
[0m20:44:55.423633 [warn ] [MainThread]: The selection criterion 'airbnb_transformed' does not match any enabled nodes
[0m20:44:55.424778 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:44:55.427837 [debug] [MainThread]: Command end result
[0m20:44:55.452497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:44:55.454307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:44:55.458929 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:44:55.466694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8243785, "process_in_blocks": "0", "process_kernel_time": 0.426971, "process_mem_max_rss": "104759296", "process_out_blocks": "0", "process_user_time": 2.118927}
[0m20:44:55.467508 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:55.467350 after 0.83 seconds
[0m20:44:55.468103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f289eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e879ca0>]}
[0m20:44:55.468641 [debug] [MainThread]: Flushing usage events
[0m20:44:56.184111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:19.082551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d668a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99db80>]}


============================== 20:46:19.089699 | 7a8a91a0-a577-42c5-85fb-51bcb06d8459 ==============================
[0m20:46:19.089699 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:46:19.095230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:19.334262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a8a91a0-a577-42c5-85fb-51bcb06d8459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed50b50>]}
[0m20:46:19.393318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a8a91a0-a577-42c5-85fb-51bcb06d8459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4acc10>]}
[0m20:46:19.394924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:46:19.528648 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:46:19.638757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:19.639274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:19.640112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:46:19.646272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a8a91a0-a577-42c5-85fb-51bcb06d8459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f652130>]}
[0m20:46:19.698292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:46:19.701732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:46:19.724910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a8a91a0-a577-42c5-85fb-51bcb06d8459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed32640>]}
[0m20:46:19.725634 [info ] [MainThread]: Found 433 macros
[0m20:46:19.726163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8a91a0-a577-42c5-85fb-51bcb06d8459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed321c0>]}
[0m20:46:19.727397 [warn ] [MainThread]: The selection criterion 'airbnb_transformed' does not match any enabled nodes
[0m20:46:19.728443 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:46:19.730737 [debug] [MainThread]: Command end result
[0m20:46:19.754393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:46:19.756058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:46:19.759886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:46:19.764900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7633966, "process_in_blocks": "0", "process_kernel_time": 0.3752, "process_mem_max_rss": "104701952", "process_out_blocks": "0", "process_user_time": 2.103525}
[0m20:46:19.765613 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:19.765479 after 0.76 seconds
[0m20:46:19.766185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d668a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4acc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e96a550>]}
[0m20:46:19.766743 [debug] [MainThread]: Flushing usage events
[0m20:46:20.419421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:20.967681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6fbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa311c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa31ac0>]}


============================== 20:47:20.974939 | 62bfbc1a-01db-4b5d-b7ba-642547cbf812 ==============================
[0m20:47:20.974939 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:47:20.975905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:47:21.177667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62bfbc1a-01db-4b5d-b7ba-642547cbf812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f876130>]}
[0m20:47:21.234989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62bfbc1a-01db-4b5d-b7ba-642547cbf812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eefe850>]}
[0m20:47:21.236267 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:47:21.368244 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:47:21.477841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:21.478346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:21.479128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:47:21.484507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62bfbc1a-01db-4b5d-b7ba-642547cbf812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e6130>]}
[0m20:47:21.534095 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:47:21.537552 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:47:21.561626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62bfbc1a-01db-4b5d-b7ba-642547cbf812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ad0a0>]}
[0m20:47:21.562322 [info ] [MainThread]: Found 433 macros
[0m20:47:21.562820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62bfbc1a-01db-4b5d-b7ba-642547cbf812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ad310>]}
[0m20:47:21.564022 [warn ] [MainThread]: The selection criterion 'airbnb_transformed' does not match any enabled nodes
[0m20:47:21.565055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:47:21.567268 [debug] [MainThread]: Command end result
[0m20:47:21.589756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:47:21.591486 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:47:21.595604 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:47:21.599605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7172413, "process_in_blocks": "0", "process_kernel_time": 0.293815, "process_mem_max_rss": "104534016", "process_out_blocks": "0", "process_user_time": 1.943049}
[0m20:47:21.600269 [debug] [MainThread]: Command `dbt run` succeeded at 20:47:21.600139 after 0.72 seconds
[0m20:47:21.600829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6fbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eefe850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee77430>]}
[0m20:47:21.601359 [debug] [MainThread]: Flushing usage events
[0m20:47:22.190156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:35.845887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb53970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de88be0>]}


============================== 20:47:35.850237 | 61b27046-22f1-4cd2-875d-1e8587cbe82c ==============================
[0m20:47:35.850237 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:47:35.850969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:47:36.026742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b27046-22f1-4cd2-875d-1e8587cbe82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de4d790>]}
[0m20:47:36.084146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b27046-22f1-4cd2-875d-1e8587cbe82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e231c40>]}
[0m20:47:36.084990 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:47:36.193258 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:47:36.239420 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:47:36.240056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61b27046-22f1-4cd2-875d-1e8587cbe82c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f2b20>]}
[0m20:47:37.184808 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.first_elt.airbnb_transformed' (./first_elt/models/airbnb_transformed.sql) depends on a node named 'airbnb_data' which was not found
[0m20:47:37.187333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4094541, "process_in_blocks": "0", "process_kernel_time": 0.194208, "process_mem_max_rss": "108601344", "process_out_blocks": "0", "process_user_time": 2.542864}
[0m20:47:37.187828 [debug] [MainThread]: Command `dbt run` failed at 20:47:37.187719 after 1.41 seconds
[0m20:47:37.188269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb53970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec14dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec524c0>]}
[0m20:47:37.188702 [debug] [MainThread]: Flushing usage events
[0m20:47:37.829591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:57.481260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f784280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f784b80>]}


============================== 20:50:57.488318 | f39a696a-7cd8-472e-8c50-beab5c358c48 ==============================
[0m20:50:57.488318 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:57.489184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:57.710011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb39b50>]}
[0m20:50:57.771567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2957c0>]}
[0m20:50:57.773164 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:57.905243 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:57.966078 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:50:57.967184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1e0be0>]}
[0m20:50:59.027803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:50:59.033541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051aee0>]}
[0m20:50:59.109241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:50:59.112484 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:50:59.144884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c40d0>]}
[0m20:50:59.145654 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:50:59.146206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051ad90>]}
[0m20:50:59.147810 [info ] [MainThread]: 
[0m20:50:59.148337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:59.148817 [info ] [MainThread]: 
[0m20:50:59.149515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:59.150549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:50:59.256391 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:50:59.256974 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:50:59.257422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:59.312440 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m20:50:59.313993 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:50:59.319146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:50:59.325975 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:50:59.326453 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:50:59.326876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:59.351004 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m20:50:59.351541 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:50:59.352001 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:59.375762 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.023 seconds
[0m20:50:59.377356 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:50:59.377945 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:50:59.383233 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.383717 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.384138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:59.406339 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:50:59.406889 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.407425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:59.421908 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m20:50:59.423568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9dea90>]}
[0m20:50:59.424210 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:59.424840 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.425300 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.425977 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:59.426454 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.426914 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.427357 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.427917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:59.428375 [debug] [MainThread]: On master: Close
[0m20:50:59.433317 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:50:59.434129 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:50:59.434893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:50:59.435436 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:50:59.445337 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:50:59.446742 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:50:59.486288 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:50:59.487653 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:50:59.488160 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:50:59.488637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:59.510302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:50:59.510902 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:50:59.511508 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null

)

select * from cleaned;
  );
[0m20:50:59.513059 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 65: select * from cleaned;
                              ^

[0m20:50:59.513586 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:50:59.514289 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:50:59.522548 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 65: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:50:59.524830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39a696a-7cd8-472e-8c50-beab5c358c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a290d0>]}
[0m20:50:59.525642 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:50:59.526402 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:50:59.527098 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 65: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:50:59.528344 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.528783 [debug] [MainThread]: On master: BEGIN
[0m20:50:59.529193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:59.552531 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:50:59.553105 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.553562 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:59.553998 [debug] [MainThread]: On master: COMMIT
[0m20:50:59.554546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:59.555008 [debug] [MainThread]: On master: Close
[0m20:50:59.555597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:59.556251 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:50:59.556746 [info ] [MainThread]: 
[0m20:50:59.557244 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:50:59.558158 [debug] [MainThread]: Command end result
[0m20:50:59.582133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:50:59.583804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:50:59.591396 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:50:59.591880 [info ] [MainThread]: 
[0m20:50:59.592551 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:59.593056 [info ] [MainThread]: 
[0m20:50:59.593592 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 65: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:50:59.594052 [info ] [MainThread]: 
[0m20:50:59.594517 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:50:59.598017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1997123, "process_in_blocks": "0", "process_kernel_time": 0.434774, "process_mem_max_rss": "118722560", "process_out_blocks": "0", "process_user_time": 3.22682}
[0m20:50:59.598617 [debug] [MainThread]: Command `dbt run` failed at 20:50:59.598493 after 2.20 seconds
[0m20:50:59.599156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5d1f0>]}
[0m20:50:59.599690 [debug] [MainThread]: Flushing usage events
[0m20:51:00.277349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:12.773132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109269a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59dbb0>]}


============================== 20:52:12.777464 | b03e85c8-0b7d-4826-8190-53a273309437 ==============================
[0m20:52:12.777464 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:52:12.778186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:12.953190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8428b0>]}
[0m20:52:13.012942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a827d00>]}
[0m20:52:13.013932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:52:13.125664 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:52:13.225230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:13.225846 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:52:13.458721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:52:13.464985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b435130>]}
[0m20:52:13.533229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:52:13.536363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:52:13.547436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f6ca0>]}
[0m20:52:13.548015 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:52:13.548446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3eb5e0>]}
[0m20:52:13.549719 [info ] [MainThread]: 
[0m20:52:13.550236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:13.550642 [info ] [MainThread]: 
[0m20:52:13.551218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:13.552096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:52:13.649013 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:52:13.649706 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:52:13.650253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:13.693532 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m20:52:13.695057 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:52:13.700453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:52:13.707254 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:52:13.707727 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:52:13.708155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:13.729915 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:52:13.730457 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:52:13.730911 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:52:13.734750 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:52:13.736174 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:52:13.736717 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:52:13.741816 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.742274 [debug] [MainThread]: On master: BEGIN
[0m20:52:13.742688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:13.764641 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:52:13.765318 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.765838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:13.770202 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:52:13.771498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37b130>]}
[0m20:52:13.772069 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:13.772629 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.773060 [debug] [MainThread]: On master: BEGIN
[0m20:52:13.773678 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:13.774122 [debug] [MainThread]: On master: COMMIT
[0m20:52:13.774558 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.774976 [debug] [MainThread]: On master: COMMIT
[0m20:52:13.775509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:13.775951 [debug] [MainThread]: On master: Close
[0m20:52:13.777953 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:52:13.778612 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:52:13.779214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:52:13.779721 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:52:13.789363 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:52:13.790258 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:52:13.830937 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:52:13.831894 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:52:13.832384 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:52:13.832851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:13.854824 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:52:13.855430 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:52:13.856047 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    ;
)

select * from cleaned;
  );
[0m20:52:13.857153 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 62:     ;
             ^

[0m20:52:13.857668 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:52:13.858376 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:52:13.861032 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:52:13.862949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b03e85c8-0b7d-4826-8190-53a273309437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914b940>]}
[0m20:52:13.863732 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m20:52:13.864485 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:52:13.865189 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:52:13.866428 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.866874 [debug] [MainThread]: On master: BEGIN
[0m20:52:13.867295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:13.889671 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:52:13.890227 [debug] [MainThread]: On master: COMMIT
[0m20:52:13.890682 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:13.891109 [debug] [MainThread]: On master: COMMIT
[0m20:52:13.891636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:13.892094 [debug] [MainThread]: On master: Close
[0m20:52:13.892658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:13.893069 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:52:13.893508 [info ] [MainThread]: 
[0m20:52:13.893982 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:52:13.894828 [debug] [MainThread]: Command end result
[0m20:52:13.918178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:52:13.919992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:52:13.927306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:52:13.927732 [info ] [MainThread]: 
[0m20:52:13.928312 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:52:13.928793 [info ] [MainThread]: 
[0m20:52:13.929319 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:52:13.929787 [info ] [MainThread]: 
[0m20:52:13.930281 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:52:13.933110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2313327, "process_in_blocks": "0", "process_kernel_time": 0.248828, "process_mem_max_rss": "117862400", "process_out_blocks": "0", "process_user_time": 2.233816}
[0m20:52:13.933815 [debug] [MainThread]: Command `dbt run` failed at 20:52:13.933667 after 1.23 seconds
[0m20:52:13.934377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109269a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b254c40>]}
[0m20:52:13.934988 [debug] [MainThread]: Flushing usage events
[0m20:52:14.473697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:01.345111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c853a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db87280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db87b80>]}


============================== 20:54:01.349492 | d5cfed35-d267-4bf4-ad91-19f3c1e76e59 ==============================
[0m20:54:01.349492 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:54:01.350218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:01.526480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df3bb50>]}
[0m20:54:01.586595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6997c0>]}
[0m20:54:01.587545 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:01.696660 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:54:01.797699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:01.798159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:01.804597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:54:01.834588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e861130>]}
[0m20:54:01.900371 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:54:01.904255 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:54:01.915596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e853a30>]}
[0m20:54:01.916152 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:54:01.916643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e233310>]}
[0m20:54:01.918032 [info ] [MainThread]: 
[0m20:54:01.918585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:01.919033 [info ] [MainThread]: 
[0m20:54:01.919660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:01.920529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:54:01.976337 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:54:01.976860 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:54:01.977258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:02.015285 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m20:54:02.016766 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:54:02.021931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:54:02.028578 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:54:02.029041 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:54:02.029469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:02.051157 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:54:02.051695 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:54:02.052162 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:02.055953 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:54:02.057358 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:54:02.057904 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:54:02.063020 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.063475 [debug] [MainThread]: On master: BEGIN
[0m20:54:02.063886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:02.085829 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:54:02.086371 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.086892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:02.091266 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:54:02.092711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df48ac0>]}
[0m20:54:02.093299 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:02.093862 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.094294 [debug] [MainThread]: On master: BEGIN
[0m20:54:02.094944 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:54:02.095397 [debug] [MainThread]: On master: COMMIT
[0m20:54:02.095830 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.096248 [debug] [MainThread]: On master: COMMIT
[0m20:54:02.096789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:02.097243 [debug] [MainThread]: On master: Close
[0m20:54:02.099277 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:54:02.099939 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:54:02.100530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:54:02.101031 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:54:02.111029 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:54:02.111950 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:54:02.150940 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:54:02.151837 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:54:02.152286 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:54:02.152717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:54:02.173490 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:54:02.174087 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:54:02.174693 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    ;
)

select * from cleaned;
  );
[0m20:54:02.175802 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 62:     ;
             ^

[0m20:54:02.176321 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:54:02.177086 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:54:02.179704 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:54:02.181606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5cfed35-d267-4bf4-ad91-19f3c1e76e59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec9c490>]}
[0m20:54:02.182386 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m20:54:02.183192 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:54:02.183891 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:54:02.185201 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.185643 [debug] [MainThread]: On master: BEGIN
[0m20:54:02.186057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:02.208618 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:54:02.209182 [debug] [MainThread]: On master: COMMIT
[0m20:54:02.209662 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:02.210159 [debug] [MainThread]: On master: COMMIT
[0m20:54:02.210712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:02.211172 [debug] [MainThread]: On master: Close
[0m20:54:02.211817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:02.212263 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:54:02.212714 [info ] [MainThread]: 
[0m20:54:02.213195 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m20:54:02.214090 [debug] [MainThread]: Command end result
[0m20:54:02.286318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:54:02.288188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:54:02.297066 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:54:02.297598 [info ] [MainThread]: 
[0m20:54:02.298214 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:54:02.298849 [info ] [MainThread]: 
[0m20:54:02.299506 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 62:     ;
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:54:02.300048 [info ] [MainThread]: 
[0m20:54:02.300593 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:54:02.303792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0295132, "process_in_blocks": "0", "process_kernel_time": 0.24775, "process_mem_max_rss": "113807360", "process_out_blocks": "0", "process_user_time": 2.035688}
[0m20:54:02.304539 [debug] [MainThread]: Command `dbt run` failed at 20:54:02.304353 after 1.03 seconds
[0m20:54:02.305162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c853a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e853a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfa6310>]}
[0m20:54:02.305766 [debug] [MainThread]: Flushing usage events
[0m20:54:02.949051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:52.685706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbceac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f041c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f04ac0>]}


============================== 20:54:52.691440 | dcde6124-1f30-4452-a4a0-89a8770a2fef ==============================
[0m20:54:52.691440 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:54:52.692203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:54:52.901101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d49130>]}
[0m20:54:52.959846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d1850>]}
[0m20:54:52.960993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:53.091880 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:54:53.228953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:53.229723 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:54:53.460893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:54:53.465721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9b130>]}
[0m20:54:53.534490 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:54:53.537876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:54:53.560926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba5b50>]}
[0m20:54:53.561604 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:54:53.562105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba5ee0>]}
[0m20:54:53.563570 [info ] [MainThread]: 
[0m20:54:53.564066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:53.564498 [info ] [MainThread]: 
[0m20:54:53.565146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:53.566158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:54:53.688876 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:54:53.689593 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:54:53.690153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:53.749392 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.059 seconds
[0m20:54:53.750967 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:54:53.756522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:54:53.763339 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:54:53.763805 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:54:53.764232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:53.786830 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m20:54:53.787387 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:54:53.787863 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:54:53.791853 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m20:54:53.793341 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:54:53.793905 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:54:53.799132 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.799600 [debug] [MainThread]: On master: BEGIN
[0m20:54:53.800026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:53.821954 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:54:53.822679 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.823216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:53.827640 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:54:53.828959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d37cd0>]}
[0m20:54:53.829533 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:53.830096 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.830526 [debug] [MainThread]: On master: BEGIN
[0m20:54:53.831194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:54:53.831634 [debug] [MainThread]: On master: COMMIT
[0m20:54:53.832064 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.832479 [debug] [MainThread]: On master: COMMIT
[0m20:54:53.833019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:53.833468 [debug] [MainThread]: On master: Close
[0m20:54:53.836275 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:54:53.836951 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:54:53.837548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:54:53.838051 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:54:53.847667 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:54:53.848588 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:54:53.888799 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:54:53.889830 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:54:53.890359 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:54:53.890878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:54:53.913025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:54:53.913623 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:54:53.914225 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned;
  );
[0m20:54:53.915911 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 64: select * from cleaned;
                              ^

[0m20:54:53.916566 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:54:53.917372 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:54:53.926234 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:54:53.928329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcde6124-1f30-4452-a4a0-89a8770a2fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a051f0>]}
[0m20:54:53.929131 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:54:53.929885 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:54:53.930583 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:54:53.931800 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.932248 [debug] [MainThread]: On master: BEGIN
[0m20:54:53.932666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:53.955789 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:54:53.956372 [debug] [MainThread]: On master: COMMIT
[0m20:54:53.957050 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:53.957543 [debug] [MainThread]: On master: COMMIT
[0m20:54:53.958138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:54:53.958618 [debug] [MainThread]: On master: Close
[0m20:54:53.959270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:53.959711 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:54:53.960173 [info ] [MainThread]: 
[0m20:54:53.960662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:54:53.961608 [debug] [MainThread]: Command end result
[0m20:54:53.984346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:54:53.986033 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:54:53.993946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:54:53.994435 [info ] [MainThread]: 
[0m20:54:53.994988 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:54:53.995468 [info ] [MainThread]: 
[0m20:54:53.995994 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:54:53.996463 [info ] [MainThread]: 
[0m20:54:53.996930 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:54:54.000269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3971595, "process_in_blocks": "0", "process_kernel_time": 0.342174, "process_mem_max_rss": "117522432", "process_out_blocks": "0", "process_user_time": 2.410097}
[0m20:54:54.000836 [debug] [MainThread]: Command `dbt run` failed at 20:54:54.000715 after 1.40 seconds
[0m20:54:54.001417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbceac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115af550>]}
[0m20:54:54.001973 [debug] [MainThread]: Flushing usage events
[0m20:54:54.602956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:55.935526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3eb20>]}


============================== 20:55:55.942045 | 0414e67c-bf42-452e-9862-47f70769c6eb ==============================
[0m20:55:55.942045 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:55:55.942976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:55:56.158665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec68e0>]}
[0m20:55:56.219627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da84340>]}
[0m20:55:56.221007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:55:56.351827 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:55:56.499686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:56.500144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:56.506661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:55:56.534212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e916130>]}
[0m20:55:56.605272 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:55:56.608597 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:55:56.642717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9363a0>]}
[0m20:55:56.643483 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:55:56.644040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e936760>]}
[0m20:55:56.645701 [info ] [MainThread]: 
[0m20:55:56.646249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:56.646734 [info ] [MainThread]: 
[0m20:55:56.647450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:56.648509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:55:56.719024 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:55:56.719644 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:55:56.720101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:56.780165 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m20:55:56.781723 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:55:56.787124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:55:56.794062 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:55:56.794572 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:55:56.795000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:56.818158 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m20:55:56.818764 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:55:56.819258 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:55:56.827430 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:55:56.828967 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:55:56.829545 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:55:56.834703 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.835157 [debug] [MainThread]: On master: BEGIN
[0m20:55:56.835572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:56.857931 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:55:56.858478 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.859016 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:56.864575 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:55:56.866102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e014760>]}
[0m20:55:56.866691 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:56.867308 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.867786 [debug] [MainThread]: On master: BEGIN
[0m20:55:56.868483 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:55:56.868953 [debug] [MainThread]: On master: COMMIT
[0m20:55:56.869409 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.869846 [debug] [MainThread]: On master: COMMIT
[0m20:55:56.870392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:55:56.870860 [debug] [MainThread]: On master: Close
[0m20:55:56.873710 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:55:56.874396 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:55:56.875020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:55:56.875541 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:55:56.885836 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:55:56.886737 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:55:56.926438 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:55:56.927334 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:55:56.927774 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:55:56.928184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:55:56.949247 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:55:56.949848 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:55:56.950455 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned;
  );
[0m20:55:56.952127 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 64: select * from cleaned;
                              ^

[0m20:55:56.952643 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:55:56.953440 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:55:56.962842 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:55:56.965190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0414e67c-bf42-452e-9862-47f70769c6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed4a310>]}
[0m20:55:56.965998 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:55:56.966757 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:55:56.967458 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:55:56.968744 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.969190 [debug] [MainThread]: On master: BEGIN
[0m20:55:56.969603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:56.992686 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:55:56.993261 [debug] [MainThread]: On master: COMMIT
[0m20:55:56.993724 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:56.994160 [debug] [MainThread]: On master: COMMIT
[0m20:55:56.994694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:55:56.995150 [debug] [MainThread]: On master: Close
[0m20:55:56.995734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:56.996160 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:55:56.996612 [info ] [MainThread]: 
[0m20:55:56.997104 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:55:56.997988 [debug] [MainThread]: Command end result
[0m20:55:57.073884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:55:57.075874 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:55:57.084742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:55:57.085251 [info ] [MainThread]: 
[0m20:55:57.085886 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:55:57.086438 [info ] [MainThread]: 
[0m20:55:57.087065 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 64: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:55:57.087679 [info ] [MainThread]: 
[0m20:55:57.088277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:55:57.093583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2467649, "process_in_blocks": "0", "process_kernel_time": 0.414265, "process_mem_max_rss": "114159616", "process_out_blocks": "0", "process_user_time": 2.331904}
[0m20:55:57.094517 [debug] [MainThread]: Command `dbt run` failed at 20:55:57.094332 after 1.25 seconds
[0m20:55:57.095258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfe9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e933f40>]}
[0m20:55:57.095927 [debug] [MainThread]: Flushing usage events
[0m20:55:57.744616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:13.598953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed54ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008aac0>]}


============================== 20:56:13.603263 | c6fde7e3-ecbc-4775-bc0b-160063f83fad ==============================
[0m20:56:13.603263 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:56:13.603990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:56:13.781049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11003a2b0>]}
[0m20:56:13.841238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11043d2e0>]}
[0m20:56:13.842129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:13.951950 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:56:14.051703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:14.052336 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:56:14.290713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:56:14.296322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f20130>]}
[0m20:56:14.366539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:56:14.369735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:56:14.380850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee3a30>]}
[0m20:56:14.381430 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:56:14.381929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee3dc0>]}
[0m20:56:14.383168 [info ] [MainThread]: 
[0m20:56:14.383647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:14.384079 [info ] [MainThread]: 
[0m20:56:14.384684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:14.385589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:56:14.475597 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:56:14.476276 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:56:14.476810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:14.520088 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m20:56:14.521610 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:56:14.526959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:56:14.533829 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:56:14.534301 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:56:14.534734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:14.556526 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:56:14.557074 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:56:14.557533 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:14.561240 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:56:14.562711 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:56:14.563265 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:56:14.568381 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.568839 [debug] [MainThread]: On master: BEGIN
[0m20:56:14.569251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:14.590982 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:56:14.591664 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.592193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:14.596314 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:56:14.597609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed04c0>]}
[0m20:56:14.598205 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:14.598773 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.599210 [debug] [MainThread]: On master: BEGIN
[0m20:56:14.599858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:56:14.600309 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.600749 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.601172 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.601699 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:14.602145 [debug] [MainThread]: On master: Close
[0m20:56:14.604294 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:56:14.604979 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:56:14.605622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:56:14.606141 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:56:14.615632 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:56:14.616512 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:56:14.657888 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:56:14.658851 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:56:14.659355 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:56:14.659833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:56:14.686088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m20:56:14.686763 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:56:14.687406 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m20:56:14.689311 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "host id" does not exist
LINE 19:         cast("host id" as integer) as host_id,
                      ^
HINT:  Perhaps you meant to reference the column "source.host_id".

[0m20:56:14.689839 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:56:14.690583 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:56:14.693045 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:56:14.694932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6fde7e3-ecbc-4775-bc0b-160063f83fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec37490>]}
[0m20:56:14.695718 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:56:14.696479 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:56:14.697188 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:56:14.698464 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.698914 [debug] [MainThread]: On master: BEGIN
[0m20:56:14.699335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:14.722375 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:56:14.723056 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.723578 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:14.724038 [debug] [MainThread]: On master: COMMIT
[0m20:56:14.724743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:14.725221 [debug] [MainThread]: On master: Close
[0m20:56:14.725833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:14.726251 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:56:14.726718 [info ] [MainThread]: 
[0m20:56:14.727207 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:56:14.728101 [debug] [MainThread]: Command end result
[0m20:56:14.750608 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:56:14.752307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:56:14.760406 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:56:14.760958 [info ] [MainThread]: 
[0m20:56:14.761486 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:14.761966 [info ] [MainThread]: 
[0m20:56:14.762500 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:56:14.762951 [info ] [MainThread]: 
[0m20:56:14.763419 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:56:14.766158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2376941, "process_in_blocks": "0", "process_kernel_time": 0.229349, "process_mem_max_rss": "116604928", "process_out_blocks": "0", "process_user_time": 2.248718}
[0m20:56:14.766726 [debug] [MainThread]: Command `dbt run` failed at 20:56:14.766604 after 1.24 seconds
[0m20:56:14.767249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed54ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d1dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ebc1c0>]}
[0m20:56:14.767807 [debug] [MainThread]: Flushing usage events
[0m20:56:15.316919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:42.212162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109819a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4ca90>]}


============================== 20:56:42.218371 | 4da02413-7350-40b4-9852-d8b889606c11 ==============================
[0m20:56:42.218371 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:56:42.219192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:42.435068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf1af0>]}
[0m20:56:42.496520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f719d0>]}
[0m20:56:42.497915 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:42.618650 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:56:42.751486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:42.751930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:42.758353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:56:42.787847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b826130>]}
[0m20:56:42.854486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:56:42.857860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:56:42.883023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b818940>]}
[0m20:56:42.883710 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:56:42.884213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b848460>]}
[0m20:56:42.885734 [info ] [MainThread]: 
[0m20:56:42.886251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:42.886698 [info ] [MainThread]: 
[0m20:56:42.887368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:42.888385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:56:42.946296 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:56:42.946874 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:56:42.947318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:42.995002 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m20:56:42.996556 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:56:43.001748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:56:43.008848 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:56:43.009363 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:56:43.009784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:43.032656 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m20:56:43.033222 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:56:43.033696 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:43.037553 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m20:56:43.039013 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:56:43.039588 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:56:43.044849 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.045323 [debug] [MainThread]: On master: BEGIN
[0m20:56:43.045762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:43.067597 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:56:43.068145 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.068668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:43.072802 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:56:43.074219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83e520>]}
[0m20:56:43.074851 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:43.075444 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.075882 [debug] [MainThread]: On master: BEGIN
[0m20:56:43.076513 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:56:43.076968 [debug] [MainThread]: On master: COMMIT
[0m20:56:43.077406 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.077821 [debug] [MainThread]: On master: COMMIT
[0m20:56:43.078363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:43.078835 [debug] [MainThread]: On master: Close
[0m20:56:43.081643 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:56:43.082310 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:56:43.082912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:56:43.083427 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:56:43.093897 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:56:43.094800 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:56:43.133384 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:56:43.134241 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:56:43.134682 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:56:43.135099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:56:43.156267 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m20:56:43.156889 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:56:43.157508 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m20:56:43.158848 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "host id" does not exist
LINE 19:         cast("host id" as integer) as host_id,
                      ^
HINT:  Perhaps you meant to reference the column "source.host_id".

[0m20:56:43.159366 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:56:43.160074 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:56:43.166312 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:56:43.168496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4da02413-7350-40b4-9852-d8b889606c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccc430>]}
[0m20:56:43.169305 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m20:56:43.170095 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:56:43.170871 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:56:43.172209 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.172658 [debug] [MainThread]: On master: BEGIN
[0m20:56:43.173076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:43.196005 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:56:43.196597 [debug] [MainThread]: On master: COMMIT
[0m20:56:43.197056 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:43.197492 [debug] [MainThread]: On master: COMMIT
[0m20:56:43.198056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:43.198547 [debug] [MainThread]: On master: Close
[0m20:56:43.199145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:43.199575 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:56:43.200021 [info ] [MainThread]: 
[0m20:56:43.200554 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:56:43.201442 [debug] [MainThread]: Command end result
[0m20:56:43.275026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:56:43.276936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:56:43.285735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:56:43.286245 [info ] [MainThread]: 
[0m20:56:43.286881 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:43.287489 [info ] [MainThread]: 
[0m20:56:43.288135 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host id" does not exist
  LINE 19:         cast("host id" as integer) as host_id,
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_id".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:56:43.288665 [info ] [MainThread]: 
[0m20:56:43.289213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:56:43.293315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1683251, "process_in_blocks": "0", "process_kernel_time": 0.255444, "process_mem_max_rss": "114450432", "process_out_blocks": "0", "process_user_time": 2.143758}
[0m20:56:43.294222 [debug] [MainThread]: Command `dbt run` failed at 20:56:43.293957 after 1.17 seconds
[0m20:56:43.294909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109819a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109703430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcaea90>]}
[0m20:56:43.295645 [debug] [MainThread]: Flushing usage events
[0m20:56:43.848635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:20.485447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112384af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136b8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136b8430>]}


============================== 21:27:20.491731 | c228cd77-d736-485a-8dcd-6e14eea5b9b4 ==============================
[0m21:27:20.491731 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:27:20.492701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:20.711527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f0f40>]}
[0m21:27:20.772984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113913e80>]}
[0m21:27:20.774322 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:20.902501 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:27:21.035871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:21.036565 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:27:21.276247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:27:21.281425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114552130>]}
[0m21:27:21.354230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:27:21.357774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:27:21.380297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d999a0>]}
[0m21:27:21.380971 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:27:21.381465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11447bbe0>]}
[0m21:27:21.382961 [info ] [MainThread]: 
[0m21:27:21.383465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:21.383893 [info ] [MainThread]: 
[0m21:27:21.384533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:21.385558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:27:21.505450 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:27:21.506283 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:27:21.506929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:21.573203 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m21:27:21.575048 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:27:21.580800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:27:21.588125 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:27:21.588635 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:27:21.589070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:21.612848 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:27:21.613399 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:27:21.613865 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:27:21.620776 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m21:27:21.622490 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:27:21.623080 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:27:21.628367 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.628853 [debug] [MainThread]: On master: BEGIN
[0m21:27:21.629281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:21.651983 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:27:21.652689 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.653224 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:21.658297 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:27:21.659665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144fac10>]}
[0m21:27:21.660263 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:21.660849 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.661299 [debug] [MainThread]: On master: BEGIN
[0m21:27:21.661970 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:27:21.662456 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.662906 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.663338 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.663887 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:21.664344 [debug] [MainThread]: On master: Close
[0m21:27:21.667290 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:27:21.668007 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:27:21.668653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:27:21.669199 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:27:21.678755 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:27:21.680301 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:27:21.722126 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:27:21.723101 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:27:21.723608 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:27:21.724082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:27:21.746251 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:27:21.746859 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:27:21.747460 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:27:21.749456 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "name" does not exist
LINE 18:         name,
                 ^

[0m21:27:21.750119 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:27:21.751010 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:27:21.764410 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "name" does not exist
  LINE 18:         name,
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:27:21.767346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c228cd77-d736-485a-8dcd-6e14eea5b9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131646a0>]}
[0m21:27:21.768389 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.10s]
[0m21:27:21.769248 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:27:21.770065 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "name" does not exist
  LINE 18:         name,
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:27:21.771485 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.771976 [debug] [MainThread]: On master: BEGIN
[0m21:27:21.772442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:21.797593 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m21:27:21.798174 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.798647 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.799096 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.799648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:21.800131 [debug] [MainThread]: On master: Close
[0m21:27:21.800730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:21.801177 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:27:21.801630 [info ] [MainThread]: 
[0m21:27:21.802114 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:27:21.802991 [debug] [MainThread]: Command end result
[0m21:27:21.828467 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:27:21.830358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:27:21.838214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:27:21.838805 [info ] [MainThread]: 
[0m21:27:21.839343 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:27:21.839837 [info ] [MainThread]: 
[0m21:27:21.840495 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "name" does not exist
  LINE 18:         name,
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:27:21.840977 [info ] [MainThread]: 
[0m21:27:21.841514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:27:21.845738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.445726, "process_in_blocks": "0", "process_kernel_time": 0.426161, "process_mem_max_rss": "117559296", "process_out_blocks": "0", "process_user_time": 2.561271}
[0m21:27:21.846462 [debug] [MainThread]: Command `dbt run` failed at 21:27:21.846323 after 1.45 seconds
[0m21:27:21.847037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112384af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114531460>]}
[0m21:27:21.847599 [debug] [MainThread]: Flushing usage events
[0m21:27:22.504968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:14.537538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110822ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b581c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b58ac0>]}


============================== 21:28:14.543194 | 48d88968-333b-42e5-9ffa-6548a43249c6 ==============================
[0m21:28:14.543194 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:28:14.544085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:14.728957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b082b0>]}
[0m21:28:14.788397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0d2e0>]}
[0m21:28:14.790012 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:14.920870 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:28:15.053917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:15.054509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:15.062017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:28:15.094362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112831130>]}
[0m21:28:15.178327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:28:15.181928 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:28:15.210339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209bc10>]}
[0m21:28:15.211016 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:28:15.211518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128519a0>]}
[0m21:28:15.213254 [info ] [MainThread]: 
[0m21:28:15.213796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:15.214245 [info ] [MainThread]: 
[0m21:28:15.214909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:15.215941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:28:15.283525 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:28:15.284137 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:28:15.284589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:15.325246 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m21:28:15.327128 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:28:15.332569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:28:15.339703 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:28:15.340219 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:28:15.340655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:15.364991 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:28:15.365544 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:28:15.366021 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:28:15.370543 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:28:15.372082 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:28:15.372667 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:28:15.378194 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.378716 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.379144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:15.402225 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:28:15.402783 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.403346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:28:15.408176 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:28:15.409872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11284a940>]}
[0m21:28:15.410489 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:15.411225 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.411691 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.412352 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:28:15.412831 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.413281 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.413710 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.414305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:15.414782 [debug] [MainThread]: On master: Close
[0m21:28:15.418146 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:28:15.418871 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:28:15.419508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:28:15.420063 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:28:15.432166 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:28:15.433201 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:28:15.475206 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:28:15.476204 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:28:15.476713 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:28:15.477191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:28:15.506227 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m21:28:15.506851 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:28:15.507469 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verfied as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:28:15.509815 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "host_identity_verfied" does not exist
LINE 20:         cast(host_identity_verfied as varchar(25)) as is_hos...
                      ^
HINT:  Perhaps you meant to reference the column "source.host_identity_verified".

[0m21:28:15.510361 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:28:15.511125 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:28:15.519419 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host_identity_verfied" does not exist
  LINE 20:         cast(host_identity_verfied as varchar(25)) as is_hos...
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_identity_verified".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:28:15.521749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d88968-333b-42e5-9ffa-6548a43249c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c6a4c0>]}
[0m21:28:15.522621 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.10s]
[0m21:28:15.523436 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:28:15.524205 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host_identity_verfied" does not exist
  LINE 20:         cast(host_identity_verfied as varchar(25)) as is_hos...
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_identity_verified".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:28:15.525627 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.526096 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.526532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:15.550758 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:28:15.551357 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.552013 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.552536 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.553191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:15.553751 [debug] [MainThread]: On master: Close
[0m21:28:15.554556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:15.555037 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:28:15.555584 [info ] [MainThread]: 
[0m21:28:15.556115 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:28:15.557058 [debug] [MainThread]: Command end result
[0m21:28:15.632538 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:28:15.634395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:28:15.643466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:28:15.644020 [info ] [MainThread]: 
[0m21:28:15.644676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:28:15.645240 [info ] [MainThread]: 
[0m21:28:15.645889 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "host_identity_verfied" does not exist
  LINE 20:         cast(host_identity_verfied as varchar(25)) as is_hos...
                        ^
  HINT:  Perhaps you meant to reference the column "source.host_identity_verified".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:28:15.646474 [info ] [MainThread]: 
[0m21:28:15.647074 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:28:15.652013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1940199, "process_in_blocks": "0", "process_kernel_time": 0.383971, "process_mem_max_rss": "113414144", "process_out_blocks": "0", "process_user_time": 2.359232}
[0m21:28:15.652772 [debug] [MainThread]: Command `dbt run` failed at 21:28:15.652620 after 1.19 seconds
[0m21:28:15.653410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110822ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6d7c0>]}
[0m21:28:15.654209 [debug] [MainThread]: Flushing usage events
[0m21:28:16.240338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:20.330370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102cab50>]}


============================== 21:29:20.336923 | 1b60900a-9f7f-4f73-82f4-897493b6b4e6 ==============================
[0m21:29:20.336923 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:29:20.337744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:29:20.554144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf4bb0>]}
[0m21:29:20.613896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd736d0>]}
[0m21:29:20.615529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:29:20.750222 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:29:20.884035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:20.884677 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:29:21.124765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:29:21.129855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111160130>]}
[0m21:29:21.201589 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:29:21.205008 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:29:21.236052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd9280>]}
[0m21:29:21.236880 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:29:21.237430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111122e20>]}
[0m21:29:21.239065 [info ] [MainThread]: 
[0m21:29:21.239603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:21.240075 [info ] [MainThread]: 
[0m21:29:21.240774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:21.241847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:29:21.359835 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:29:21.360599 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:29:21.361179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:21.424313 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m21:29:21.425978 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:29:21.431581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:29:21.438849 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:29:21.439346 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:29:21.439788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:21.462968 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:29:21.463527 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:29:21.464002 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:29:21.470380 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m21:29:21.471927 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:29:21.472506 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:29:21.477712 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.478172 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.478591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:21.501050 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:29:21.501741 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.502282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:21.507942 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:29:21.509369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e3310>]}
[0m21:29:21.509965 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:21.510548 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.510989 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.511690 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:29:21.512155 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.512605 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.513065 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.513631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:21.514094 [debug] [MainThread]: On master: Close
[0m21:29:21.516851 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:29:21.517541 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:29:21.518153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:29:21.518673 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:29:21.528726 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:29:21.530339 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:29:21.573145 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:29:21.574122 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:29:21.574631 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:29:21.575110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:21.597664 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:29:21.598271 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:29:21.598888 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:29:21.602068 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "room type " does not exist
LINE 28:         cast("room type " as varchar(50)) as room_type,
                      ^
HINT:  Perhaps you meant to reference the column "source.room type".

[0m21:29:21.602605 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:29:21.603325 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:29:21.611481 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:29:21.613805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b60900a-9f7f-4f73-82f4-897493b6b4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd34730>]}
[0m21:29:21.614605 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:29:21.615380 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:29:21.616111 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:29:21.617370 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.617818 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.618241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:21.641494 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:29:21.642123 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.642624 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.643124 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.643676 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:21.644131 [debug] [MainThread]: On master: Close
[0m21:29:21.644740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:21.645210 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:29:21.645723 [info ] [MainThread]: 
[0m21:29:21.646260 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:29:21.647155 [debug] [MainThread]: Command end result
[0m21:29:21.671711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:29:21.673647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:29:21.680820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:29:21.681258 [info ] [MainThread]: 
[0m21:29:21.681857 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:29:21.682332 [info ] [MainThread]: 
[0m21:29:21.682869 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:29:21.683348 [info ] [MainThread]: 
[0m21:29:21.683820 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:29:21.687951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4439384, "process_in_blocks": "0", "process_kernel_time": 0.408276, "process_mem_max_rss": "116768768", "process_out_blocks": "0", "process_user_time": 2.51814}
[0m21:29:21.689114 [debug] [MainThread]: Command `dbt run` failed at 21:29:21.688956 after 1.45 seconds
[0m21:29:21.689683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111427c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb4460>]}
[0m21:29:21.690274 [debug] [MainThread]: Flushing usage events
[0m21:29:22.328587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:50.785101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f5bb0>]}


============================== 21:29:50.789663 | fa960d37-3e95-4982-971e-6a2b542f4936 ==============================
[0m21:29:50.789663 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:29:50.790383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:29:50.968959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2bf10>]}
[0m21:29:51.034009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758d9d0>]}
[0m21:29:51.034949 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:29:51.151996 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:29:51.255565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:51.256199 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:29:51.491523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:29:51.496539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818c130>]}
[0m21:29:51.565340 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:29:51.568473 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:29:51.580593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814d610>]}
[0m21:29:51.581224 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:29:51.581705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814d130>]}
[0m21:29:51.583001 [info ] [MainThread]: 
[0m21:29:51.583461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:51.583831 [info ] [MainThread]: 
[0m21:29:51.584438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:51.585295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:29:51.683816 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:29:51.684484 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:29:51.685015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:51.729282 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m21:29:51.730797 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:29:51.736029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:29:51.743043 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:29:51.743522 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:29:51.743946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:51.766098 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:29:51.766639 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:29:51.767089 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:29:51.770866 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:29:51.772275 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:29:51.772808 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:29:51.777941 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.778398 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.778828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:51.800891 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:29:51.801553 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.802070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:51.806348 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:29:51.807663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080be7f0>]}
[0m21:29:51.808252 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:51.808821 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.809253 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.809915 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:29:51.810354 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.810780 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.811188 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.811702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.812138 [debug] [MainThread]: On master: Close
[0m21:29:51.814221 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:29:51.814888 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:29:51.815488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:29:51.815987 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:29:51.825454 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:29:51.826429 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:29:51.868270 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:29:51.869187 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:29:51.869705 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:29:51.870173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:51.891822 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:29:51.892419 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:29:51.893026 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast(source."room type " as varchar(50)) as room_type,
        cast(source."construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast(source."minimum nights" as integer) as minimum_nights,
        cast(source."number of reviews" as integer) as review_count,
        cast(source."review rate number" as numeric(3,1)) as review_rating,
        cast(source."calculated host listings count" as integer) as host_listings_count,
        case
            when cast(source."availability 365" as integer) < 0 then 0
            when cast(source."availability 365" as integer) > 365 then 365
                else cast(source."availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:29:51.896103 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column source.room type  does not exist
LINE 28:         cast(source."room type " as varchar(50)) as room_typ...
                      ^
HINT:  Perhaps you meant to reference the column "source.room type".

[0m21:29:51.896752 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:29:51.897512 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:29:51.900111 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column source.room type  does not exist
  LINE 28:         cast(source."room type " as varchar(50)) as room_typ...
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:29:51.902179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa960d37-3e95-4982-971e-6a2b542f4936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df6e80>]}
[0m21:29:51.903021 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:29:51.903794 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:29:51.904508 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column source.room type  does not exist
  LINE 28:         cast(source."room type " as varchar(50)) as room_typ...
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:29:51.905769 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.906214 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.906627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:51.929653 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:29:51.930217 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.930675 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.931106 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.931624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.932074 [debug] [MainThread]: On master: Close
[0m21:29:51.932661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:51.933071 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:29:51.933510 [info ] [MainThread]: 
[0m21:29:51.933984 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:29:51.934843 [debug] [MainThread]: Command end result
[0m21:29:51.958477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:29:51.960253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:29:51.967598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:29:51.968025 [info ] [MainThread]: 
[0m21:29:51.968587 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:29:51.969161 [info ] [MainThread]: 
[0m21:29:51.969997 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column source.room type  does not exist
  LINE 28:         cast(source."room type " as varchar(50)) as room_typ...
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:29:51.970656 [info ] [MainThread]: 
[0m21:29:51.971256 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:29:51.974448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2598888, "process_in_blocks": "0", "process_kernel_time": 0.246523, "process_mem_max_rss": "118329344", "process_out_blocks": "0", "process_user_time": 2.280624}
[0m21:29:51.975141 [debug] [MainThread]: Command `dbt run` failed at 21:29:51.975005 after 1.26 seconds
[0m21:29:51.975853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5abb0>]}
[0m21:29:51.976487 [debug] [MainThread]: Flushing usage events
[0m21:29:52.557085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:13.411827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c40280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c40b80>]}


============================== 21:30:13.416285 | 0795d974-ee53-4567-a94a-7edd1e8b83b5 ==============================
[0m21:30:13.416285 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:30:13.417025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:30:13.594743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3b50>]}
[0m21:30:13.657310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067517c0>]}
[0m21:30:13.658479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:13.771369 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:30:13.871499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:13.872176 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:30:14.105392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:30:14.110560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad7130>]}
[0m21:30:14.179614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:14.182625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:14.193573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e1cd0>]}
[0m21:30:14.194302 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:30:14.194766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab8d60>]}
[0m21:30:14.196036 [info ] [MainThread]: 
[0m21:30:14.196526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:14.196957 [info ] [MainThread]: 
[0m21:30:14.197608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:14.198465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:30:14.290211 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:30:14.290888 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:30:14.291431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:14.339888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m21:30:14.341473 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:30:14.346929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:30:14.353964 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:14.354451 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:30:14.355051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:14.377114 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:30:14.377655 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:14.378195 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:14.382025 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:30:14.383488 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:30:14.384046 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:30:14.389189 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.389645 [debug] [MainThread]: On master: BEGIN
[0m21:30:14.390055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:14.411941 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:30:14.412607 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.413128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:14.417290 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:30:14.418580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a261c0>]}
[0m21:30:14.419157 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:14.419722 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.420156 [debug] [MainThread]: On master: BEGIN
[0m21:30:14.420792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:14.421237 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.421673 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.422093 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.422629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:14.423059 [debug] [MainThread]: On master: Close
[0m21:30:14.425321 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:30:14.426016 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:30:14.426626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:30:14.427137 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:30:14.436660 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:30:14.437597 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:30:14.477184 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:30:14.478044 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:14.478484 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:30:14.478905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:30:14.500011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:30:14.500595 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:14.501191 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("source.room type " as varchar(50)) as room_type,
        cast(source."construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast(source."minimum nights" as integer) as minimum_nights,
        cast(source."number of reviews" as integer) as review_count,
        cast(source."review rate number" as numeric(3,1)) as review_rating,
        cast(source."calculated host listings count" as integer) as host_listings_count,
        case
            when cast(source."availability 365" as integer) < 0 then 0
            when cast(source."availability 365" as integer) > 365 then 365
                else cast(source."availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:30:14.502647 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "source.room type " does not exist
LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                      ^

[0m21:30:14.503147 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:30:14.503855 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:30:14.506276 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:14.508152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0795d974-ee53-4567-a94a-7edd1e8b83b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8b20>]}
[0m21:30:14.508921 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:30:14.509666 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:30:14.510361 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:30:14.511620 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.512052 [debug] [MainThread]: On master: BEGIN
[0m21:30:14.512455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:14.535302 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:30:14.535857 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.536319 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.536744 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.537299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:14.537778 [debug] [MainThread]: On master: Close
[0m21:30:14.538488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:14.538964 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:30:14.539429 [info ] [MainThread]: 
[0m21:30:14.539909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:30:14.540836 [debug] [MainThread]: Command end result
[0m21:30:14.564015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:14.565835 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:14.573660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:30:14.574190 [info ] [MainThread]: 
[0m21:30:14.574724 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:30:14.575186 [info ] [MainThread]: 
[0m21:30:14.575729 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:14.576179 [info ] [MainThread]: 
[0m21:30:14.576649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:30:14.579599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2387583, "process_in_blocks": "0", "process_kernel_time": 0.246047, "process_mem_max_rss": "117698560", "process_out_blocks": "0", "process_user_time": 2.248824}
[0m21:30:14.580215 [debug] [MainThread]: Command `dbt run` failed at 21:30:14.580088 after 1.24 seconds
[0m21:30:14.580755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f8be0>]}
[0m21:30:14.581291 [debug] [MainThread]: Flushing usage events
[0m21:30:15.121148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:23.772874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109574a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8b80>]}


============================== 21:30:23.777247 | 42c1c250-c946-474d-adca-f8bdf90e19b0 ==============================
[0m21:30:23.777247 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:30:23.777983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:23.952319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3d2b0>]}
[0m21:30:24.012897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86cfa0>]}
[0m21:30:24.013791 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:24.125868 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:30:24.226995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:24.227456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:24.234034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:30:24.263103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b580130>]}
[0m21:30:24.335854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:24.339244 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:24.350244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b555640>]}
[0m21:30:24.350817 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:30:24.351247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a3460>]}
[0m21:30:24.352552 [info ] [MainThread]: 
[0m21:30:24.353053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:24.353471 [info ] [MainThread]: 
[0m21:30:24.354041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:24.355025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:30:24.403271 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:30:24.403795 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:30:24.404194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:24.442405 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m21:30:24.443900 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:30:24.448923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:30:24.455844 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:24.456395 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:30:24.456841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:24.479726 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:30:24.480297 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:24.480771 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:24.484616 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:30:24.486108 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:30:24.486677 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:30:24.492226 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.492822 [debug] [MainThread]: On master: BEGIN
[0m21:30:24.493236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:24.514686 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m21:30:24.515229 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.515749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:24.519940 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:30:24.521375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab26f40>]}
[0m21:30:24.521963 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:24.522532 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.522965 [debug] [MainThread]: On master: BEGIN
[0m21:30:24.523621 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:24.524077 [debug] [MainThread]: On master: COMMIT
[0m21:30:24.524517 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.524938 [debug] [MainThread]: On master: COMMIT
[0m21:30:24.525535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:24.525986 [debug] [MainThread]: On master: Close
[0m21:30:24.528038 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:30:24.528715 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:30:24.529319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:30:24.529831 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:30:24.540297 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:30:24.541333 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:30:24.580188 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:30:24.581073 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:24.581537 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:30:24.581969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:30:24.603007 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:30:24.603610 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:24.604217 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("source.room type " as varchar(50)) as room_type,
        cast(source."construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast(source."minimum nights" as integer) as minimum_nights,
        cast(source."number of reviews" as integer) as review_count,
        cast(source."review rate number" as numeric(3,1)) as review_rating,
        cast(source."calculated host listings count" as integer) as host_listings_count,
        case
            when cast(source."availability 365" as integer) < 0 then 0
            when cast(source."availability 365" as integer) > 365 then 365
                else cast(source."availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:30:24.605794 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "source.room type " does not exist
LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                      ^

[0m21:30:24.606319 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:30:24.607069 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:30:24.609624 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:24.611558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c1c250-c946-474d-adca-f8bdf90e19b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9bc550>]}
[0m21:30:24.612362 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:30:24.613147 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:30:24.613863 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:30:24.615224 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.615664 [debug] [MainThread]: On master: BEGIN
[0m21:30:24.616082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:24.638863 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:30:24.639488 [debug] [MainThread]: On master: COMMIT
[0m21:30:24.639979 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:24.640433 [debug] [MainThread]: On master: COMMIT
[0m21:30:24.640985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:24.641495 [debug] [MainThread]: On master: Close
[0m21:30:24.642171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:24.642601 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:30:24.643117 [info ] [MainThread]: 
[0m21:30:24.643603 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m21:30:24.644480 [debug] [MainThread]: Command end result
[0m21:30:24.715663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:24.717545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:24.726343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:30:24.726892 [info ] [MainThread]: 
[0m21:30:24.727528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:30:24.728082 [info ] [MainThread]: 
[0m21:30:24.728700 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "source.room type " does not exist
  LINE 28:         cast("source.room type " as varchar(50)) as room_typ...
                        ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:24.729217 [info ] [MainThread]: 
[0m21:30:24.729756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:30:24.732840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0321058, "process_in_blocks": "0", "process_kernel_time": 0.235489, "process_mem_max_rss": "115281920", "process_out_blocks": "0", "process_user_time": 2.10254}
[0m21:30:24.733483 [debug] [MainThread]: Command `dbt run` failed at 21:30:24.733350 after 1.03 seconds
[0m21:30:24.734131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109574a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b555640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0b970>]}
[0m21:30:24.734870 [debug] [MainThread]: Flushing usage events
[0m21:30:25.266654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:57.765027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f52280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f52b80>]}


============================== 21:30:57.769417 | 9891a7a2-1d73-45f5-8ae3-72fe26c3696b ==============================
[0m21:30:57.769417 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:30:57.770172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:30:57.946213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105305b50>]}
[0m21:30:58.006643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a637c0>]}
[0m21:30:58.007650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:58.120005 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:30:58.220289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:58.220905 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:30:58.462649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:30:58.467650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de9130>]}
[0m21:30:58.535281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:58.538290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:58.549113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf3cd0>]}
[0m21:30:58.549682 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:30:58.550200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc8d60>]}
[0m21:30:58.551619 [info ] [MainThread]: 
[0m21:30:58.552054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:58.552480 [info ] [MainThread]: 
[0m21:30:58.553090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:58.553963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:30:58.651890 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:30:58.652571 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:30:58.653114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:58.696718 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m21:30:58.698257 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:30:58.703492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:30:58.710542 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:58.711024 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:30:58.711459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:58.733520 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:30:58.734065 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:30:58.734521 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:58.738334 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:30:58.739766 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:30:58.740323 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:30:58.745526 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.745983 [debug] [MainThread]: On master: BEGIN
[0m21:30:58.746400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:58.768109 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:30:58.768793 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.769324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:58.773692 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:30:58.775096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d391c0>]}
[0m21:30:58.775714 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:58.776332 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.776783 [debug] [MainThread]: On master: BEGIN
[0m21:30:58.777423 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:30:58.777879 [debug] [MainThread]: On master: COMMIT
[0m21:30:58.778320 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.778743 [debug] [MainThread]: On master: COMMIT
[0m21:30:58.779279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:58.779725 [debug] [MainThread]: On master: Close
[0m21:30:58.781797 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:30:58.782492 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:30:58.783111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:30:58.783606 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:30:58.793280 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:30:58.794308 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:30:58.834655 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:30:58.835576 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:58.836048 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:30:58.836557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:30:58.858024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:30:58.858641 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:30:58.859259 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type " as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:30:58.860783 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "room type " does not exist
LINE 28:         cast("room type " as varchar(50)) as room_type,
                      ^
HINT:  Perhaps you meant to reference the column "source.room type".

[0m21:30:58.861324 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:30:58.862034 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:30:58.864636 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:58.866596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9891a7a2-1d73-45f5-8ae3-72fe26c3696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0ab20>]}
[0m21:30:58.867457 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:30:58.868336 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:30:58.869066 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:30:58.870332 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.870776 [debug] [MainThread]: On master: BEGIN
[0m21:30:58.871192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:58.894520 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:30:58.895076 [debug] [MainThread]: On master: COMMIT
[0m21:30:58.895533 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:58.895955 [debug] [MainThread]: On master: COMMIT
[0m21:30:58.896487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:30:58.896936 [debug] [MainThread]: On master: Close
[0m21:30:58.897501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:58.897904 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:30:58.898351 [info ] [MainThread]: 
[0m21:30:58.898820 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:30:58.899668 [debug] [MainThread]: Command end result
[0m21:30:58.922726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:30:58.924624 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:30:58.931742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:30:58.932152 [info ] [MainThread]: 
[0m21:30:58.932653 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:30:58.933097 [info ] [MainThread]: 
[0m21:30:58.933652 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "room type " does not exist
  LINE 28:         cast("room type " as varchar(50)) as room_type,
                        ^
  HINT:  Perhaps you meant to reference the column "source.room type".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:30:58.934091 [info ] [MainThread]: 
[0m21:30:58.934541 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:30:58.937393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2434291, "process_in_blocks": "0", "process_kernel_time": 0.253286, "process_mem_max_rss": "117141504", "process_out_blocks": "0", "process_user_time": 2.250029}
[0m21:30:58.938116 [debug] [MainThread]: Command `dbt run` failed at 21:30:58.937930 after 1.24 seconds
[0m21:30:58.939021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104370160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0c940>]}
[0m21:30:58.939585 [debug] [MainThread]: Flushing usage events
[0m21:30:59.543499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:22.205651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd7fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b5ac0>]}


============================== 21:32:22.211561 | dd0c11e1-d8f9-4f66-bc9c-8612485e4f05 ==============================
[0m21:32:22.211561 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:32:22.212433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:22.436224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110652b0>]}
[0m21:32:22.502206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146a2e0>]}
[0m21:32:22.503343 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:22.637357 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:32:22.783710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:22.784475 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:32:23.055849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:32:23.062022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f4b130>]}
[0m21:32:23.140254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:32:23.143843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:32:23.166341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0ea30>]}
[0m21:32:23.167205 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:32:23.167756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0edc0>]}
[0m21:32:23.169566 [info ] [MainThread]: 
[0m21:32:23.170155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:32:23.170609 [info ] [MainThread]: 
[0m21:32:23.171289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:23.172433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:32:23.291106 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:32:23.291756 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:32:23.292263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:23.355083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m21:32:23.356706 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:32:23.362307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:32:23.369892 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:32:23.370461 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:32:23.370908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:23.395459 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:32:23.396007 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:32:23.396469 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:23.402041 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:32:23.403648 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:32:23.404246 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:32:23.409607 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.410150 [debug] [MainThread]: On master: BEGIN
[0m21:32:23.410572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:23.436869 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m21:32:23.437595 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.438123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:23.443267 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:32:23.445215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111efb4c0>]}
[0m21:32:23.446152 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:23.446784 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.447227 [debug] [MainThread]: On master: BEGIN
[0m21:32:23.447829 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:23.448259 [debug] [MainThread]: On master: COMMIT
[0m21:32:23.448688 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.449111 [debug] [MainThread]: On master: COMMIT
[0m21:32:23.449621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:23.450094 [debug] [MainThread]: On master: Close
[0m21:32:23.453155 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:32:23.453954 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:32:23.454608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:32:23.455131 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:32:23.465260 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:32:23.466760 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:32:23.509748 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:32:23.510778 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:32:23.511331 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:32:23.511821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:32:23.534878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:32:23.535500 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:32:23.536126 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:32:23.538006 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "construction year" does not exist
LINE 29:         cast("construction year" as integer) as construction...
                      ^
HINT:  Perhaps you meant to reference the column "source.Construction year".

[0m21:32:23.538684 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:32:23.539511 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:32:23.547755 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "construction year" does not exist
  LINE 29:         cast("construction year" as integer) as construction...
                        ^
  HINT:  Perhaps you meant to reference the column "source.Construction year".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:32:23.549994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd0c11e1-d8f9-4f66-bc9c-8612485e4f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63490>]}
[0m21:32:23.550962 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:32:23.551873 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:32:23.552672 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "construction year" does not exist
  LINE 29:         cast("construction year" as integer) as construction...
                        ^
  HINT:  Perhaps you meant to reference the column "source.Construction year".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:32:23.553970 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.554450 [debug] [MainThread]: On master: BEGIN
[0m21:32:23.554873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:23.580353 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m21:32:23.580939 [debug] [MainThread]: On master: COMMIT
[0m21:32:23.581405 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:23.581843 [debug] [MainThread]: On master: COMMIT
[0m21:32:23.582398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:23.582878 [debug] [MainThread]: On master: Close
[0m21:32:23.583528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:23.584030 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:32:23.584519 [info ] [MainThread]: 
[0m21:32:23.585181 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:32:23.586098 [debug] [MainThread]: Command end result
[0m21:32:23.609607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:32:23.611390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:32:23.619505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:32:23.620018 [info ] [MainThread]: 
[0m21:32:23.620671 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:32:23.621275 [info ] [MainThread]: 
[0m21:32:23.621878 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "construction year" does not exist
  LINE 29:         cast("construction year" as integer) as construction...
                        ^
  HINT:  Perhaps you meant to reference the column "source.Construction year".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:32:23.622372 [info ] [MainThread]: 
[0m21:32:23.622853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:32:23.626468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5105474, "process_in_blocks": "0", "process_kernel_time": 0.386683, "process_mem_max_rss": "117833728", "process_out_blocks": "0", "process_user_time": 2.579704}
[0m21:32:23.627160 [debug] [MainThread]: Command `dbt run` failed at 21:32:23.627029 after 1.51 seconds
[0m21:32:23.627697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd7fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fc430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d6cfd0>]}
[0m21:32:23.628213 [debug] [MainThread]: Flushing usage events
[0m21:32:24.264853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:43.823920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc67ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df9d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df9dac0>]}


============================== 21:32:43.830036 | 3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75 ==============================
[0m21:32:43.830036 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:32:43.831046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:44.042433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4d2b0>]}
[0m21:32:44.108172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3522e0>]}
[0m21:32:44.109541 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:44.237463 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:32:44.365040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:44.365773 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:32:44.626170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:32:44.633441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee34130>]}
[0m21:32:44.713810 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:32:44.718539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:32:44.737840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf5a30>]}
[0m21:32:44.738530 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:32:44.739034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf5dc0>]}
[0m21:32:44.740663 [info ] [MainThread]: 
[0m21:32:44.741258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:32:44.741765 [info ] [MainThread]: 
[0m21:32:44.742531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:44.743657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:32:44.855929 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:32:44.856585 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:32:44.857123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:44.914945 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m21:32:44.916634 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:32:44.922431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:32:44.929832 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:32:44.930402 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:32:44.930840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:44.955183 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:32:44.955756 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:32:44.956244 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:32:44.960582 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:32:44.962172 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:32:44.962805 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:32:44.968750 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:44.969313 [debug] [MainThread]: On master: BEGIN
[0m21:32:44.969761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:44.993565 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:32:44.994258 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:44.994791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:44.999335 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:32:45.000851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede24c0>]}
[0m21:32:45.001591 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:45.002410 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.002926 [debug] [MainThread]: On master: BEGIN
[0m21:32:45.003639 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:32:45.004116 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.004586 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.005034 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.005610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:45.006071 [debug] [MainThread]: On master: Close
[0m21:32:45.008998 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:32:45.009848 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:32:45.010521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:32:45.011127 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:32:45.021232 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:32:45.022170 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:32:45.065745 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:32:45.066729 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:32:45.067257 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:32:45.067736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:32:45.090266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:32:45.090893 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:32:45.091530 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    -- models/airbnb_transformed.sql

with source as (

    select * from "elt_project"."public"."airbnb_data"

),

cleaned as (

    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable,
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count,
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values in house rules are replaced with 'No rules
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replace NULL with false (boolean column) 
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replace NULL with 1 (assuming 1 night as default)
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replace NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replace NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replace NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replace NULL with 0
        coalesce(is_host_verified,'unconfirmed') as is_host_verified,
        coalesce(review_count,0) as review_count
    from source
    where price is not null
        and cancellation_policy is not null -- dropping null values
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
    
)

select * from cleaned
  );
[0m21:32:45.094882 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_instant_bookable" does not exist
LINE 43:         coalesce(is_instant_bookable, false) as is_instant_b...
                          ^
HINT:  Perhaps you meant to reference the column "source.instant_bookable".

[0m21:32:45.095457 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:32:45.096162 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:32:45.101691 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 43:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:32:45.103914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f6dc48c-5fd2-41b2-b15a-88d71c0a4a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb4a490>]}
[0m21:32:45.104789 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:32:45.105611 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:32:45.106376 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 43:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:32:45.107714 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.108186 [debug] [MainThread]: On master: BEGIN
[0m21:32:45.108604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:45.132241 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:32:45.132843 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.133323 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:45.133775 [debug] [MainThread]: On master: COMMIT
[0m21:32:45.134364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:32:45.134844 [debug] [MainThread]: On master: Close
[0m21:32:45.135447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:45.135880 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:32:45.136553 [info ] [MainThread]: 
[0m21:32:45.137144 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m21:32:45.138105 [debug] [MainThread]: Command end result
[0m21:32:45.162376 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:32:45.164220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:32:45.171787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:32:45.172307 [info ] [MainThread]: 
[0m21:32:45.172925 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:32:45.173407 [info ] [MainThread]: 
[0m21:32:45.173959 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 43:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:32:45.174456 [info ] [MainThread]: 
[0m21:32:45.174942 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:32:45.179146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.439344, "process_in_blocks": "0", "process_kernel_time": 0.311035, "process_mem_max_rss": "117796864", "process_out_blocks": "0", "process_user_time": 2.483547}
[0m21:32:45.179959 [debug] [MainThread]: Command `dbt run` failed at 21:32:45.179808 after 1.44 seconds
[0m21:32:45.180557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc67ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e619bb0>]}
[0m21:32:45.181152 [debug] [MainThread]: Flushing usage events
[0m21:32:45.738349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:59.681800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc29280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc29b80>]}


============================== 21:37:59.687578 | 80606e23-0244-49ae-b368-9ea95719b306 ==============================
[0m21:37:59.687578 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:37:59.688345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:37:59.906805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffdeb50>]}
[0m21:37:59.970986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f73a7c0>]}
[0m21:37:59.972382 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:38:00.095037 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:38:00.236233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:00.236905 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:38:00.475928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:38:00.482790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac0130>]}
[0m21:38:00.552451 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:00.555566 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:00.581043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cacd0>]}
[0m21:38:00.581717 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:38:00.582207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa1d60>]}
[0m21:38:00.583648 [info ] [MainThread]: 
[0m21:38:00.584145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:00.584569 [info ] [MainThread]: 
[0m21:38:00.585204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:00.586196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:38:00.703703 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:38:00.704640 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:38:00.705278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:00.768534 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m21:38:00.770188 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:38:00.776414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:38:00.783874 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:00.784443 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:38:00.784887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:00.807972 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:38:00.808583 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:00.809088 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:38:00.814986 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:38:00.816535 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:38:00.817131 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:38:00.822726 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.823272 [debug] [MainThread]: On master: BEGIN
[0m21:38:00.823704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:00.845968 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:38:00.846665 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.847202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:38:00.852360 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:38:00.853785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0f1c0>]}
[0m21:38:00.854378 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:00.855003 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.855447 [debug] [MainThread]: On master: BEGIN
[0m21:38:00.856099 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:38:00.856563 [debug] [MainThread]: On master: COMMIT
[0m21:38:00.857021 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.857474 [debug] [MainThread]: On master: COMMIT
[0m21:38:00.858012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:00.858470 [debug] [MainThread]: On master: Close
[0m21:38:00.861168 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:38:00.861862 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:38:00.862457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:38:00.862965 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:38:00.872483 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:38:00.873834 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:38:00.914355 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:38:00.915378 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:00.915903 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:38:00.916396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:38:00.938818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:38:00.939428 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:00.940040 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned;
  );
[0m21:38:00.941898 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 59: select * from cleaned;
                              ^

[0m21:38:00.942556 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:38:00.943347 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:38:00.957325 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 59: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:00.959817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80606e23-0244-49ae-b368-9ea95719b306', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe1b20>]}
[0m21:38:00.960686 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.10s]
[0m21:38:00.961530 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:38:00.962310 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 59: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:38:00.963675 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.964147 [debug] [MainThread]: On master: BEGIN
[0m21:38:00.964591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:00.988933 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:38:00.989522 [debug] [MainThread]: On master: COMMIT
[0m21:38:00.990000 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:00.990544 [debug] [MainThread]: On master: COMMIT
[0m21:38:00.991104 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:00.991557 [debug] [MainThread]: On master: Close
[0m21:38:00.992130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:00.992550 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:38:00.993006 [info ] [MainThread]: 
[0m21:38:00.993488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:38:00.994368 [debug] [MainThread]: Command end result
[0m21:38:01.019017 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:01.020771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:01.028356 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:38:01.028858 [info ] [MainThread]: 
[0m21:38:01.029391 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:01.029866 [info ] [MainThread]: 
[0m21:38:01.030405 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ";"
  LINE 59: select * from cleaned;
                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:01.030857 [info ] [MainThread]: 
[0m21:38:01.031340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:38:01.035316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4428935, "process_in_blocks": "0", "process_kernel_time": 0.392939, "process_mem_max_rss": "117497856", "process_out_blocks": "0", "process_user_time": 2.497304}
[0m21:38:01.036074 [debug] [MainThread]: Command `dbt run` failed at 21:38:01.035921 after 1.44 seconds
[0m21:38:01.036639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3021f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b61340>]}
[0m21:38:01.037189 [debug] [MainThread]: Flushing usage events
[0m21:38:01.702013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:14.924211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7bb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf0b50>]}


============================== 21:38:14.930052 | a35f3d61-2d6f-43ae-b686-ae4c249b2adb ==============================
[0m21:38:14.930052 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:38:14.930860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:38:15.136533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961abb0>]}
[0m21:38:15.195986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5996d0>]}
[0m21:38:15.197652 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:38:15.319185 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:38:15.445331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:15.445997 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:38:15.681222 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:38:15.686232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c987130>]}
[0m21:38:15.755399 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:15.758720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:15.780314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7ff280>]}
[0m21:38:15.781000 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:38:15.781491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c948e20>]}
[0m21:38:15.782946 [info ] [MainThread]: 
[0m21:38:15.783433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:15.783875 [info ] [MainThread]: 
[0m21:38:15.784513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:15.785511 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:38:15.887180 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:38:15.887848 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:38:15.888360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:15.946032 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m21:38:15.947744 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:38:15.953204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:38:15.960091 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:15.960602 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:38:15.961020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:15.990475 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m21:38:15.991016 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:15.991470 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:38:15.995239 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:38:15.996674 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:38:15.997230 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:38:16.002966 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.003497 [debug] [MainThread]: On master: BEGIN
[0m21:38:16.003915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:16.027532 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:38:16.028214 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.028736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:38:16.033129 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:38:16.034506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af09310>]}
[0m21:38:16.035097 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:16.035670 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.036095 [debug] [MainThread]: On master: BEGIN
[0m21:38:16.036779 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:38:16.037222 [debug] [MainThread]: On master: COMMIT
[0m21:38:16.037653 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.038066 [debug] [MainThread]: On master: COMMIT
[0m21:38:16.038634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:16.039088 [debug] [MainThread]: On master: Close
[0m21:38:16.041888 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:38:16.042601 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:38:16.043240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:38:16.043745 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:38:16.053518 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:38:16.054644 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:38:16.097892 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:38:16.098880 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:16.099375 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:38:16.099842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:38:16.123099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:38:16.123709 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:16.124333 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(is_instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:38:16.126365 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_instant_bookable" does not exist
LINE 38:         coalesce(is_instant_bookable, false) as is_instant_b...
                          ^
HINT:  Perhaps you meant to reference the column "source.instant_bookable".

[0m21:38:16.126976 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:38:16.127771 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:38:16.132931 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 38:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:16.135111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a35f3d61-2d6f-43ae-b686-ae4c249b2adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55a430>]}
[0m21:38:16.136003 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:38:16.136933 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:38:16.137680 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 38:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:38:16.139043 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.139510 [debug] [MainThread]: On master: BEGIN
[0m21:38:16.139937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:16.162795 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:38:16.163359 [debug] [MainThread]: On master: COMMIT
[0m21:38:16.163820 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:16.164263 [debug] [MainThread]: On master: COMMIT
[0m21:38:16.164832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:16.165319 [debug] [MainThread]: On master: Close
[0m21:38:16.165963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:16.166494 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:38:16.167054 [info ] [MainThread]: 
[0m21:38:16.167707 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:38:16.168707 [debug] [MainThread]: Command end result
[0m21:38:16.194001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:16.195775 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:16.203669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:38:16.204155 [info ] [MainThread]: 
[0m21:38:16.204755 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:16.205258 [info ] [MainThread]: 
[0m21:38:16.205787 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" does not exist
  LINE 38:         coalesce(is_instant_bookable, false) as is_instant_b...
                            ^
  HINT:  Perhaps you meant to reference the column "source.instant_bookable".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:16.206273 [info ] [MainThread]: 
[0m21:38:16.206742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:38:16.210431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.377472, "process_in_blocks": "0", "process_kernel_time": 0.27732, "process_mem_max_rss": "117063680", "process_out_blocks": "0", "process_user_time": 2.33504}
[0m21:38:16.211103 [debug] [MainThread]: Command `dbt run` failed at 21:38:16.210964 after 1.38 seconds
[0m21:38:16.211669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7bb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca17610>]}
[0m21:38:16.212223 [debug] [MainThread]: Flushing usage events
[0m21:38:16.729143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:49.668084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c27280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c27b80>]}


============================== 21:38:49.672550 | 515c98f9-9145-4cde-aeaa-eacb1fd93bc0 ==============================
[0m21:38:49.672550 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:38:49.673288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:38:49.848029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdcb50>]}
[0m21:38:49.908001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097387c0>]}
[0m21:38:49.908928 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:38:50.030798 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:38:50.152392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:50.153059 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:38:50.388002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:38:50.392932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabe130>]}
[0m21:38:50.460533 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:50.463908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:50.485933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c8cd0>]}
[0m21:38:50.486577 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:38:50.487073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9fd60>]}
[0m21:38:50.488434 [info ] [MainThread]: 
[0m21:38:50.488913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:50.489342 [info ] [MainThread]: 
[0m21:38:50.489923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:50.490944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:38:50.604558 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:38:50.605221 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:38:50.605762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:50.657630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m21:38:50.659199 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:38:50.664608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:38:50.672265 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:50.672829 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:38:50.673258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:50.695842 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:38:50.696391 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:38:50.696857 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:38:50.700760 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:38:50.702284 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:38:50.702908 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:38:50.708274 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.708801 [debug] [MainThread]: On master: BEGIN
[0m21:38:50.709219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:50.731845 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:38:50.732527 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.733054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:38:50.737434 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:38:50.738846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0d1c0>]}
[0m21:38:50.739457 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:50.740065 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.740501 [debug] [MainThread]: On master: BEGIN
[0m21:38:50.741164 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:38:50.741625 [debug] [MainThread]: On master: COMMIT
[0m21:38:50.742066 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.742489 [debug] [MainThread]: On master: COMMIT
[0m21:38:50.743031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:50.743473 [debug] [MainThread]: On master: Close
[0m21:38:50.746205 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:38:50.746901 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:38:50.747514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:38:50.748025 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:38:50.758177 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:38:50.759323 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:38:50.801885 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:38:50.802882 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:50.803403 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:38:50.803894 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:38:50.827115 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:38:50.827741 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:38:50.828378 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:38:50.830151 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "minimum_nights" does not exist
LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                          ^
HINT:  Perhaps you meant to reference the column "source.minimum nights".

[0m21:38:50.830738 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:38:50.831476 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:38:50.836572 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:50.838772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515c98f9-9145-4cde-aeaa-eacb1fd93bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdfb20>]}
[0m21:38:50.839646 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:38:50.840434 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:38:50.841178 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:38:50.842480 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.842926 [debug] [MainThread]: On master: BEGIN
[0m21:38:50.843345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:50.865953 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:38:50.866555 [debug] [MainThread]: On master: COMMIT
[0m21:38:50.867035 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:50.867474 [debug] [MainThread]: On master: COMMIT
[0m21:38:50.868085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:50.868642 [debug] [MainThread]: On master: Close
[0m21:38:50.869406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:50.869874 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:38:50.870347 [info ] [MainThread]: 
[0m21:38:50.870982 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:38:50.872127 [debug] [MainThread]: Command end result
[0m21:38:50.896405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:38:50.898143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:38:50.905997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:38:50.906514 [info ] [MainThread]: 
[0m21:38:50.907057 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:50.907530 [info ] [MainThread]: 
[0m21:38:50.908076 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:38:50.908550 [info ] [MainThread]: 
[0m21:38:50.909015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:38:50.912649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3163213, "process_in_blocks": "0", "process_kernel_time": 0.273249, "process_mem_max_rss": "117141504", "process_out_blocks": "0", "process_user_time": 2.302249}
[0m21:38:50.913269 [debug] [MainThread]: Command `dbt run` failed at 21:38:50.913143 after 1.32 seconds
[0m21:38:50.913820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab67cd0>]}
[0m21:38:50.914365 [debug] [MainThread]: Flushing usage events
[0m21:38:51.492463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:58.692607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962cc10>]}


============================== 21:39:58.697792 | c2b46bc9-c487-4934-abb5-39766d1fa017 ==============================
[0m21:39:58.697792 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:39:58.698529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:39:58.983227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d1ee0>]}
[0m21:39:59.049134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f9a30>]}
[0m21:39:59.050553 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:39:59.180539 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:39:59.313556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:59.314064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:59.321039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:39:59.348933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a304130>]}
[0m21:39:59.419486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:39:59.423017 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:39:59.444771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f6190>]}
[0m21:39:59.445398 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:39:59.445858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f6ac0>]}
[0m21:39:59.447265 [info ] [MainThread]: 
[0m21:39:59.447747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:59.448148 [info ] [MainThread]: 
[0m21:39:59.448741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:39:59.449667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:39:59.511925 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:39:59.512511 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:39:59.512949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:59.563810 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m21:39:59.565388 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:39:59.570954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:39:59.578057 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:39:59.578716 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:39:59.579181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:59.601282 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:39:59.601885 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:39:59.602419 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:39:59.607985 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:39:59.609502 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:39:59.610112 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:39:59.615624 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.616185 [debug] [MainThread]: On master: BEGIN
[0m21:39:59.616628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:59.639377 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:39:59.639941 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.640473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:39:59.645578 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:39:59.647104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707d0a0>]}
[0m21:39:59.647727 [debug] [MainThread]: On master: ROLLBACK
[0m21:39:59.648392 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.648851 [debug] [MainThread]: On master: BEGIN
[0m21:39:59.649535 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:39:59.650008 [debug] [MainThread]: On master: COMMIT
[0m21:39:59.650452 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.650882 [debug] [MainThread]: On master: COMMIT
[0m21:39:59.651418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:39:59.651866 [debug] [MainThread]: On master: Close
[0m21:39:59.654705 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:39:59.655398 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:39:59.656034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:39:59.656558 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:39:59.667475 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:39:59.668801 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:39:59.709853 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:39:59.710841 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:39:59.711363 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:39:59.711844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:39:59.734308 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:39:59.734921 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:39:59.735526 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(minimum_nights, 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:39:59.737721 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "minimum_nights" does not exist
LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                          ^
HINT:  Perhaps you meant to reference the column "source.minimum nights".

[0m21:39:59.738282 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:39:59.739024 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:39:59.746841 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:39:59.749257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b46bc9-c487-4934-abb5-39766d1fa017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73a4c0>]}
[0m21:39:59.750085 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:39:59.750873 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:39:59.751604 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:39:59.752890 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.753346 [debug] [MainThread]: On master: BEGIN
[0m21:39:59.753766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:39:59.777779 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:39:59.778381 [debug] [MainThread]: On master: COMMIT
[0m21:39:59.778864 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:59.779319 [debug] [MainThread]: On master: COMMIT
[0m21:39:59.779902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:39:59.780374 [debug] [MainThread]: On master: Close
[0m21:39:59.780977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:59.781404 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:39:59.781925 [info ] [MainThread]: 
[0m21:39:59.782501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m21:39:59.783458 [debug] [MainThread]: Command end result
[0m21:39:59.858659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:39:59.860557 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:39:59.868886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:39:59.869439 [info ] [MainThread]: 
[0m21:39:59.870046 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:59.870552 [info ] [MainThread]: 
[0m21:39:59.871123 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "minimum_nights" does not exist
  LINE 39:         coalesce(minimum_nights, 1) as minimum_nights,  -- R...
                            ^
  HINT:  Perhaps you meant to reference the column "source.minimum nights".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:39:59.871615 [info ] [MainThread]: 
[0m21:39:59.872116 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:39:59.876433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2726338, "process_in_blocks": "0", "process_kernel_time": 0.384398, "process_mem_max_rss": "113709056", "process_out_blocks": "0", "process_user_time": 2.312876}
[0m21:39:59.877512 [debug] [MainThread]: Command `dbt run` failed at 21:39:59.877297 after 1.27 seconds
[0m21:39:59.878218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d051f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3247f0>]}
[0m21:39:59.878822 [debug] [MainThread]: Flushing usage events
[0m21:40:00.513320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:07.680129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111765a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a992b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a99bb0>]}


============================== 21:40:07.684669 | 02e01afa-1b7e-4006-808c-80224fa029c6 ==============================
[0m21:40:07.684669 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:40:07.685421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:40:07.872261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128df0d0>]}
[0m21:40:07.936197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2e940>]}
[0m21:40:07.937141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:40:08.055166 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:40:08.161994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:08.162694 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:40:08.415322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:40:08.420649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11392f130>]}
[0m21:40:08.497545 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:40:08.500789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:40:08.513167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11373ad60>]}
[0m21:40:08.513802 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:40:08.514266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d491f0>]}
[0m21:40:08.515699 [info ] [MainThread]: 
[0m21:40:08.516173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:08.516658 [info ] [MainThread]: 
[0m21:40:08.517352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:08.518461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:40:08.615173 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:40:08.615841 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:40:08.616384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:08.658793 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m21:40:08.660413 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:40:08.665833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:40:08.673261 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:40:08.673840 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:40:08.674294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:08.696603 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:40:08.697161 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:40:08.697630 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:40:08.701428 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:40:08.702905 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:40:08.703487 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:40:08.708963 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.709508 [debug] [MainThread]: On master: BEGIN
[0m21:40:08.709945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:08.731883 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:40:08.732556 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.733074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:40:08.737259 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:40:08.738642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138cac10>]}
[0m21:40:08.739245 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:08.739883 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.740348 [debug] [MainThread]: On master: BEGIN
[0m21:40:08.741040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:40:08.741512 [debug] [MainThread]: On master: COMMIT
[0m21:40:08.741962 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.742386 [debug] [MainThread]: On master: COMMIT
[0m21:40:08.742933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:08.743394 [debug] [MainThread]: On master: Close
[0m21:40:08.745518 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:40:08.746211 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:40:08.746887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:40:08.747408 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:40:08.757818 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:40:08.758855 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:40:08.801202 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:40:08.802179 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:40:08.802703 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:40:08.803207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:08.825714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:40:08.826319 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:40:08.826922 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce("minimum nights", 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:40:08.829529 [debug] [Thread-1  ]: Postgres adapter: Postgres error: COALESCE types text and integer cannot be matched
LINE 39:         coalesce("minimum nights", 1) as minimum_nights,  --...
                                            ^

[0m21:40:08.830041 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:40:08.830771 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:40:08.833247 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 39:         coalesce("minimum nights", 1) as minimum_nights,  --...
                                              ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:40:08.835185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e01afa-1b7e-4006-808c-80224fa029c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a47e20>]}
[0m21:40:08.836002 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:40:08.836809 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:40:08.837526 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 39:         coalesce("minimum nights", 1) as minimum_nights,  --...
                                              ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:40:08.838816 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.839272 [debug] [MainThread]: On master: BEGIN
[0m21:40:08.839803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:08.863230 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:40:08.863803 [debug] [MainThread]: On master: COMMIT
[0m21:40:08.864281 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:08.864718 [debug] [MainThread]: On master: COMMIT
[0m21:40:08.865254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:08.865718 [debug] [MainThread]: On master: Close
[0m21:40:08.866320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:08.867204 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:40:08.867792 [info ] [MainThread]: 
[0m21:40:08.868381 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:40:08.869324 [debug] [MainThread]: Command end result
[0m21:40:08.894037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:40:08.895805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:40:08.903894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:40:08.904400 [info ] [MainThread]: 
[0m21:40:08.904922 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:40:08.905391 [info ] [MainThread]: 
[0m21:40:08.905926 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 39:         coalesce("minimum nights", 1) as minimum_nights,  --...
                                              ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:40:08.906370 [info ] [MainThread]: 
[0m21:40:08.906838 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:40:08.909728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3063903, "process_in_blocks": "0", "process_kernel_time": 0.250909, "process_mem_max_rss": "118177792", "process_out_blocks": "0", "process_user_time": 2.437806}
[0m21:40:08.910420 [debug] [MainThread]: Command `dbt run` failed at 21:40:08.910285 after 1.31 seconds
[0m21:40:08.911187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111765a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d9d30>]}
[0m21:40:08.911768 [debug] [MainThread]: Flushing usage events
[0m21:40:09.464067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:26.260660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3eb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ebb80>]}


============================== 21:43:26.265102 | a1b683dc-bf98-4247-81a6-58d3663f2892 ==============================
[0m21:43:26.265102 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:43:26.265838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:43:26.445817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6802b0>]}
[0m21:43:26.506592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3affa0>]}
[0m21:43:26.507514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:43:26.615680 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:43:26.718365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:26.719052 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:43:26.960377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:43:26.965290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f282130>]}
[0m21:43:27.037130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:43:27.040368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:43:27.052227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88d30>]}
[0m21:43:27.052865 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:43:27.053344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f262ca0>]}
[0m21:43:27.054775 [info ] [MainThread]: 
[0m21:43:27.055257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:27.055663 [info ] [MainThread]: 
[0m21:43:27.056290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:43:27.057252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:43:27.155746 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:43:27.156420 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:43:27.156948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:27.200871 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m21:43:27.202417 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:43:27.207651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:43:27.214527 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:43:27.215006 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:43:27.215438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:27.237719 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:43:27.238269 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:43:27.238730 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:43:27.242623 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:43:27.244042 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:43:27.244589 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:43:27.249665 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.250117 [debug] [MainThread]: On master: BEGIN
[0m21:43:27.250532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:27.272531 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:43:27.273199 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.273716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:43:27.278054 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:43:27.279409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f3fa0>]}
[0m21:43:27.280016 [debug] [MainThread]: On master: ROLLBACK
[0m21:43:27.280622 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.281067 [debug] [MainThread]: On master: BEGIN
[0m21:43:27.281744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:43:27.282221 [debug] [MainThread]: On master: COMMIT
[0m21:43:27.282705 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.283149 [debug] [MainThread]: On master: COMMIT
[0m21:43:27.283705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:27.284159 [debug] [MainThread]: On master: Close
[0m21:43:27.286218 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:43:27.286878 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:43:27.287472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:43:27.287973 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:43:27.297615 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:43:27.298733 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:43:27.338863 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:43:27.339771 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:43:27.340250 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:43:27.340704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:27.362363 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:43:27.362972 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:43:27.363576 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(number_of_reviews, 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:43:27.365260 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "number_of_reviews" does not exist
LINE 40:         coalesce(number_of_reviews, 0) as number_of_reviews,...
                          ^
HINT:  Perhaps you meant to reference the column "source.number of reviews".

[0m21:43:27.365785 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:43:27.366509 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:43:27.369108 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce(number_of_reviews, 0) as number_of_reviews,...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:43:27.371113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1b683dc-bf98-4247-81a6-58d3663f2892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfa3130>]}
[0m21:43:27.371942 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:43:27.372712 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:43:27.373441 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce(number_of_reviews, 0) as number_of_reviews,...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:43:27.374703 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.375140 [debug] [MainThread]: On master: BEGIN
[0m21:43:27.375631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:27.398834 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:43:27.399434 [debug] [MainThread]: On master: COMMIT
[0m21:43:27.399926 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:27.400397 [debug] [MainThread]: On master: COMMIT
[0m21:43:27.400983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:27.401454 [debug] [MainThread]: On master: Close
[0m21:43:27.402100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:27.402594 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:43:27.403083 [info ] [MainThread]: 
[0m21:43:27.403569 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:43:27.404444 [debug] [MainThread]: Command end result
[0m21:43:27.426711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:43:27.428640 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:43:27.436323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:43:27.436813 [info ] [MainThread]: 
[0m21:43:27.437395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:27.437861 [info ] [MainThread]: 
[0m21:43:27.438478 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce(number_of_reviews, 0) as number_of_reviews,...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:43:27.438940 [info ] [MainThread]: 
[0m21:43:27.439406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:43:27.442097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2548221, "process_in_blocks": "0", "process_kernel_time": 0.255046, "process_mem_max_rss": "116768768", "process_out_blocks": "0", "process_user_time": 2.294778}
[0m21:43:27.442700 [debug] [MainThread]: Command `dbt run` failed at 21:43:27.442579 after 1.26 seconds
[0m21:43:27.443243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0540a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ce1f0>]}
[0m21:43:27.443773 [debug] [MainThread]: Flushing usage events
[0m21:43:28.079219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:52.130532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0141c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d014ac0>]}


============================== 21:43:52.135082 | 30349ff8-7798-4854-9eab-6e88236848e4 ==============================
[0m21:43:52.135082 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:43:52.135814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:43:52.322252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc12b0>]}
[0m21:43:52.386293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c92e0>]}
[0m21:43:52.387322 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:43:52.504243 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:43:52.613940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:52.614631 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:43:52.856277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:43:52.861377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deaa130>]}
[0m21:43:52.933047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:43:52.936341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:43:52.958797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de6da30>]}
[0m21:43:52.959479 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:43:52.959969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de6ddc0>]}
[0m21:43:52.961425 [info ] [MainThread]: 
[0m21:43:52.961920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:52.962353 [info ] [MainThread]: 
[0m21:43:52.962994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:43:52.963975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:43:53.072317 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:43:53.072992 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:43:53.073526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:53.125695 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m21:43:53.127445 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:43:53.132912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:43:53.139877 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:43:53.140375 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:43:53.140805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:53.163366 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:43:53.163905 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:43:53.164360 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:43:53.168170 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:43:53.169602 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:43:53.170200 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:43:53.175571 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.176100 [debug] [MainThread]: On master: BEGIN
[0m21:43:53.176520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:53.198571 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:43:53.199253 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.199771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:43:53.203985 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:43:53.205277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df49340>]}
[0m21:43:53.205854 [debug] [MainThread]: On master: ROLLBACK
[0m21:43:53.206417 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.206849 [debug] [MainThread]: On master: BEGIN
[0m21:43:53.207501 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:43:53.207957 [debug] [MainThread]: On master: COMMIT
[0m21:43:53.208380 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.208784 [debug] [MainThread]: On master: COMMIT
[0m21:43:53.209341 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:53.209796 [debug] [MainThread]: On master: Close
[0m21:43:53.212659 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:43:53.213328 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:43:53.213923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:43:53.214421 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:43:53.224016 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:43:53.225137 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:43:53.265502 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:43:53.266462 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:43:53.266947 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:43:53.267400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:53.290356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:43:53.290953 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:43:53.291554 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number_of_reviews", 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:43:53.293191 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "number_of_reviews" does not exist
LINE 40:         coalesce("number_of_reviews", 0) as number_of_review...
                          ^
HINT:  Perhaps you meant to reference the column "source.number of reviews".

[0m21:43:53.293702 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:43:53.294387 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:43:53.299603 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce("number_of_reviews", 0) as number_of_review...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:43:53.301917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30349ff8-7798-4854-9eab-6e88236848e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc1490>]}
[0m21:43:53.302687 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:43:53.303435 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:43:53.304140 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce("number_of_reviews", 0) as number_of_review...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:43:53.305315 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.305761 [debug] [MainThread]: On master: BEGIN
[0m21:43:53.306178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:53.329272 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:43:53.329826 [debug] [MainThread]: On master: COMMIT
[0m21:43:53.330303 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:53.330735 [debug] [MainThread]: On master: COMMIT
[0m21:43:53.331281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:43:53.331730 [debug] [MainThread]: On master: Close
[0m21:43:53.332299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:53.332705 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:43:53.333161 [info ] [MainThread]: 
[0m21:43:53.333711 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:43:53.334799 [debug] [MainThread]: Command end result
[0m21:43:53.357406 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:43:53.359232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:43:53.367018 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:43:53.367631 [info ] [MainThread]: 
[0m21:43:53.368171 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:53.368655 [info ] [MainThread]: 
[0m21:43:53.369449 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "number_of_reviews" does not exist
  LINE 40:         coalesce("number_of_reviews", 0) as number_of_review...
                            ^
  HINT:  Perhaps you meant to reference the column "source.number of reviews".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:43:53.369976 [info ] [MainThread]: 
[0m21:43:53.370470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:43:53.373671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3214927, "process_in_blocks": "0", "process_kernel_time": 0.281053, "process_mem_max_rss": "117710848", "process_out_blocks": "0", "process_user_time": 2.404385}
[0m21:43:53.374353 [debug] [MainThread]: Command `dbt run` failed at 21:43:53.374215 after 1.32 seconds
[0m21:43:53.374908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de47670>]}
[0m21:43:53.375441 [debug] [MainThread]: Flushing usage events
[0m21:43:53.913993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:10.734732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2bac0>]}


============================== 21:44:10.738986 | 168acfe6-ffa6-4b83-9cdd-64115bedd686 ==============================
[0m21:44:10.738986 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:44:10.739685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:10.919134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112adb2b0>]}
[0m21:44:10.981040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee02e0>]}
[0m21:44:10.981979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:44:11.093440 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:44:11.195512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:44:11.196188 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:44:11.434998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:44:11.440159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c2130>]}
[0m21:44:11.509037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:44:11.512131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:44:11.523658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113983a30>]}
[0m21:44:11.524234 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:44:11.524735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113983dc0>]}
[0m21:44:11.526350 [info ] [MainThread]: 
[0m21:44:11.527100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:11.527527 [info ] [MainThread]: 
[0m21:44:11.528147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:44:11.529128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:44:11.628340 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:44:11.629024 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:44:11.629659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:11.672622 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m21:44:11.674173 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:44:11.679559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:44:11.686737 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:44:11.687261 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:44:11.687690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:11.709608 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:44:11.710148 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:44:11.710606 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:44:11.714379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:44:11.715816 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:44:11.716365 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:44:11.721600 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.722113 [debug] [MainThread]: On master: BEGIN
[0m21:44:11.722538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:11.744685 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:44:11.745356 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.745876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:44:11.750191 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:44:11.751489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139714c0>]}
[0m21:44:11.752068 [debug] [MainThread]: On master: ROLLBACK
[0m21:44:11.752635 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.753066 [debug] [MainThread]: On master: BEGIN
[0m21:44:11.753723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:44:11.754182 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.754608 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.755016 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.755532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:44:11.755962 [debug] [MainThread]: On master: Close
[0m21:44:11.757925 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:44:11.758571 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:44:11.759149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:44:11.759634 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:44:11.769214 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:44:11.770267 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:44:11.810309 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:44:11.811199 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:44:11.811663 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:44:11.812099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:44:11.833571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:44:11.834185 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:44:11.834797 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as number_of_reviews,  -- Replaced NULL with 0
        coalesce(review_rate_number, 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(host_listings_count, 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(availability_365, 0) as availability_365,  -- Replaced NULL with 0
        coalesce(is_host_verified, 'unconfirmed') as is_host_verified, -- No need to COALESCE again
        coalesce(review_count, 0) as review_count -- Avoid duplicate definition
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:44:11.836460 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "review_rate_number" does not exist
LINE 41:         coalesce(review_rate_number, 0) as review_rate_numbe...
                          ^
HINT:  Perhaps you meant to reference the column "source.review rate number".

[0m21:44:11.836961 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:44:11.837654 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:44:11.840208 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "review_rate_number" does not exist
  LINE 41:         coalesce(review_rate_number, 0) as review_rate_numbe...
                            ^
  HINT:  Perhaps you meant to reference the column "source.review rate number".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:44:11.842119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '168acfe6-ffa6-4b83-9cdd-64115bedd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d8490>]}
[0m21:44:11.842921 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:44:11.843765 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:44:11.844475 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "review_rate_number" does not exist
  LINE 41:         coalesce(review_rate_number, 0) as review_rate_numbe...
                            ^
  HINT:  Perhaps you meant to reference the column "source.review rate number".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:44:11.845770 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.846219 [debug] [MainThread]: On master: BEGIN
[0m21:44:11.846641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:11.869780 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:44:11.870360 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.870830 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:11.871288 [debug] [MainThread]: On master: COMMIT
[0m21:44:11.871855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:44:11.872377 [debug] [MainThread]: On master: Close
[0m21:44:11.872978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:11.873427 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:44:11.873881 [info ] [MainThread]: 
[0m21:44:11.874405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:44:11.875298 [debug] [MainThread]: Command end result
[0m21:44:11.898371 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:44:11.900148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:44:11.907808 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:44:11.908241 [info ] [MainThread]: 
[0m21:44:11.908779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:44:11.909245 [info ] [MainThread]: 
[0m21:44:11.909761 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "review_rate_number" does not exist
  LINE 41:         coalesce(review_rate_number, 0) as review_rate_numbe...
                            ^
  HINT:  Perhaps you meant to reference the column "source.review rate number".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:44:11.910224 [info ] [MainThread]: 
[0m21:44:11.910691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:44:11.913410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.251466, "process_in_blocks": "0", "process_kernel_time": 0.265434, "process_mem_max_rss": "117555200", "process_out_blocks": "0", "process_user_time": 2.360834}
[0m21:44:11.913965 [debug] [MainThread]: Command `dbt run` failed at 21:44:11.913846 after 1.25 seconds
[0m21:44:11.914514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11396a100>]}
[0m21:44:11.915166 [debug] [MainThread]: Flushing usage events
[0m21:44:12.467964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:22.287834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11061b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11061bb80>]}


============================== 21:46:22.293414 | 66ded8ca-269d-4403-8450-8ad4def57e6c ==============================
[0m21:46:22.293414 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:46:22.294194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:46:22.516178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ceb50>]}
[0m21:46:22.579199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11012c7c0>]}
[0m21:46:22.580596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:46:22.709866 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:46:22.840631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:22.841338 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:46:23.098603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:46:23.104731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b1130>]}
[0m21:46:23.183082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:46:23.187160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:46:23.209805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112bccd0>]}
[0m21:46:23.210516 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:46:23.211019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111494d60>]}
[0m21:46:23.212534 [info ] [MainThread]: 
[0m21:46:23.213046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:23.213475 [info ] [MainThread]: 
[0m21:46:23.214119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:23.215158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:46:23.329640 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:46:23.330300 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:46:23.330827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:23.386530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m21:46:23.388077 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:46:23.393468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:46:23.400832 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:46:23.401366 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:46:23.401782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:23.424282 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:46:23.424832 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:46:23.425294 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:46:23.431149 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:46:23.432755 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:46:23.433381 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:46:23.438994 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.439570 [debug] [MainThread]: On master: BEGIN
[0m21:46:23.440016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:23.461783 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:46:23.462482 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.463025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:46:23.468037 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:46:23.469420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114011c0>]}
[0m21:46:23.470005 [debug] [MainThread]: On master: ROLLBACK
[0m21:46:23.470590 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.471027 [debug] [MainThread]: On master: BEGIN
[0m21:46:23.471688 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:46:23.472157 [debug] [MainThread]: On master: COMMIT
[0m21:46:23.472602 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.473043 [debug] [MainThread]: On master: COMMIT
[0m21:46:23.473643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:46:23.474142 [debug] [MainThread]: On master: Close
[0m21:46:23.477507 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:46:23.478294 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:46:23.479090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:46:23.479651 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:46:23.489478 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:46:23.490469 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:46:23.534033 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:46:23.535012 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:46:23.535509 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:46:23.535975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:46:23.558228 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:46:23.558852 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:46:23.559464 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce("review rate number", 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce("calculated host listings count", 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce("availability 365", 0) as availability_365,  -- Replaced NULL with 0
        coalesce("is host verified", 'unconfirmed') as is_host_verified, -- No need to COALESCE again
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:46:23.560997 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 45:     from source
             ^

[0m21:46:23.561554 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:46:23.562323 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:46:23.570541 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "from"
  LINE 45:     from source
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:46:23.572953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ded8ca-269d-4403-8450-8ad4def57e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d3b20>]}
[0m21:46:23.573822 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:46:23.574653 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:46:23.575512 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "from"
  LINE 45:     from source
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:46:23.576948 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.577448 [debug] [MainThread]: On master: BEGIN
[0m21:46:23.577884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:23.601604 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:46:23.602170 [debug] [MainThread]: On master: COMMIT
[0m21:46:23.602629 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:23.603153 [debug] [MainThread]: On master: COMMIT
[0m21:46:23.603762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:46:23.604264 [debug] [MainThread]: On master: Close
[0m21:46:23.605121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:23.605668 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:46:23.606169 [info ] [MainThread]: 
[0m21:46:23.606660 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m21:46:23.607561 [debug] [MainThread]: Command end result
[0m21:46:23.632169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:46:23.634105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:46:23.642098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:46:23.642646 [info ] [MainThread]: 
[0m21:46:23.643177 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:23.643656 [info ] [MainThread]: 
[0m21:46:23.644198 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "from"
  LINE 45:     from source
               ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:46:23.644687 [info ] [MainThread]: 
[0m21:46:23.645257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:46:23.648483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4475334, "process_in_blocks": "0", "process_kernel_time": 0.398798, "process_mem_max_rss": "116506624", "process_out_blocks": "0", "process_user_time": 2.554695}
[0m21:46:23.649108 [debug] [MainThread]: Command `dbt run` failed at 21:46:23.648980 after 1.45 seconds
[0m21:46:23.649664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa39310>]}
[0m21:46:23.650197 [debug] [MainThread]: Flushing usage events
[0m21:46:24.407361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:41.146458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb91a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec5bb0>]}


============================== 21:46:41.150985 | ff67017c-10f2-47ac-9064-200ae9b996a0 ==============================
[0m21:46:41.150985 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:46:41.151714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:46:41.332360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd0a0d0>]}
[0m21:46:41.392382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e15a940>]}
[0m21:46:41.393410 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:46:41.505483 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:46:41.607136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:41.607776 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:46:41.846284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:46:41.851256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5c130>]}
[0m21:46:41.920130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:46:41.923271 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:46:41.935226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb66d60>]}
[0m21:46:41.935848 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:46:41.936275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1751f0>]}
[0m21:46:41.937624 [info ] [MainThread]: 
[0m21:46:41.938060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:41.938446 [info ] [MainThread]: 
[0m21:46:41.939024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:41.939955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:46:42.043963 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:46:42.044651 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:46:42.045186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:42.090377 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m21:46:42.091922 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:46:42.097346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:46:42.104341 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:46:42.104827 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:46:42.105253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:42.128095 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:46:42.128665 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:46:42.129153 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:46:42.133160 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:46:42.134647 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:46:42.135223 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:46:42.140484 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.140977 [debug] [MainThread]: On master: BEGIN
[0m21:46:42.141407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:42.163320 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:46:42.164016 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.164552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:46:42.169013 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:46:42.170305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf7c10>]}
[0m21:46:42.170886 [debug] [MainThread]: On master: ROLLBACK
[0m21:46:42.171482 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.171947 [debug] [MainThread]: On master: BEGIN
[0m21:46:42.172864 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:46:42.173817 [debug] [MainThread]: On master: COMMIT
[0m21:46:42.174275 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.175043 [debug] [MainThread]: On master: COMMIT
[0m21:46:42.175928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:46:42.176396 [debug] [MainThread]: On master: Close
[0m21:46:42.178570 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:46:42.179278 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:46:42.179948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:46:42.180482 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:46:42.190390 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:46:42.191394 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:46:42.232172 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:46:42.233109 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:46:42.233597 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:46:42.234061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:46:42.256739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:46:42.257358 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:46:42.257967 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce("review rate number", 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce("calculated host listings count", 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce("availability 365", 0) as availability_365,  -- Replaced NULL with 0
        coalesce("is host verified", 'unconfirmed') as is_host_verified -- No need to COALESCE again
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:46:42.259831 [debug] [Thread-1  ]: Postgres adapter: Postgres error: COALESCE types text and integer cannot be matched
LINE 41:         coalesce("review rate number", 0) as review_rate_num...
                                                ^

[0m21:46:42.260381 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:46:42.261159 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:46:42.263918 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 41:         coalesce("review rate number", 0) as review_rate_num...
                                                  ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:46:42.265897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff67017c-10f2-47ac-9064-200ae9b996a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de73e20>]}
[0m21:46:42.266721 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:46:42.267497 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:46:42.268224 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 41:         coalesce("review rate number", 0) as review_rate_num...
                                                  ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:46:42.269496 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.269942 [debug] [MainThread]: On master: BEGIN
[0m21:46:42.270362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:42.293933 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:46:42.294504 [debug] [MainThread]: On master: COMMIT
[0m21:46:42.294966 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:42.295403 [debug] [MainThread]: On master: COMMIT
[0m21:46:42.295932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:46:42.296382 [debug] [MainThread]: On master: Close
[0m21:46:42.296964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:42.297385 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:46:42.297831 [info ] [MainThread]: 
[0m21:46:42.298317 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:46:42.299202 [debug] [MainThread]: Command end result
[0m21:46:42.322357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:46:42.324137 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:46:42.331847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:46:42.332436 [info ] [MainThread]: 
[0m21:46:42.332974 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:42.333432 [info ] [MainThread]: 
[0m21:46:42.333975 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  COALESCE types text and integer cannot be matched
  LINE 41:         coalesce("review rate number", 0) as review_rate_num...
                                                  ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:46:42.334424 [info ] [MainThread]: 
[0m21:46:42.334885 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:46:42.337583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2647926, "process_in_blocks": "0", "process_kernel_time": 0.263868, "process_mem_max_rss": "117293056", "process_out_blocks": "0", "process_user_time": 2.31198}
[0m21:46:42.338152 [debug] [MainThread]: Command `dbt run` failed at 21:46:42.338029 after 1.27 seconds
[0m21:46:42.338681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb91a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee03d00>]}
[0m21:46:42.339197 [debug] [MainThread]: Flushing usage events
[0m21:46:42.901215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:47:28.568002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662eac0>]}


============================== 21:47:28.572565 | c92b4710-32ea-417d-80fc-b79ea4967a79 ==============================
[0m21:47:28.572565 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:47:28.573327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:47:28.756491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065de2b0>]}
[0m21:47:28.817622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e32e0>]}
[0m21:47:28.818533 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:47:28.931613 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:47:29.046022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:47:29.046690 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:47:29.296455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:47:29.301590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4130>]}
[0m21:47:29.371394 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:47:29.375001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:47:29.393359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107488a30>]}
[0m21:47:29.394007 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:47:29.394475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107488dc0>]}
[0m21:47:29.396037 [info ] [MainThread]: 
[0m21:47:29.396592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:47:29.397038 [info ] [MainThread]: 
[0m21:47:29.397687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:47:29.398692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:47:29.505865 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:47:29.506563 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:47:29.507098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:29.560504 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m21:47:29.562140 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:47:29.567700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:47:29.575059 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:47:29.575623 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:47:29.576089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:29.599170 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:47:29.599743 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:47:29.600213 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:47:29.604284 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:47:29.606123 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:47:29.606901 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:47:29.612966 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.613505 [debug] [MainThread]: On master: BEGIN
[0m21:47:29.613938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:47:29.636367 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:47:29.637055 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.637592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:47:29.641869 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:47:29.643180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746d4c0>]}
[0m21:47:29.643775 [debug] [MainThread]: On master: ROLLBACK
[0m21:47:29.644389 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.644827 [debug] [MainThread]: On master: BEGIN
[0m21:47:29.645539 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:47:29.645999 [debug] [MainThread]: On master: COMMIT
[0m21:47:29.646439 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.646859 [debug] [MainThread]: On master: COMMIT
[0m21:47:29.647396 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:47:29.647851 [debug] [MainThread]: On master: Close
[0m21:47:29.650553 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:47:29.651212 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:47:29.651892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:47:29.652399 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:47:29.661944 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:47:29.662830 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:47:29.705112 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:47:29.706059 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:47:29.706539 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:47:29.706997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:29.729406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:47:29.730021 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:47:29.730629 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce("is host verified", 'unconfirmed') as is_host_verified -- No need to COALESCE again
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:47:29.732353 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is host verified" does not exist
LINE 44:         coalesce("is host verified", 'unconfirmed') as is_ho...
                          ^

[0m21:47:29.732905 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:47:29.733652 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:47:29.738932 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is host verified" does not exist
  LINE 44:         coalesce("is host verified", 'unconfirmed') as is_ho...
                            ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:47:29.741034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92b4710-32ea-417d-80fc-b79ea4967a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051db490>]}
[0m21:47:29.741849 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:47:29.742610 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:47:29.743312 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is host verified" does not exist
  LINE 44:         coalesce("is host verified", 'unconfirmed') as is_ho...
                            ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:47:29.744697 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.745143 [debug] [MainThread]: On master: BEGIN
[0m21:47:29.745561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:47:29.768636 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:47:29.769269 [debug] [MainThread]: On master: COMMIT
[0m21:47:29.769753 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:29.770187 [debug] [MainThread]: On master: COMMIT
[0m21:47:29.770732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:47:29.771188 [debug] [MainThread]: On master: Close
[0m21:47:29.771796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:29.772237 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:47:29.772740 [info ] [MainThread]: 
[0m21:47:29.773268 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:47:29.774277 [debug] [MainThread]: Command end result
[0m21:47:29.797646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:47:29.799342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:47:29.806941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:47:29.807394 [info ] [MainThread]: 
[0m21:47:29.807956 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:47:29.808441 [info ] [MainThread]: 
[0m21:47:29.808967 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is host verified" does not exist
  LINE 44:         coalesce("is host verified", 'unconfirmed') as is_ho...
                            ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:47:29.809429 [info ] [MainThread]: 
[0m21:47:29.809908 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:47:29.813153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3201585, "process_in_blocks": "0", "process_kernel_time": 0.269533, "process_mem_max_rss": "117395456", "process_out_blocks": "0", "process_user_time": 2.33439}
[0m21:47:29.813766 [debug] [MainThread]: Command `dbt run` failed at 21:47:29.813638 after 1.32 seconds
[0m21:47:29.814322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a76430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e5fd0>]}
[0m21:47:29.814883 [debug] [MainThread]: Flushing usage events
[0m21:47:30.360397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:24.620947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f33af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109267d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109267430>]}


============================== 21:48:24.625634 | a5b2c224-2f40-4121-b325-3b20a257c233 ==============================
[0m21:48:24.625634 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:48:24.626397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:48:24.809726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9ff40>]}
[0m21:48:24.871538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c2e80>]}
[0m21:48:24.872474 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:48:24.986204 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:48:25.093699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:48:25.094385 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:48:25.337273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:48:25.342394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a101130>]}
[0m21:48:25.412114 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:48:25.415201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:48:25.427106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079499a0>]}
[0m21:48:25.427729 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:48:25.428299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02abe0>]}
[0m21:48:25.429694 [info ] [MainThread]: 
[0m21:48:25.430190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:25.430578 [info ] [MainThread]: 
[0m21:48:25.431211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:25.432166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:48:25.534599 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:48:25.535284 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:48:25.535826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:25.579560 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m21:48:25.581154 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:48:25.586478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:48:25.593675 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:48:25.594169 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:48:25.594649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:25.616881 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:48:25.617438 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:48:25.617914 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:48:25.621867 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:48:25.623373 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:48:25.623966 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:48:25.629394 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.629925 [debug] [MainThread]: On master: BEGIN
[0m21:48:25.630365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:25.652777 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:48:25.653476 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.654021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:48:25.658388 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:48:25.659727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a66a0>]}
[0m21:48:25.660306 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:25.660903 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.661357 [debug] [MainThread]: On master: BEGIN
[0m21:48:25.662047 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:48:25.662500 [debug] [MainThread]: On master: COMMIT
[0m21:48:25.662968 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.663396 [debug] [MainThread]: On master: COMMIT
[0m21:48:25.663933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:48:25.664404 [debug] [MainThread]: On master: Close
[0m21:48:25.666522 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:48:25.667188 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:48:25.667778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:48:25.668279 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:48:25.677689 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:48:25.678617 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:48:25.719907 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:48:25.720867 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:48:25.721362 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:48:25.721836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:25.743229 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m21:48:25.743825 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:48:25.744430 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce(host_identity_verified, 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and neighborhood_group is not null
        and neighborhood is not null
        and room_type is not null
        and host_name is not null
        and construction_year is not null
        and host_id is not null
        and latitude is not null
        and longitude is not null
)

select * from cleaned
  );
[0m21:48:25.746148 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "neighborhood_group" does not exist
LINE 49:         and neighborhood_group is not null
                     ^
HINT:  Perhaps you meant to reference the column "source.neighbourhood group".

[0m21:48:25.746679 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:48:25.747432 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:48:25.750038 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood_group" does not exist
  LINE 49:         and neighborhood_group is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood group".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:48:25.752131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b2c224-2f40-4121-b325-3b20a257c233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d136a0>]}
[0m21:48:25.752913 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:48:25.753674 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:48:25.754373 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood_group" does not exist
  LINE 49:         and neighborhood_group is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood group".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:48:25.755751 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.756201 [debug] [MainThread]: On master: BEGIN
[0m21:48:25.756695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:25.779754 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:48:25.780334 [debug] [MainThread]: On master: COMMIT
[0m21:48:25.780810 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:25.781279 [debug] [MainThread]: On master: COMMIT
[0m21:48:25.781874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:48:25.782389 [debug] [MainThread]: On master: Close
[0m21:48:25.783002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:25.783437 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:48:25.783932 [info ] [MainThread]: 
[0m21:48:25.784511 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:48:25.785522 [debug] [MainThread]: Command end result
[0m21:48:25.809102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:48:25.810796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:48:25.818781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:48:25.819321 [info ] [MainThread]: 
[0m21:48:25.819892 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:48:25.820427 [info ] [MainThread]: 
[0m21:48:25.821047 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood_group" does not exist
  LINE 49:         and neighborhood_group is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood group".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:48:25.821534 [info ] [MainThread]: 
[0m21:48:25.822123 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:48:25.825021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.285546, "process_in_blocks": "0", "process_kernel_time": 0.273927, "process_mem_max_rss": "118157312", "process_out_blocks": "0", "process_user_time": 2.402346}
[0m21:48:25.825676 [debug] [MainThread]: Command `dbt run` failed at 21:48:25.825550 after 1.29 seconds
[0m21:48:25.826244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f33af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079499a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0df460>]}
[0m21:48:25.826775 [debug] [MainThread]: Flushing usage events
[0m21:48:26.455563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:47.883506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125beaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138ecd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138ec430>]}


============================== 21:51:47.889183 | 2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac ==============================
[0m21:51:47.889183 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:51:47.889956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:51:48.110537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142af40>]}
[0m21:51:48.172516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b4de80>]}
[0m21:51:48.174296 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:51:48.296839 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:51:48.423100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:51:48.423825 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:51:48.669376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:51:48.675087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11478c130>]}
[0m21:51:48.749036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:51:48.752512 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:51:48.781746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd39a0>]}
[0m21:51:48.782481 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:51:48.783016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146b5be0>]}
[0m21:51:48.784622 [info ] [MainThread]: 
[0m21:51:48.785164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:48.785632 [info ] [MainThread]: 
[0m21:51:48.786312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:48.787402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:51:48.906415 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:51:48.907134 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:51:48.907715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:48.974071 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m21:51:48.975736 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:51:48.981307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:51:48.988552 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:51:48.989057 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:51:48.989483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:49.014209 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m21:51:49.014848 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:51:49.015364 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:51:49.021928 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m21:51:49.023530 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:51:49.024222 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:51:49.029811 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.030353 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.030790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:49.053252 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:51:49.053940 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.054474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:49.059905 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:51:49.061333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114733c10>]}
[0m21:51:49.061936 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:49.062552 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.063009 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.063785 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:51:49.064244 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.064691 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.065120 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.065658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:49.066109 [debug] [MainThread]: On master: Close
[0m21:51:49.068867 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:51:49.069561 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:51:49.070173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:51:49.070699 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:51:49.080954 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:51:49.082454 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:51:49.124240 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:51:49.125278 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:51:49.125824 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:51:49.126366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:51:49.148489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:51:49.149111 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:51:49.149746 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce(host_identity_verified, 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighborhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:51:49.152140 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "neighborhood" does not exist
LINE 50:         and neighborhood is not null
                     ^
HINT:  Perhaps you meant to reference the column "source.neighbourhood".

[0m21:51:49.152812 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:51:49.153656 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:51:49.163414 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood" does not exist
  LINE 50:         and neighborhood is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:51:49.165592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2b17ff-82a4-4a3a-a7be-d72bc001f8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11339e6a0>]}
[0m21:51:49.166387 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:51:49.167151 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:51:49.167857 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood" does not exist
  LINE 50:         and neighborhood is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:51:49.169151 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.169596 [debug] [MainThread]: On master: BEGIN
[0m21:51:49.170009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:49.194249 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:51:49.194815 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.195272 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:49.195700 [debug] [MainThread]: On master: COMMIT
[0m21:51:49.196242 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:49.196737 [debug] [MainThread]: On master: Close
[0m21:51:49.197332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:49.197771 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:51:49.198335 [info ] [MainThread]: 
[0m21:51:49.198838 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:51:49.199726 [debug] [MainThread]: Command end result
[0m21:51:49.222492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:51:49.224265 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:51:49.232085 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:51:49.232614 [info ] [MainThread]: 
[0m21:51:49.233163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:51:49.233671 [info ] [MainThread]: 
[0m21:51:49.234363 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "neighborhood" does not exist
  LINE 50:         and neighborhood is not null
                       ^
  HINT:  Perhaps you meant to reference the column "source.neighbourhood".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:51:49.234868 [info ] [MainThread]: 
[0m21:51:49.235355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:51:49.238717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4488927, "process_in_blocks": "0", "process_kernel_time": 0.386307, "process_mem_max_rss": "117383168", "process_out_blocks": "0", "process_user_time": 2.501077}
[0m21:51:49.239295 [debug] [MainThread]: Command `dbt run` failed at 21:51:49.239173 after 1.45 seconds
[0m21:51:49.239828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125beaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11476a460>]}
[0m21:51:49.240360 [debug] [MainThread]: Flushing usage events
[0m21:51:49.877881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:04.211102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ddac0>]}


============================== 21:52:04.216915 | 3cd0ca8f-8526-4b04-93f8-e5a224767250 ==============================
[0m21:52:04.216915 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:52:04.217685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:04.500745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188d2b0>]}
[0m21:52:04.570106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c922e0>]}
[0m21:52:04.571511 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:52:04.696638 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:52:04.820697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:52:04.821440 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:52:05.069438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:52:05.074646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112773130>]}
[0m21:52:05.144846 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:52:05.148958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:52:05.174423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112736a30>]}
[0m21:52:05.175134 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:52:05.175641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112736dc0>]}
[0m21:52:05.177253 [info ] [MainThread]: 
[0m21:52:05.177793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:05.178326 [info ] [MainThread]: 
[0m21:52:05.179092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:05.180161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:52:05.286512 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:52:05.287205 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:52:05.287748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:05.339775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m21:52:05.341465 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:52:05.346815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:52:05.353829 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:52:05.354307 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:52:05.354742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:52:05.377058 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:52:05.377600 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:52:05.378065 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:52:05.381962 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:52:05.383407 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:52:05.383961 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:52:05.389238 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.389723 [debug] [MainThread]: On master: BEGIN
[0m21:52:05.390143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:05.412193 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:52:05.412869 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.413401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:52:05.417601 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:52:05.418898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127234c0>]}
[0m21:52:05.419489 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:05.420056 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.420495 [debug] [MainThread]: On master: BEGIN
[0m21:52:05.421143 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:52:05.421585 [debug] [MainThread]: On master: COMMIT
[0m21:52:05.422045 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.422472 [debug] [MainThread]: On master: COMMIT
[0m21:52:05.423180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:52:05.423664 [debug] [MainThread]: On master: Close
[0m21:52:05.426516 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:52:05.427240 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:52:05.427868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:52:05.428388 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:52:05.437934 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:52:05.438910 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:52:05.480253 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:52:05.481216 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:52:05.481857 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:52:05.482335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:05.504112 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:52:05.504716 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:52:05.505319 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast(host_identity_verified as varchar(25)) as is_host_verified, -- Renamed
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce(host_identity_verified, 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:52:05.508646 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_host_verified" specified more than once

[0m21:52:05.509311 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:52:05.510098 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:52:05.515774 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_host_verified" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:52:05.517822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd0ca8f-8526-4b04-93f8-e5a224767250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11048a490>]}
[0m21:52:05.518625 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:52:05.519383 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:52:05.520095 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_host_verified" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:52:05.521369 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.521814 [debug] [MainThread]: On master: BEGIN
[0m21:52:05.522247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:05.545609 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:52:05.546175 [debug] [MainThread]: On master: COMMIT
[0m21:52:05.546637 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:05.547074 [debug] [MainThread]: On master: COMMIT
[0m21:52:05.547635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:52:05.548136 [debug] [MainThread]: On master: Close
[0m21:52:05.548736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:05.549168 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:52:05.549640 [info ] [MainThread]: 
[0m21:52:05.550227 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:52:05.551124 [debug] [MainThread]: Command end result
[0m21:52:05.575430 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:52:05.577208 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:52:05.584959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:52:05.585451 [info ] [MainThread]: 
[0m21:52:05.585995 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:52:05.586480 [info ] [MainThread]: 
[0m21:52:05.587026 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_host_verified" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:52:05.587503 [info ] [MainThread]: 
[0m21:52:05.587986 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:52:05.591865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4630612, "process_in_blocks": "0", "process_kernel_time": 0.282937, "process_mem_max_rss": "117080064", "process_out_blocks": "0", "process_user_time": 2.396136}
[0m21:52:05.592476 [debug] [MainThread]: Command `dbt run` failed at 21:52:05.592347 after 1.46 seconds
[0m21:52:05.593037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112804700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270f670>]}
[0m21:52:05.593583 [debug] [MainThread]: Flushing usage events
[0m21:52:06.146661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:36.471671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105873d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105873430>]}


============================== 21:53:36.476239 | 2ae150ad-2822-40c3-9532-b52aea21f03e ==============================
[0m21:53:36.476239 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:53:36.476984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:53:36.656613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033b7f40>]}
[0m21:53:36.716225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adbe80>]}
[0m21:53:36.717137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:53:36.831714 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:53:36.934720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:36.935424 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:53:37.175289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:53:37.180513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671a130>]}
[0m21:53:37.249589 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:53:37.252661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:53:37.263921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f619a0>]}
[0m21:53:37.264481 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:53:37.265045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106643be0>]}
[0m21:53:37.266433 [info ] [MainThread]: 
[0m21:53:37.266871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:53:37.267285 [info ] [MainThread]: 
[0m21:53:37.267888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:53:37.268784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:53:37.371785 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:53:37.372475 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:53:37.373012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:37.417227 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m21:53:37.418774 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:53:37.424079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:53:37.430976 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:53:37.431511 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:53:37.432035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:37.454020 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:53:37.454563 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:53:37.455120 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:53:37.458974 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:53:37.460382 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:53:37.460928 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:53:37.466053 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.466509 [debug] [MainThread]: On master: BEGIN
[0m21:53:37.466917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:37.489300 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:53:37.489960 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.490476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:53:37.494683 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:53:37.495951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c2c10>]}
[0m21:53:37.496524 [debug] [MainThread]: On master: ROLLBACK
[0m21:53:37.497082 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.497513 [debug] [MainThread]: On master: BEGIN
[0m21:53:37.498123 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:53:37.498555 [debug] [MainThread]: On master: COMMIT
[0m21:53:37.498988 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.499415 [debug] [MainThread]: On master: COMMIT
[0m21:53:37.499942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:53:37.500385 [debug] [MainThread]: On master: Close
[0m21:53:37.502573 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:53:37.503259 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:53:37.503863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:53:37.504364 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:53:37.513675 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:53:37.514544 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:53:37.556395 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:53:37.557338 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:53:37.557845 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:53:37.558311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:37.580284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:53:37.580899 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:53:37.581508 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude,
        cast(instant_bookable as boolean) as is_instant_bookable, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("minimum nights" as integer) as minimum_nights,
        cast("number of reviews" as integer) as review_count, -- Renamed
        cast("review rate number" as numeric(3,1)) as review_rating,
        cast("calculated host listings count" as integer) as host_listings_count,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce("number of reviews", 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:53:37.583333 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_instant_bookable" specified more than once

[0m21:53:37.583856 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:53:37.584637 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:53:37.587202 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:53:37.589103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ae150ad-2822-40c3-9532-b52aea21f03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532b6a0>]}
[0m21:53:37.589882 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m21:53:37.590625 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:53:37.591309 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:53:37.592566 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.593015 [debug] [MainThread]: On master: BEGIN
[0m21:53:37.593435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:37.616978 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:53:37.617603 [debug] [MainThread]: On master: COMMIT
[0m21:53:37.618155 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:37.618664 [debug] [MainThread]: On master: COMMIT
[0m21:53:37.619242 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:53:37.619706 [debug] [MainThread]: On master: Close
[0m21:53:37.620324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:37.620761 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:53:37.621248 [info ] [MainThread]: 
[0m21:53:37.621752 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:53:37.622636 [debug] [MainThread]: Command end result
[0m21:53:37.646176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:53:37.647873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:53:37.656077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:53:37.656565 [info ] [MainThread]: 
[0m21:53:37.657091 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:53:37.657632 [info ] [MainThread]: 
[0m21:53:37.658179 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "is_instant_bookable" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:53:37.658660 [info ] [MainThread]: 
[0m21:53:37.659140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:53:37.661897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2613034, "process_in_blocks": "0", "process_kernel_time": 0.262851, "process_mem_max_rss": "117223424", "process_out_blocks": "0", "process_user_time": 2.305167}
[0m21:53:37.662473 [debug] [MainThread]: Command `dbt run` failed at 21:53:37.662353 after 1.26 seconds
[0m21:53:37.662988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f619a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f8460>]}
[0m21:53:37.663525 [debug] [MainThread]: Flushing usage events
[0m21:53:38.331150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:35.833074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0fd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0fdb80>]}


============================== 21:55:35.839094 | 612441fa-bcaf-45bd-80df-0e6403e9d839 ==============================
[0m21:55:35.839094 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:55:35.839824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:55:36.027665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b2b50>]}
[0m21:55:36.089523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0cc10>]}
[0m21:55:36.090838 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:55:36.213915 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:55:36.343400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:36.344103 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:55:36.587734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:55:36.592701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df94130>]}
[0m21:55:36.661791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:55:36.666634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:55:36.693269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9ecd0>]}
[0m21:55:36.693934 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:55:36.694428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df75d60>]}
[0m21:55:36.695874 [info ] [MainThread]: 
[0m21:55:36.696369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:36.696807 [info ] [MainThread]: 
[0m21:55:36.697457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:36.698463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:55:36.807458 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:55:36.808194 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:55:36.808746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:36.867667 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.059 seconds
[0m21:55:36.869280 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:55:36.874775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:55:36.882134 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:55:36.882712 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:55:36.883138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.905609 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:55:36.906167 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:55:36.906644 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:55:36.910470 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m21:55:36.911891 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:55:36.912443 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:55:36.917554 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.918009 [debug] [MainThread]: On master: BEGIN
[0m21:55:36.918423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:36.940326 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:55:36.940990 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.941508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:36.945562 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:55:36.946946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e032310>]}
[0m21:55:36.947536 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:36.948119 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.948557 [debug] [MainThread]: On master: BEGIN
[0m21:55:36.949213 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:55:36.949665 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.950107 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.950542 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.951090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:36.951545 [debug] [MainThread]: On master: Close
[0m21:55:36.954272 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:55:36.954942 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:55:36.955539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:55:36.956039 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:55:36.965281 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:55:36.966135 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:55:37.007973 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:55:37.008862 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:55:37.009345 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:55:37.009808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:37.033056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m21:55:37.033758 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:55:37.034387 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else cast("availability 365" as integer)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("availability 365" as integer), 0) as availability_365,  -- Replaced NULL with 0
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:55:37.036185 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "availability_365" specified more than once

[0m21:55:37.036763 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m21:55:37.037562 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:55:37.047221 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability_365" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:55:37.049520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612441fa-bcaf-45bd-80df-0e6403e9d839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b5b20>]}
[0m21:55:37.050331 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m21:55:37.051175 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:55:37.051902 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability_365" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m21:55:37.053227 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.053691 [debug] [MainThread]: On master: BEGIN
[0m21:55:37.054107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:37.077832 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:55:37.078411 [debug] [MainThread]: On master: COMMIT
[0m21:55:37.078876 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.079317 [debug] [MainThread]: On master: COMMIT
[0m21:55:37.079856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:37.080314 [debug] [MainThread]: On master: Close
[0m21:55:37.080907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:37.081334 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:55:37.082008 [info ] [MainThread]: 
[0m21:55:37.082701 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:55:37.084028 [debug] [MainThread]: Command end result
[0m21:55:37.109644 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:55:37.111465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:55:37.120561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:55:37.121092 [info ] [MainThread]: 
[0m21:55:37.121661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:55:37.122140 [info ] [MainThread]: 
[0m21:55:37.122678 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability_365" specified more than once
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m21:55:37.123127 [info ] [MainThread]: 
[0m21:55:37.123608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:55:37.127171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3716896, "process_in_blocks": "0", "process_kernel_time": 0.253483, "process_mem_max_rss": "117223424", "process_out_blocks": "0", "process_user_time": 2.335019}
[0m21:55:37.127913 [debug] [MainThread]: Command `dbt run` failed at 21:55:37.127776 after 1.37 seconds
[0m21:55:37.128499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd94130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d143b80>]}
[0m21:55:37.129072 [debug] [MainThread]: Flushing usage events
[0m21:55:37.736425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:36.204346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fadd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faddb80>]}


============================== 21:56:36.210864 | 8719291c-b866-462e-b423-6420483a23fc ==============================
[0m21:56:36.210864 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:56:36.211765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:36.424332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd722b0>]}
[0m21:56:36.486568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa9dfa0>]}
[0m21:56:36.487900 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:36.617054 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:56:36.754178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:36.754967 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:56:36.999697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:56:37.005796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110974130>]}
[0m21:56:37.076831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:56:37.080613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:56:37.103802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e17ad30>]}
[0m21:56:37.104488 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:56:37.104983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110953ca0>]}
[0m21:56:37.106450 [info ] [MainThread]: 
[0m21:56:37.106949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:37.107376 [info ] [MainThread]: 
[0m21:56:37.108019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:37.109010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:56:37.220067 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:56:37.220777 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:56:37.221327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:37.286484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.065 seconds
[0m21:56:37.288093 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:56:37.293497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:56:37.300687 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:56:37.301180 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:56:37.301622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:37.324627 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:56:37.325182 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:56:37.325660 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:56:37.331228 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:56:37.332733 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:56:37.333305 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:56:37.338529 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.339041 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.339455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:37.361031 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m21:56:37.361694 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.362223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:37.367474 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:56:37.368837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e6fa0>]}
[0m21:56:37.369414 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:37.370003 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.370436 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.371068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:56:37.371531 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.371974 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.372410 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.373037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:37.373917 [debug] [MainThread]: On master: Close
[0m21:56:37.376729 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:56:37.377438 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:56:37.378047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:56:37.378548 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:56:37.388210 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:56:37.389588 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:56:37.430519 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:56:37.431465 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:56:37.432060 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:56:37.432532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:56:37.454343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m21:56:37.454944 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:56:37.455541 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as integer) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else coalesce(cast("availability 365" as integer), 0)
        end as availability_365,
        
        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:56:37.473483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.017 seconds
[0m21:56:37.481009 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:56:37.481698 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m21:56:37.483320 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:56:37.499946 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:56:37.500558 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:56:37.501054 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:56:37.502867 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:56:37.510508 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m21:56:37.515545 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:56:37.516104 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m21:56:37.517565 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m21:56:37.520633 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:56:37.522872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8719291c-b866-462e-b423-6420483a23fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa957c0>]}
[0m21:56:37.523725 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:56:37.524500 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:56:37.525743 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.526199 [debug] [MainThread]: On master: BEGIN
[0m21:56:37.526621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:37.549704 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m21:56:37.550295 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.550841 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:37.551317 [debug] [MainThread]: On master: COMMIT
[0m21:56:37.551922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:56:37.552490 [debug] [MainThread]: On master: Close
[0m21:56:37.553097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:37.553522 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:56:37.553980 [info ] [MainThread]: 
[0m21:56:37.554539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:56:37.555496 [debug] [MainThread]: Command end result
[0m21:56:37.579814 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:56:37.581563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:56:37.589935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:56:37.590439 [info ] [MainThread]: 
[0m21:56:37.590993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:37.591468 [info ] [MainThread]: 
[0m21:56:37.591947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:56:37.595839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4737623, "process_in_blocks": "0", "process_kernel_time": 0.372265, "process_mem_max_rss": "117821440", "process_out_blocks": "0", "process_user_time": 2.557149}
[0m21:56:37.596442 [debug] [MainThread]: Command `dbt run` succeeded at 21:56:37.596317 after 1.47 seconds
[0m21:56:37.596988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110767f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110767c10>]}
[0m21:56:37.597518 [debug] [MainThread]: Flushing usage events
[0m21:56:38.169765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:51.143267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091dc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091dcb80>]}


============================== 22:23:51.150121 | af0bd146-6e02-41e6-a86f-1107ff530e37 ==============================
[0m22:23:51.150121 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:23:51.151002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m22:23:51.379523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109591b50>]}
[0m22:23:51.438905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ced7c0>]}
[0m22:23:51.440448 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:23:51.570860 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:23:51.712039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:23:51.712701 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m22:23:51.950676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m22:23:51.956438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a073130>]}
[0m22:23:52.030799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:23:52.034431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:23:52.066945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e7dcd0>]}
[0m22:23:52.067711 [info ] [MainThread]: Found 2 models, 433 macros
[0m22:23:52.068285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a053d60>]}
[0m22:23:52.069949 [info ] [MainThread]: 
[0m22:23:52.070544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:52.071038 [info ] [MainThread]: 
[0m22:23:52.071756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:52.072869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m22:23:52.194452 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m22:23:52.195196 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m22:23:52.195789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:52.264780 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m22:23:52.266542 [debug] [ThreadPool]: On list_elt_project: Close
[0m22:23:52.272262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m22:23:52.279466 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:23:52.279961 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m22:23:52.280405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:52.303018 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m22:23:52.303570 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:23:52.304037 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:23:52.310599 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m22:23:52.312202 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m22:23:52.312801 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m22:23:52.318319 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.318795 [debug] [MainThread]: On master: BEGIN
[0m22:23:52.319321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:52.341477 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m22:23:52.342039 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.342573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:23:52.349180 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m22:23:52.350948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc31c0>]}
[0m22:23:52.351527 [debug] [MainThread]: On master: ROLLBACK
[0m22:23:52.352156 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.352605 [debug] [MainThread]: On master: BEGIN
[0m22:23:52.353289 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:23:52.353751 [debug] [MainThread]: On master: COMMIT
[0m22:23:52.354199 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.354629 [debug] [MainThread]: On master: COMMIT
[0m22:23:52.355175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:52.355628 [debug] [MainThread]: On master: Close
[0m22:23:52.358370 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m22:23:52.359056 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m22:23:52.359670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m22:23:52.360193 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m22:23:52.370044 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m22:23:52.371384 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m22:23:52.413179 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m22:23:52.414227 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.414762 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m22:23:52.415242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:23:52.437287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m22:23:52.437895 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.438498 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast("Construction year" as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else coalesce(cast("availability 365" as integer), 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m22:23:52.444483 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:23:52.451920 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.452445 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m22:23:52.453499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:52.456897 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.457393 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m22:23:52.458346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:23:52.476787 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:23:52.477417 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.477911 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:23:52.478962 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:23:52.486085 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m22:23:52.491055 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:23:52.491566 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m22:23:52.493994 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m22:23:52.497030 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m22:23:52.499244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0bd146-6e02-41e6-a86f-1107ff530e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109194040>]}
[0m22:23:52.500046 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:23:52.500801 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m22:23:52.502037 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.502478 [debug] [MainThread]: On master: BEGIN
[0m22:23:52.502892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:52.525804 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m22:23:52.526382 [debug] [MainThread]: On master: COMMIT
[0m22:23:52.526845 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:52.527280 [debug] [MainThread]: On master: COMMIT
[0m22:23:52.527794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:52.528248 [debug] [MainThread]: On master: Close
[0m22:23:52.528828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:52.529251 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m22:23:52.529702 [info ] [MainThread]: 
[0m22:23:52.530254 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m22:23:52.531190 [debug] [MainThread]: Command end result
[0m22:23:52.557400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:23:52.559356 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:23:52.566667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m22:23:52.567137 [info ] [MainThread]: 
[0m22:23:52.567703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:52.568366 [info ] [MainThread]: 
[0m22:23:52.568937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:23:52.573205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5223894, "process_in_blocks": "0", "process_kernel_time": 0.410866, "process_mem_max_rss": "117256192", "process_out_blocks": "0", "process_user_time": 2.530192}
[0m22:23:52.573813 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:52.573686 after 1.52 seconds
[0m22:23:52.574363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ced7c0>]}
[0m22:23:52.574969 [debug] [MainThread]: Flushing usage events
[0m22:23:53.253878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:25:15.955392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c281a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b5bb0>]}


============================== 22:25:15.961716 | 6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a ==============================
[0m22:25:15.961716 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:25:15.962597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:25:16.178971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ecf10>]}
[0m22:25:16.249466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a2c70>]}
[0m22:25:16.251190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:25:16.390612 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:25:16.536236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:25:16.536916 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m22:25:16.807600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m22:25:16.812896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44a130>]}
[0m22:25:16.889334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:25:16.893297 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:25:16.916655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc65310>]}
[0m22:25:16.917385 [info ] [MainThread]: Found 2 models, 433 macros
[0m22:25:16.917938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc71160>]}
[0m22:25:16.919468 [info ] [MainThread]: 
[0m22:25:16.920030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:25:16.920477 [info ] [MainThread]: 
[0m22:25:16.921149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:25:16.922185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m22:25:17.051470 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m22:25:17.052446 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m22:25:17.052997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:17.120225 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m22:25:17.121792 [debug] [ThreadPool]: On list_elt_project: Close
[0m22:25:17.127073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m22:25:17.134263 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:25:17.134760 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m22:25:17.135195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:17.159159 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m22:25:17.159728 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:25:17.160200 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:25:17.165778 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:25:17.167300 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m22:25:17.167891 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m22:25:17.173327 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.173805 [debug] [MainThread]: On master: BEGIN
[0m22:25:17.174334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:17.197156 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m22:25:17.197715 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.198250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:25:17.204301 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m22:25:17.206055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3fdd30>]}
[0m22:25:17.206636 [debug] [MainThread]: On master: ROLLBACK
[0m22:25:17.207225 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.207693 [debug] [MainThread]: On master: BEGIN
[0m22:25:17.208483 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:25:17.208954 [debug] [MainThread]: On master: COMMIT
[0m22:25:17.209409 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.209866 [debug] [MainThread]: On master: COMMIT
[0m22:25:17.210461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:25:17.210949 [debug] [MainThread]: On master: Close
[0m22:25:17.213828 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m22:25:17.214529 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m22:25:17.215150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m22:25:17.215694 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m22:25:17.225414 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m22:25:17.226685 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m22:25:17.268622 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m22:25:17.269625 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.270136 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m22:25:17.270618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:25:17.293843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m22:25:17.294488 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.295094 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365" as integer) < 0 then 0
            when cast("availability 365" as integer) > 365 then 365
            else coalesce(cast("availability 365" as integer), 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m22:25:17.302300 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:25:17.310049 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.310660 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m22:25:17.311763 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:25:17.315579 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.316155 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m22:25:17.317176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:25:17.336329 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:25:17.337081 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.337799 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:25:17.339554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:25:17.347449 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m22:25:17.353085 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:25:17.353786 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m22:25:17.356220 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m22:25:17.359293 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m22:25:17.361683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6daea3d1-a2d7-4c61-8ccc-6a2f63020b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d565f40>]}
[0m22:25:17.362684 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:25:17.363536 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m22:25:17.364882 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.365372 [debug] [MainThread]: On master: BEGIN
[0m22:25:17.365817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:17.394363 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m22:25:17.395032 [debug] [MainThread]: On master: COMMIT
[0m22:25:17.395567 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:17.396068 [debug] [MainThread]: On master: COMMIT
[0m22:25:17.396704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:25:17.397221 [debug] [MainThread]: On master: Close
[0m22:25:17.397879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:17.398338 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m22:25:17.398830 [info ] [MainThread]: 
[0m22:25:17.399361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m22:25:17.400319 [debug] [MainThread]: Command end result
[0m22:25:17.429782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:25:17.431688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:25:17.439592 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m22:25:17.440103 [info ] [MainThread]: 
[0m22:25:17.440678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:25:17.441304 [info ] [MainThread]: 
[0m22:25:17.441840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:25:17.446035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5852305, "process_in_blocks": "0", "process_kernel_time": 0.416638, "process_mem_max_rss": "117059584", "process_out_blocks": "0", "process_user_time": 2.675935}
[0m22:25:17.446716 [debug] [MainThread]: Command `dbt run` succeeded at 22:25:17.446581 after 1.59 seconds
[0m22:25:17.447270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c281a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c179610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55ad90>]}
[0m22:25:17.447818 [debug] [MainThread]: Flushing usage events
[0m22:25:18.056971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:40.396179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104478a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ad280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057adb80>]}


============================== 22:52:40.402891 | c096352e-7a1a-4bd5-b9f9-7501db8c8e53 ==============================
[0m22:52:40.402891 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:52:40.403866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:40.626795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b62b50>]}
[0m22:52:40.689753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bcc10>]}
[0m22:52:40.691402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:52:40.821409 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:52:40.960479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:40.961169 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m22:52:41.223126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m22:52:41.228871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106644130>]}
[0m22:52:41.303702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:52:41.307729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:52:41.340765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644ecd0>]}
[0m22:52:41.341632 [info ] [MainThread]: Found 2 models, 433 macros
[0m22:52:41.342220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106625d60>]}
[0m22:52:41.343937 [info ] [MainThread]: 
[0m22:52:41.344522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:41.345022 [info ] [MainThread]: 
[0m22:52:41.345774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:52:41.346919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m22:52:41.467341 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m22:52:41.468098 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m22:52:41.468685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:41.599212 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.130 seconds
[0m22:52:41.600978 [debug] [ThreadPool]: On list_elt_project: Close
[0m22:52:41.606627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m22:52:41.613772 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:52:41.614268 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m22:52:41.614720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:41.638607 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m22:52:41.639234 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m22:52:41.639704 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:52:41.647439 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m22:52:41.649056 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m22:52:41.649651 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m22:52:41.655237 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.655712 [debug] [MainThread]: On master: BEGIN
[0m22:52:41.656233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:41.678609 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m22:52:41.679178 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.679725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:52:41.685986 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m22:52:41.687736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065931c0>]}
[0m22:52:41.688314 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:41.688902 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.689345 [debug] [MainThread]: On master: BEGIN
[0m22:52:41.690039 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:52:41.690500 [debug] [MainThread]: On master: COMMIT
[0m22:52:41.690952 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.691383 [debug] [MainThread]: On master: COMMIT
[0m22:52:41.691952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:52:41.692419 [debug] [MainThread]: On master: Close
[0m22:52:41.695204 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m22:52:41.695901 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m22:52:41.696529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m22:52:41.697063 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m22:52:41.706768 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m22:52:41.708356 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m22:52:41.749384 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m22:52:41.750331 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.750830 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m22:52:41.751305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:52:41.773524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m22:52:41.774132 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.774739 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast(cast("availability 365" as numeric) as integer ) < 0 then 0
            when cast(cast("availability 365" as numeric) as integer )  > 365 then 365
            else coalesce(cast(cast("availability 365" as numeric) as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m22:52:41.782655 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:52:41.790205 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.790736 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m22:52:41.791829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:52:41.795383 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.795904 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m22:52:41.796904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:52:41.814725 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:52:41.815260 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.815747 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m22:52:41.817273 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:52:41.824558 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m22:52:41.829641 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m22:52:41.830180 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m22:52:41.832745 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m22:52:41.835798 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m22:52:41.838102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c096352e-7a1a-4bd5-b9f9-7501db8c8e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105766310>]}
[0m22:52:41.838898 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:52:41.839650 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m22:52:41.840849 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.841290 [debug] [MainThread]: On master: BEGIN
[0m22:52:41.841710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:41.864929 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m22:52:41.865518 [debug] [MainThread]: On master: COMMIT
[0m22:52:41.865981 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:41.866459 [debug] [MainThread]: On master: COMMIT
[0m22:52:41.867067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:52:41.867532 [debug] [MainThread]: On master: Close
[0m22:52:41.868112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:41.868536 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m22:52:41.868989 [info ] [MainThread]: 
[0m22:52:41.869478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:52:41.870343 [debug] [MainThread]: Command end result
[0m22:52:41.894839 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m22:52:41.896580 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m22:52:41.904523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m22:52:41.905027 [info ] [MainThread]: 
[0m22:52:41.905596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:52:41.906053 [info ] [MainThread]: 
[0m22:52:41.906537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:52:41.911850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6045278, "process_in_blocks": "0", "process_kernel_time": 0.433648, "process_mem_max_rss": "116150272", "process_out_blocks": "0", "process_user_time": 2.653608}
[0m22:52:41.912610 [debug] [MainThread]: Command `dbt run` succeeded at 22:52:41.912478 after 1.61 seconds
[0m22:52:41.913184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104478a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bcc10>]}
[0m22:52:41.913807 [debug] [MainThread]: Flushing usage events
[0m22:52:41.922470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:46.430109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081062b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106bb0>]}


============================== 23:03:46.436228 | 9258e5df-dc06-4fca-8c25-adf51e10ddf9 ==============================
[0m23:03:46.436228 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:03:46.436996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m23:03:46.695517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4c0d0>]}
[0m23:03:46.757421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839d940>]}
[0m23:03:46.759046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:03:46.879670 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:03:47.026717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:03:47.027397 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m23:03:47.263021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:03:47.267997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e130>]}
[0m23:03:47.338932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:03:47.343431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:03:47.380521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da8d60>]}
[0m23:03:47.381379 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:03:47.381985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b71f0>]}
[0m23:03:47.383726 [info ] [MainThread]: 
[0m23:03:47.384300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:47.384802 [info ] [MainThread]: 
[0m23:03:47.385541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:47.386689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:03:47.558635 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:03:47.559375 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:03:47.559950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:47.614947 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m23:03:47.616475 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:03:47.621658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:03:47.628521 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:03:47.628983 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:03:47.629409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:47.650113 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:03:47.650645 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:03:47.651093 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:03:47.662999 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m23:03:47.664575 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:03:47.665139 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:03:47.670543 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.670994 [debug] [MainThread]: On master: BEGIN
[0m23:03:47.671500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:47.692603 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:03:47.693131 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.693640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:03:47.705908 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m23:03:47.707671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9e100>]}
[0m23:03:47.708248 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:47.708850 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.709296 [debug] [MainThread]: On master: BEGIN
[0m23:03:47.709953 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:03:47.710406 [debug] [MainThread]: On master: COMMIT
[0m23:03:47.710848 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.711277 [debug] [MainThread]: On master: COMMIT
[0m23:03:47.711844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:47.712321 [debug] [MainThread]: On master: Close
[0m23:03:47.715989 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:03:47.716771 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:03:47.717415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:03:47.717933 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:03:47.727399 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:03:47.728217 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:03:47.770733 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:03:47.772028 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.772606 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:03:47.773088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:47.795641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m23:03:47.796300 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.796899 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:03:47.815296 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.018 seconds
[0m23:03:47.822732 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.823233 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m23:03:47.824857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:03:47.828689 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.829205 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m23:03:47.830230 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:03:47.847399 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:03:47.847866 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.848286 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:03:47.849299 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:03:47.855634 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m23:03:47.860166 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:03:47.860618 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m23:03:47.865950 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m23:03:47.868973 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:03:47.871661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9258e5df-dc06-4fca-8c25-adf51e10ddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b40a0>]}
[0m23:03:47.872638 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.15s]
[0m23:03:47.873419 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:03:47.874707 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.875153 [debug] [MainThread]: On master: BEGIN
[0m23:03:47.875568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:47.898390 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m23:03:47.898964 [debug] [MainThread]: On master: COMMIT
[0m23:03:47.899420 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:47.899849 [debug] [MainThread]: On master: COMMIT
[0m23:03:47.900411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:47.900886 [debug] [MainThread]: On master: Close
[0m23:03:47.901472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:47.901897 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:03:47.902348 [info ] [MainThread]: 
[0m23:03:47.902832 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m23:03:47.903711 [debug] [MainThread]: Command end result
[0m23:03:47.963579 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:03:47.965298 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:03:47.972562 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:03:47.972994 [info ] [MainThread]: 
[0m23:03:47.973540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:47.973997 [info ] [MainThread]: 
[0m23:03:47.974474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:03:47.981073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6355711, "process_in_blocks": "0", "process_kernel_time": 0.49943, "process_mem_max_rss": "117551104", "process_out_blocks": "0", "process_user_time": 2.568513}
[0m23:03:47.981824 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:47.981689 after 1.64 seconds
[0m23:03:47.982461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e0af0>]}
[0m23:03:47.983021 [debug] [MainThread]: Flushing usage events
[0m23:03:47.989835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:04.330374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b3b80>]}


============================== 23:26:04.337130 | 4186992e-5542-449c-af1a-e929c4241599 ==============================
[0m23:26:04.337130 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:26:04.338608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:04.617987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109468b50>]}
[0m23:26:04.715354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc47c0>]}
[0m23:26:04.717203 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:26:04.900862 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:26:05.096283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:05.096972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:05.107324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:26:05.152413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8c130>]}
[0m23:26:05.259663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:26:05.264609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:26:05.295751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7ea30>]}
[0m23:26:05.296647 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:26:05.297318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975e310>]}
[0m23:26:05.299334 [info ] [MainThread]: 
[0m23:26:05.300025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:05.300636 [info ] [MainThread]: 
[0m23:26:05.301528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:05.303149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:26:05.393355 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:26:05.394132 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:26:05.394762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:05.448351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m23:26:05.450485 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:26:05.457740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:26:05.466999 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:26:05.467663 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:26:05.468258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:05.498804 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m23:26:05.499529 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:26:05.500198 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:26:05.505607 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m23:26:05.507692 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:26:05.508516 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:26:05.515872 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.516561 [debug] [MainThread]: On master: BEGIN
[0m23:26:05.517136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:05.547111 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m23:26:05.547831 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.548542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:05.554474 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:26:05.556388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109474ac0>]}
[0m23:26:05.557374 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:05.558231 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.558850 [debug] [MainThread]: On master: BEGIN
[0m23:26:05.559760 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:26:05.560469 [debug] [MainThread]: On master: COMMIT
[0m23:26:05.561084 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.561665 [debug] [MainThread]: On master: COMMIT
[0m23:26:05.562406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:05.563024 [debug] [MainThread]: On master: Close
[0m23:26:05.567342 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:26:05.568344 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:26:05.569218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:26:05.569999 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:26:05.584442 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:26:05.585658 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:26:05.645408 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:26:05.646771 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:26:05.647468 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:26:05.648123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:26:05.678693 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m23:26:05.679494 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:26:05.680308 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:26:05.689041 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:26:05.699158 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:26:05.699963 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m23:26:05.701588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:05.724436 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:26:05.725248 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:26:05.725938 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:26:05.727227 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:26:05.737183 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m23:26:05.744323 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:26:05.745386 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m23:26:05.746869 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:26:05.750874 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:26:05.753788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4186992e-5542-449c-af1a-e929c4241599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a216460>]}
[0m23:26:05.754918 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m23:26:05.755972 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:26:05.757701 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.758312 [debug] [MainThread]: On master: BEGIN
[0m23:26:05.758888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:05.789632 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m23:26:05.790367 [debug] [MainThread]: On master: COMMIT
[0m23:26:05.791239 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:05.791921 [debug] [MainThread]: On master: COMMIT
[0m23:26:05.792758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:05.793544 [debug] [MainThread]: On master: Close
[0m23:26:05.794348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:05.794928 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:26:05.795542 [info ] [MainThread]: 
[0m23:26:05.796210 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m23:26:05.797394 [debug] [MainThread]: Command end result
[0m23:26:05.884031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:26:05.886374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:26:05.896906 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:26:05.897554 [info ] [MainThread]: 
[0m23:26:05.898308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:05.898931 [info ] [MainThread]: 
[0m23:26:05.899596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:26:05.907029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6973432, "process_in_blocks": "0", "process_kernel_time": 0.496801, "process_mem_max_rss": "113049600", "process_out_blocks": "0", "process_user_time": 3.332977}
[0m23:26:05.908245 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:05.908025 after 1.70 seconds
[0m23:26:05.908995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f3b50>]}
[0m23:26:05.909797 [debug] [MainThread]: Flushing usage events
[0m23:26:06.790593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:57.158104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c681c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c68ac0>]}


============================== 23:29:57.164143 | 7e2509cc-29e1-4287-8083-1da9fb8606fe ==============================
[0m23:29:57.164143 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:29:57.165162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:57.441422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c182b0>]}
[0m23:29:57.537826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701d2e0>]}
[0m23:29:57.539306 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:57.713714 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:29:57.877778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:57.878583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:57.889305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:29:57.934947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107941130>]}
[0m23:29:58.045412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:29:58.050360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:29:58.068224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abc10>]}
[0m23:29:58.069122 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:29:58.069796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079619a0>]}
[0m23:29:58.071828 [info ] [MainThread]: 
[0m23:29:58.072537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:58.073146 [info ] [MainThread]: 
[0m23:29:58.074036 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:58.075851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:29:58.160006 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:29:58.160772 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:29:58.161404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:58.214679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m23:29:58.216694 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:29:58.223988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:29:58.233418 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:29:58.234090 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:29:58.234666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:58.264826 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m23:29:58.265552 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:29:58.266185 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:29:58.271477 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m23:29:58.273533 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:29:58.274346 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:29:58.282043 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.282758 [debug] [MainThread]: On master: BEGIN
[0m23:29:58.283343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:58.313796 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m23:29:58.314509 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.315233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:58.321067 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:29:58.323040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795a940>]}
[0m23:29:58.323961 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:58.324890 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.325508 [debug] [MainThread]: On master: BEGIN
[0m23:29:58.326424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:58.327046 [debug] [MainThread]: On master: COMMIT
[0m23:29:58.327661 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.328358 [debug] [MainThread]: On master: COMMIT
[0m23:29:58.329236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:58.329891 [debug] [MainThread]: On master: Close
[0m23:29:58.332797 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:29:58.333732 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:29:58.334582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:29:58.335301 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:29:58.350758 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:29:58.351969 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:29:58.408149 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:29:58.409587 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:29:58.410298 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:29:58.411049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:29:58.441131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m23:29:58.441942 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:29:58.442890 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(price, '$', '') as numeric(10,2)) as price,
        cast(replace("service fee", '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:29:58.449342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:29:58.459314 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:29:58.460084 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m23:29:58.461602 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:58.484857 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:29:58.485670 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:29:58.486346 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:29:58.487712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:29:58.497639 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m23:29:58.504859 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:29:58.505619 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m23:29:58.506656 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:58.510825 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:29:58.513952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e2509cc-29e1-4287-8083-1da9fb8606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcb490>]}
[0m23:29:58.515105 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m23:29:58.516166 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:29:58.517940 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.518574 [debug] [MainThread]: On master: BEGIN
[0m23:29:58.519156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:58.551487 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m23:29:58.552230 [debug] [MainThread]: On master: COMMIT
[0m23:29:58.552954 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:58.553572 [debug] [MainThread]: On master: COMMIT
[0m23:29:58.554311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:58.554935 [debug] [MainThread]: On master: Close
[0m23:29:58.555716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:58.556287 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:29:58.556901 [info ] [MainThread]: 
[0m23:29:58.557551 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m23:29:58.558827 [debug] [MainThread]: Command end result
[0m23:29:58.645985 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:29:58.648358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:29:58.659141 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:29:58.659807 [info ] [MainThread]: 
[0m23:29:58.660559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:58.661176 [info ] [MainThread]: 
[0m23:29:58.661838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:29:58.665676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6202134, "process_in_blocks": "0", "process_kernel_time": 0.404807, "process_mem_max_rss": "113184768", "process_out_blocks": "0", "process_user_time": 3.266541}
[0m23:29:58.666502 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:58.666328 after 1.62 seconds
[0m23:29:58.667327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060af430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7b80>]}
[0m23:29:58.668112 [debug] [MainThread]: Flushing usage events
[0m23:29:59.476412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:38.944750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdb1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdb1b80>]}


============================== 23:35:38.951375 | 92d5ea0c-1f10-4c72-b39d-371093ae5dbb ==============================
[0m23:35:38.951375 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:35:38.952388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:35:39.244324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110166b50>]}
[0m23:35:39.351774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8c27c0>]}
[0m23:35:39.353168 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:35:39.531961 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:35:39.702642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:39.703704 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m23:35:40.105619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:35:40.114650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c48130>]}
[0m23:35:40.223737 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:35:40.228713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:35:40.247338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a52cd0>]}
[0m23:35:40.248590 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:35:40.249307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c28d60>]}
[0m23:35:40.251373 [info ] [MainThread]: 
[0m23:35:40.252060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:40.252667 [info ] [MainThread]: 
[0m23:35:40.253547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:40.254984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:35:40.391606 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:35:40.392393 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:35:40.393018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:40.447646 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m23:35:40.449663 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:35:40.457095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:35:40.466717 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:35:40.467461 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:35:40.468077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:40.500078 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m23:35:40.500811 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:35:40.501457 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:35:40.506670 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:35:40.508771 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:35:40.509616 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:35:40.517435 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.518134 [debug] [MainThread]: On master: BEGIN
[0m23:35:40.518863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:40.549369 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m23:35:40.550170 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.550903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:40.557488 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:35:40.560114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b971c0>]}
[0m23:35:40.560939 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:40.561777 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.562440 [debug] [MainThread]: On master: BEGIN
[0m23:35:40.563454 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:35:40.564102 [debug] [MainThread]: On master: COMMIT
[0m23:35:40.564718 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.565308 [debug] [MainThread]: On master: COMMIT
[0m23:35:40.566208 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:40.566842 [debug] [MainThread]: On master: Close
[0m23:35:40.569952 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:35:40.570912 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:35:40.571759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:35:40.572459 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:35:40.587731 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:35:40.588934 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:35:40.647802 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:35:40.649136 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.649928 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:35:40.650613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:35:40.681525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.031 seconds
[0m23:35:40.682354 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.683272 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as numeric(10,2)) as price,
        cast(replace(replace("service fee", ',', ''), '$', '') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:35:40.690002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:35:40.700638 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.701445 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m23:35:40.703040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:40.708228 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.708964 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m23:35:40.710604 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:35:40.737946 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:35:40.738787 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.739469 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:35:40.741352 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:35:40.751496 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m23:35:40.758505 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:35:40.759227 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m23:35:40.761604 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:35:40.765601 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:35:40.768455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d5ea0c-1f10-4c72-b39d-371093ae5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd69040>]}
[0m23:35:40.769649 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m23:35:40.770723 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:35:40.772300 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.772917 [debug] [MainThread]: On master: BEGIN
[0m23:35:40.773496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:40.807094 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m23:35:40.807843 [debug] [MainThread]: On master: COMMIT
[0m23:35:40.808463 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:40.809047 [debug] [MainThread]: On master: COMMIT
[0m23:35:40.809871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:40.810505 [debug] [MainThread]: On master: Close
[0m23:35:40.811531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:40.812116 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:35:40.812722 [info ] [MainThread]: 
[0m23:35:40.813386 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m23:35:40.814575 [debug] [MainThread]: Command end result
[0m23:35:40.848443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:35:40.850911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:35:40.862051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:35:40.862718 [info ] [MainThread]: 
[0m23:35:40.863554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:40.864262 [info ] [MainThread]: 
[0m23:35:40.864957 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:35:40.868800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0400162, "process_in_blocks": "0", "process_kernel_time": 0.427671, "process_mem_max_rss": "116502528", "process_out_blocks": "0", "process_user_time": 3.646062}
[0m23:35:40.870151 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:40.869923 after 2.04 seconds
[0m23:35:40.871001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8c27c0>]}
[0m23:35:40.871759 [debug] [MainThread]: Flushing usage events
[0m23:35:41.728052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:13.604093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ca9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fde2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdebb0>]}


============================== 23:40:13.609986 | 509194ee-1316-42fb-b1ce-ea699fda1bd4 ==============================
[0m23:40:13.609986 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:40:13.610983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:13.871880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132828b0>]}
[0m23:40:13.963845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113267d00>]}
[0m23:40:13.965150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:40:14.127183 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:40:14.282089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:14.283052 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m23:40:14.646763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:40:14.654472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e74130>]}
[0m23:40:14.755706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:40:14.760246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:40:14.776818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e37bb0>]}
[0m23:40:14.777659 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:40:14.778322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e540a0>]}
[0m23:40:14.780228 [info ] [MainThread]: 
[0m23:40:14.780893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:14.781480 [info ] [MainThread]: 
[0m23:40:14.782323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:14.783666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:40:14.907692 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:40:14.908443 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:40:14.909040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:14.960675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m23:40:14.962638 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:40:14.969616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:40:14.978842 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:40:14.979482 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:40:14.980062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:15.009435 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m23:40:15.010273 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:40:15.010909 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:40:15.016201 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m23:40:15.018313 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:40:15.019131 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:40:15.026601 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.027396 [debug] [MainThread]: On master: BEGIN
[0m23:40:15.027984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:15.056509 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m23:40:15.057270 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.058029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:15.064406 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:40:15.066577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e241c0>]}
[0m23:40:15.067353 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:15.068156 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.068788 [debug] [MainThread]: On master: BEGIN
[0m23:40:15.069645 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:40:15.070244 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.070846 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.071422 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.072164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:15.072800 [debug] [MainThread]: On master: Close
[0m23:40:15.075541 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:40:15.076456 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:40:15.077287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:40:15.077994 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:40:15.091551 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:40:15.092841 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:40:15.148203 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:40:15.149516 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:40:15.150211 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:40:15.150869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:40:15.180036 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m23:40:15.180856 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:40:15.181699 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as numeric(10,2)) as price,
        cast(
        coalesce(
            replace(replace("service fee", ',', ''), '$', ''),
            '0'
        ) as numeric(10,2))
         as service_fee
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:40:15.184611 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "cast"
LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                 ^

[0m23:40:15.185467 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m23:40:15.186539 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:40:15.201153 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m23:40:15.203927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509194ee-1316-42fb-b1ce-ea699fda1bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b8b940>]}
[0m23:40:15.205007 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.12s]
[0m23:40:15.206058 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:40:15.207064 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m23:40:15.208750 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.209379 [debug] [MainThread]: On master: BEGIN
[0m23:40:15.209961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:15.241419 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m23:40:15.242206 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.243016 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.243693 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.244458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:15.245076 [debug] [MainThread]: On master: Close
[0m23:40:15.245847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:15.246418 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:40:15.247019 [info ] [MainThread]: 
[0m23:40:15.247662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m23:40:15.248826 [debug] [MainThread]: Command end result
[0m23:40:15.280052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:40:15.282313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:40:15.292875 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:40:15.293471 [info ] [MainThread]: 
[0m23:40:15.294187 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:40:15.294820 [info ] [MainThread]: 
[0m23:40:15.295543 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m23:40:15.296161 [info ] [MainThread]: 
[0m23:40:15.296806 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:40:15.300478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8038124, "process_in_blocks": "0", "process_kernel_time": 0.35794, "process_mem_max_rss": "117624832", "process_out_blocks": "0", "process_user_time": 3.36823}
[0m23:40:15.301273 [debug] [MainThread]: Command `dbt run` failed at 23:40:15.301104 after 1.80 seconds
[0m23:40:15.302075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ca9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110936280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11365af70>]}
[0m23:40:15.302969 [debug] [MainThread]: Flushing usage events
[0m23:40:16.603270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:30.068176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6eb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ebbb0>]}


============================== 23:40:30.074011 | a5839b70-5263-408d-aef8-91e74cb288c0 ==============================
[0m23:40:30.074011 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:40:30.075017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:40:30.336232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5300d0>]}
[0m23:40:30.429079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d982940>]}
[0m23:40:30.430369 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:40:30.592552 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:40:30.746433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:30.747095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:30.757193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:40:30.799518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3c4130>]}
[0m23:40:30.903816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:40:30.908387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:40:30.925587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39e9a0>]}
[0m23:40:30.926474 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:40:30.927158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd88d30>]}
[0m23:40:30.929206 [info ] [MainThread]: 
[0m23:40:30.929899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:30.930511 [info ] [MainThread]: 
[0m23:40:30.931402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:30.932804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:40:31.047392 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:40:31.048136 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:40:31.048756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:31.099094 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m23:40:31.101123 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:40:31.108128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:40:31.117432 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:40:31.118064 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:40:31.118723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.147287 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m23:40:31.148013 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:40:31.148652 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:40:31.153573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m23:40:31.155562 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:40:31.156361 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:40:31.163507 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.164141 [debug] [MainThread]: On master: BEGIN
[0m23:40:31.164723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:31.193275 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m23:40:31.193992 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.194721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:31.200899 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:31.203223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3dc220>]}
[0m23:40:31.203988 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:31.204800 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.205421 [debug] [MainThread]: On master: BEGIN
[0m23:40:31.206302 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:40:31.206930 [debug] [MainThread]: On master: COMMIT
[0m23:40:31.207536 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.208120 [debug] [MainThread]: On master: COMMIT
[0m23:40:31.208859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:31.209475 [debug] [MainThread]: On master: Close
[0m23:40:31.212268 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:40:31.213176 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:40:31.214002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:40:31.214713 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:40:31.229288 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:40:31.230482 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:40:31.284180 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:40:31.285469 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:40:31.286163 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:40:31.286823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:40:31.315496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m23:40:31.316303 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:40:31.317132 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as numeric(10,2)) as price,
        cast(
        coalesce(
            replace(replace("service fee", ',', ''), '$', ''),
            '0'
        ) as numeric(10,2))
         as service_fee
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:40:31.318579 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "cast"
LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                 ^

[0m23:40:31.319293 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m23:40:31.320294 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:40:31.323696 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m23:40:31.326272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5839b70-5263-408d-aef8-91e74cb288c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a3040>]}
[0m23:40:31.327332 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.11s]
[0m23:40:31.328407 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:40:31.329373 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m23:40:31.331105 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.331735 [debug] [MainThread]: On master: BEGIN
[0m23:40:31.332321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:31.362763 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m23:40:31.363513 [debug] [MainThread]: On master: COMMIT
[0m23:40:31.364147 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:31.364747 [debug] [MainThread]: On master: COMMIT
[0m23:40:31.365506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:31.366134 [debug] [MainThread]: On master: Close
[0m23:40:31.366919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:31.367503 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:40:31.368124 [info ] [MainThread]: 
[0m23:40:31.368804 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:40:31.370007 [debug] [MainThread]: Command end result
[0m23:40:31.450032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:40:31.452140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:40:31.462527 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:40:31.463140 [info ] [MainThread]: 
[0m23:40:31.463856 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:40:31.464486 [info ] [MainThread]: 
[0m23:40:31.465218 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "cast"
  LINE 30:         cast("review rate number" as numeric(3,1)) as review...
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m23:40:31.465840 [info ] [MainThread]: 
[0m23:40:31.466487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:40:31.470168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5110242, "process_in_blocks": "0", "process_kernel_time": 0.317967, "process_mem_max_rss": "114667520", "process_out_blocks": "0", "process_user_time": 3.070661}
[0m23:40:31.470979 [debug] [MainThread]: Command `dbt run` failed at 23:40:31.470807 after 1.51 seconds
[0m23:40:31.471709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcbaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb0070>]}
[0m23:40:31.472422 [debug] [MainThread]: Flushing usage events
[0m23:40:32.355222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:14.578701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111731a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a66280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a66b80>]}


============================== 23:42:14.584522 | 875da8ac-dc11-4949-bf46-b31dcbd9e2e0 ==============================
[0m23:42:14.584522 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:14.585526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:14.844661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1bb50>]}
[0m23:42:14.936366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112575c10>]}
[0m23:42:14.937686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:15.103605 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:15.258997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:15.259985 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m23:42:15.622615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m23:42:15.630122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138fd130>]}
[0m23:42:15.731391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:42:15.736062 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:42:15.752829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113707cd0>]}
[0m23:42:15.753678 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:42:15.754359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138ddd60>]}
[0m23:42:15.756300 [info ] [MainThread]: 
[0m23:42:15.756989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:15.757595 [info ] [MainThread]: 
[0m23:42:15.758476 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:15.759904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m23:42:15.885236 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m23:42:15.885988 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m23:42:15.886594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:15.937923 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m23:42:15.939939 [debug] [ThreadPool]: On list_elt_project: Close
[0m23:42:15.946804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m23:42:15.956015 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:42:15.956646 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m23:42:15.957232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:15.986138 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m23:42:15.986866 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m23:42:15.987504 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:42:15.992623 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m23:42:15.994580 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m23:42:15.995352 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m23:42:16.002699 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.003505 [debug] [MainThread]: On master: BEGIN
[0m23:42:16.004081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:16.033139 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m23:42:16.033859 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.034581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:16.041137 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:16.043311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113899970>]}
[0m23:42:16.044084 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:16.044913 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.045531 [debug] [MainThread]: On master: BEGIN
[0m23:42:16.046389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:16.047000 [debug] [MainThread]: On master: COMMIT
[0m23:42:16.047609 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.048191 [debug] [MainThread]: On master: COMMIT
[0m23:42:16.048959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:16.049594 [debug] [MainThread]: On master: Close
[0m23:42:16.052453 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m23:42:16.053395 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m23:42:16.054218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m23:42:16.054933 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m23:42:16.068333 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m23:42:16.070148 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m23:42:16.126056 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m23:42:16.127379 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.128092 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m23:42:16.128764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:42:16.158023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m23:42:16.158834 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.159664 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as numeric(10,2)) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as numeric(10,2)) as service_fee,
        cast("review rate number" as numeric(3,1)) as review_rating,
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,

        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as numeric(3,1)), 0) as review_rate_number,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m23:42:16.165828 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:42:16.175783 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.176511 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m23:42:16.177960 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:16.182719 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.183422 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m23:42:16.184801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:16.209689 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:42:16.210415 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.211088 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m23:42:16.212325 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:42:16.221957 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m23:42:16.228836 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m23:42:16.229551 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m23:42:16.231895 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m23:42:16.235669 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m23:42:16.238321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875da8ac-dc11-4949-bf46-b31dcbd9e2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a21040>]}
[0m23:42:16.239431 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m23:42:16.240483 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m23:42:16.242210 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.242832 [debug] [MainThread]: On master: BEGIN
[0m23:42:16.243422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:16.273951 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m23:42:16.274906 [debug] [MainThread]: On master: COMMIT
[0m23:42:16.275575 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:16.276166 [debug] [MainThread]: On master: COMMIT
[0m23:42:16.276948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:16.277603 [debug] [MainThread]: On master: Close
[0m23:42:16.278404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:16.278991 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m23:42:16.279598 [info ] [MainThread]: 
[0m23:42:16.280259 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m23:42:16.281450 [debug] [MainThread]: Command end result
[0m23:42:16.313435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m23:42:16.315674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m23:42:16.325872 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m23:42:16.326671 [info ] [MainThread]: 
[0m23:42:16.327449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:16.328070 [info ] [MainThread]: 
[0m23:42:16.328730 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:42:16.332438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8619604, "process_in_blocks": "0", "process_kernel_time": 0.361032, "process_mem_max_rss": "117833728", "process_out_blocks": "0", "process_user_time": 3.430759}
[0m23:42:16.333232 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:16.333062 after 1.86 seconds
[0m23:42:16.333950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111731a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e84310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112575c10>]}
[0m23:42:16.334687 [debug] [MainThread]: Flushing usage events
[0m23:42:17.310604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:37.748615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df21280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df21b80>]}


============================== 19:17:37.754321 | 8f40d5a6-c65f-4f73-9b71-2a7d4522b328 ==============================
[0m19:17:37.754321 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:17:37.755088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:17:37.944149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d7b50>]}
[0m19:17:38.005948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da31c10>]}
[0m19:17:38.007435 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:17:38.135146 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:17:38.274744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:38.275437 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m19:17:38.517784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m19:17:38.523424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb8130>]}
[0m19:17:38.595718 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:17:38.599455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:17:38.632711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc3cd0>]}
[0m19:17:38.633524 [info ] [MainThread]: Found 2 models, 433 macros
[0m19:17:38.634072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed9ad60>]}
[0m19:17:38.635749 [info ] [MainThread]: 
[0m19:17:38.636299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:38.636775 [info ] [MainThread]: 
[0m19:17:38.637469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:38.638555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m19:17:38.754146 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m19:17:38.754812 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m19:17:38.755335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:38.809699 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m19:17:38.811552 [debug] [ThreadPool]: On list_elt_project: Close
[0m19:17:38.816785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m19:17:38.823558 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:17:38.824012 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m19:17:38.824427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:38.846968 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:17:38.847514 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:17:38.847993 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:17:38.855281 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:17:38.856752 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m19:17:38.857299 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m19:17:38.862412 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:38.862859 [debug] [MainThread]: On master: BEGIN
[0m19:17:38.863264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:38.884669 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:17:38.885337 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:38.885849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:38.894942 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m19:17:38.896360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed081c0>]}
[0m19:17:38.896968 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:38.897570 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:38.898026 [debug] [MainThread]: On master: BEGIN
[0m19:17:38.898700 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:17:38.899150 [debug] [MainThread]: On master: COMMIT
[0m19:17:38.899583 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:38.899995 [debug] [MainThread]: On master: COMMIT
[0m19:17:38.900515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:17:38.900959 [debug] [MainThread]: On master: Close
[0m19:17:38.903794 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m19:17:38.904498 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m19:17:38.905106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m19:17:38.905604 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m19:17:38.914957 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m19:17:38.916712 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m19:17:38.956284 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m19:17:38.957624 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:17:38.958117 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m19:17:38.958581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:17:38.979903 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:17:38.980512 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:17:38.981097 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER 0)) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,
        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m19:17:38.984215 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "0"
LINE 25: ...    coalesce(cast("review rate number" as INTEGER 0)) as rev...
                                                              ^

[0m19:17:38.984894 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m19:17:38.985717 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m19:17:38.996754 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "0"
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER 0)) as rev...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:17:38.999268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f40d5a6-c65f-4f73-9b71-2a7d4522b328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dedab20>]}
[0m19:17:39.000127 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m19:17:39.001019 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m19:17:39.001764 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "0"
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER 0)) as rev...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m19:17:39.003472 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:39.003930 [debug] [MainThread]: On master: BEGIN
[0m19:17:39.004352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:39.028106 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:17:39.028689 [debug] [MainThread]: On master: COMMIT
[0m19:17:39.029167 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:39.029605 [debug] [MainThread]: On master: COMMIT
[0m19:17:39.030152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:17:39.030622 [debug] [MainThread]: On master: Close
[0m19:17:39.031201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:39.031638 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m19:17:39.032134 [info ] [MainThread]: 
[0m19:17:39.032672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m19:17:39.033566 [debug] [MainThread]: Command end result
[0m19:17:39.057858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:17:39.059752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:17:39.067362 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m19:17:39.067879 [info ] [MainThread]: 
[0m19:17:39.068427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:17:39.068893 [info ] [MainThread]: 
[0m19:17:39.069438 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "0"
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER 0)) as rev...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:17:39.069893 [info ] [MainThread]: 
[0m19:17:39.070356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:39.074010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4149712, "process_in_blocks": "0", "process_kernel_time": 0.372833, "process_mem_max_rss": "117571584", "process_out_blocks": "0", "process_user_time": 2.482933}
[0m19:17:39.074656 [debug] [MainThread]: Command `dbt run` failed at 19:17:39.074530 after 1.42 seconds
[0m19:17:39.075204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbeda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb885b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5fa3a0>]}
[0m19:17:39.075721 [debug] [MainThread]: Flushing usage events
[0m19:17:41.221682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:00.686311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c062b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c06bb0>]}


============================== 19:18:00.691786 | 5c05adf9-8ed6-41f6-a138-746b13696eeb ==============================
[0m19:18:00.691786 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:18:00.692579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:00.878861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4c0d0>]}
[0m19:18:00.939948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9e940>]}
[0m19:18:00.941575 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:18:01.059567 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:18:01.188027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:01.188715 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m19:18:01.426735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m19:18:01.431806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9d130>]}
[0m19:18:01.501266 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:18:01.504476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:18:01.532071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8d60>]}
[0m19:18:01.532813 [info ] [MainThread]: Found 2 models, 433 macros
[0m19:18:01.533365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb61f0>]}
[0m19:18:01.534968 [info ] [MainThread]: 
[0m19:18:01.535499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:01.535972 [info ] [MainThread]: 
[0m19:18:01.536670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:01.537711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m19:18:01.637685 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m19:18:01.638387 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m19:18:01.638924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:01.684370 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m19:18:01.685934 [debug] [ThreadPool]: On list_elt_project: Close
[0m19:18:01.691262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m19:18:01.698264 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:18:01.698796 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m19:18:01.699224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:01.721780 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:18:01.722326 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:18:01.722777 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:18:01.726716 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:18:01.728227 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m19:18:01.728789 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m19:18:01.733885 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.734384 [debug] [MainThread]: On master: BEGIN
[0m19:18:01.734806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:01.757018 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:18:01.757688 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.758203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:01.762318 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:18:01.763609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa39c10>]}
[0m19:18:01.764197 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:01.764887 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.765330 [debug] [MainThread]: On master: BEGIN
[0m19:18:01.765979 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:18:01.766414 [debug] [MainThread]: On master: COMMIT
[0m19:18:01.766848 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.767269 [debug] [MainThread]: On master: COMMIT
[0m19:18:01.767792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:01.768235 [debug] [MainThread]: On master: Close
[0m19:18:01.771078 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m19:18:01.771742 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m19:18:01.772336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m19:18:01.772840 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m19:18:01.782488 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m19:18:01.783557 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m19:18:01.824120 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m19:18:01.825039 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:18:01.825512 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m19:18:01.825957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:01.847089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:18:01.847694 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:18:01.848280 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ,0)) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,
        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m19:18:01.849320 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25: ...    coalesce(cast("review rate number" as INTEGER ,0)) as re...
                                                              ^

[0m19:18:01.849854 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m19:18:01.850589 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m19:18:01.856020 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER ,0)) as re...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:18:01.858200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c05adf9-8ed6-41f6-a138-746b13696eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb7e20>]}
[0m19:18:01.859013 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m19:18:01.859776 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m19:18:01.860509 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER ,0)) as re...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m19:18:01.861777 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.862214 [debug] [MainThread]: On master: BEGIN
[0m19:18:01.862613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:01.884867 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:18:01.885478 [debug] [MainThread]: On master: COMMIT
[0m19:18:01.885978 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:01.886442 [debug] [MainThread]: On master: COMMIT
[0m19:18:01.887037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:01.887525 [debug] [MainThread]: On master: Close
[0m19:18:01.888104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:01.888566 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m19:18:01.889101 [info ] [MainThread]: 
[0m19:18:01.889605 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m19:18:01.890483 [debug] [MainThread]: Command end result
[0m19:18:01.913633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:18:01.915334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:18:01.922772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m19:18:01.923244 [info ] [MainThread]: 
[0m19:18:01.923921 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:18:01.924433 [info ] [MainThread]: 
[0m19:18:01.924983 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 25: ...    coalesce(cast("review rate number" as INTEGER ,0)) as re...
                                                                ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:18:01.925451 [info ] [MainThread]: 
[0m19:18:01.925931 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:18:01.929098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3225099, "process_in_blocks": "0", "process_kernel_time": 0.311729, "process_mem_max_rss": "117387264", "process_out_blocks": "0", "process_user_time": 2.403525}
[0m19:18:01.929683 [debug] [MainThread]: Command `dbt run` failed at 19:18:01.929560 after 1.32 seconds
[0m19:18:01.930212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab47af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107645c70>]}
[0m19:18:01.930821 [debug] [MainThread]: Flushing usage events
[0m19:18:02.604143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:01.537809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112701a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a362b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a36bb0>]}


============================== 19:19:01.542226 | 224c7eec-0579-47c3-9b21-ba634461b030 ==============================
[0m19:19:01.542226 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:19:01.542959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:01.719004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cda8b0>]}
[0m19:19:01.779619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cbfd00>]}
[0m19:19:01.780543 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:19:01.890855 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:19:01.991992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:01.992659 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m19:19:02.230115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m19:19:02.235046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148cc130>]}
[0m19:19:02.304352 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:19:02.307578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:19:02.318588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11488ebb0>]}
[0m19:19:02.319206 [info ] [MainThread]: Found 2 models, 433 macros
[0m19:19:02.319657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148ac0a0>]}
[0m19:19:02.320946 [info ] [MainThread]: 
[0m19:19:02.321377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:02.321795 [info ] [MainThread]: 
[0m19:19:02.322400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:02.323342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m19:19:02.421317 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m19:19:02.421979 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m19:19:02.422497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:02.464706 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m19:19:02.466238 [debug] [ThreadPool]: On list_elt_project: Close
[0m19:19:02.471432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m19:19:02.478095 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:19:02.478635 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m19:19:02.479049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:02.500733 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:19:02.501289 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:19:02.501751 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:19:02.505662 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:19:02.507138 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m19:19:02.507696 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m19:19:02.512818 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.513293 [debug] [MainThread]: On master: BEGIN
[0m19:19:02.513703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:02.534638 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m19:19:02.535285 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.535815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:02.540011 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:19:02.541374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11487fe50>]}
[0m19:19:02.541970 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:02.542539 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.542969 [debug] [MainThread]: On master: BEGIN
[0m19:19:02.543598 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:19:02.544044 [debug] [MainThread]: On master: COMMIT
[0m19:19:02.544467 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.544868 [debug] [MainThread]: On master: COMMIT
[0m19:19:02.545381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:02.545841 [debug] [MainThread]: On master: Close
[0m19:19:02.547910 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m19:19:02.548587 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m19:19:02.549185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m19:19:02.549669 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m19:19:02.559130 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m19:19:02.560182 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m19:19:02.599461 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m19:19:02.600361 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:02.600816 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m19:19:02.601252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:19:02.622302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:19:02.622902 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:02.623526 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified -- No need to COALESCE again
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,
        coalesce(house_rules, 'No rules') as house_rules, -- null values replaced
    
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m19:19:02.624583 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "case"
LINE 31:         case
                 ^

[0m19:19:02.625087 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m19:19:02.625801 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m19:19:02.628325 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 31:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:19:02.630218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '224c7eec-0579-47c3-9b21-ba634461b030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e2940>]}
[0m19:19:02.630995 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.08s]
[0m19:19:02.631746 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m19:19:02.632442 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 31:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m19:19:02.633759 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.634197 [debug] [MainThread]: On master: BEGIN
[0m19:19:02.634595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:02.661891 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m19:19:02.662453 [debug] [MainThread]: On master: COMMIT
[0m19:19:02.662907 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:02.663339 [debug] [MainThread]: On master: COMMIT
[0m19:19:02.664020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:02.664516 [debug] [MainThread]: On master: Close
[0m19:19:02.665194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:02.665806 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m19:19:02.666311 [info ] [MainThread]: 
[0m19:19:02.666801 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:19:02.667671 [debug] [MainThread]: Command end result
[0m19:19:02.693920 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:19:02.696732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:19:02.705332 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m19:19:02.705887 [info ] [MainThread]: 
[0m19:19:02.706442 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:19:02.706953 [info ] [MainThread]: 
[0m19:19:02.707499 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 31:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m19:19:02.707970 [info ] [MainThread]: 
[0m19:19:02.708463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:19:02.711307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2436345, "process_in_blocks": "0", "process_kernel_time": 0.248637, "process_mem_max_rss": "117850112", "process_out_blocks": "0", "process_user_time": 2.264016}
[0m19:19:02.712022 [debug] [MainThread]: Command `dbt run` failed at 19:19:02.711874 after 1.24 seconds
[0m19:19:02.712631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112701a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11488ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a8070>]}
[0m19:19:02.713214 [debug] [MainThread]: Flushing usage events
[0m19:19:03.355254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:39.098765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f41bb0>]}


============================== 19:19:39.103142 | 16e9ee0d-0b06-4bc5-9522-dbbe63a725bc ==============================
[0m19:19:39.103142 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:19:39.103861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:19:39.292794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d860d0>]}
[0m19:19:39.356443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d6940>]}
[0m19:19:39.357358 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:19:39.480270 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:19:39.591348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:39.596802 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m19:19:39.862723 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m19:19:39.868250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd7130>]}
[0m19:19:39.941529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:19:39.944818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:19:39.956938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be2d60>]}
[0m19:19:39.957634 [info ] [MainThread]: Found 2 models, 433 macros
[0m19:19:39.958194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f01f0>]}
[0m19:19:39.959723 [info ] [MainThread]: 
[0m19:19:39.960252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:39.960681 [info ] [MainThread]: 
[0m19:19:39.961309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:39.962332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m19:19:40.059443 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m19:19:40.060105 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m19:19:40.060605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:40.101289 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m19:19:40.102887 [debug] [ThreadPool]: On list_elt_project: Close
[0m19:19:40.108414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m19:19:40.115358 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:19:40.115885 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m19:19:40.116299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:40.137757 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:19:40.138311 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:19:40.138861 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:19:40.142700 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:19:40.144193 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m19:19:40.144767 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m19:19:40.150117 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.150633 [debug] [MainThread]: On master: BEGIN
[0m19:19:40.151054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:40.172666 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:19:40.173336 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.173846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:40.177930 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:19:40.179208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d73c10>]}
[0m19:19:40.179777 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:40.180335 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.180761 [debug] [MainThread]: On master: BEGIN
[0m19:19:40.181374 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:19:40.181825 [debug] [MainThread]: On master: COMMIT
[0m19:19:40.182241 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.182641 [debug] [MainThread]: On master: COMMIT
[0m19:19:40.183147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:40.183568 [debug] [MainThread]: On master: Close
[0m19:19:40.185561 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m19:19:40.186220 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m19:19:40.186811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m19:19:40.187368 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m19:19:40.196791 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m19:19:40.197850 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m19:19:40.237789 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m19:19:40.238768 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:40.239270 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m19:19:40.239730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:19:40.260733 [debug] [Thread-1  ]: SQL status: BEGIN in 0.021 seconds
[0m19:19:40.261324 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:40.261899 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,
        coalesce(house_rules, 'No rules') as house_rules -- null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m19:19:40.272779 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m19:19:40.279768 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:40.280259 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m19:19:40.283592 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:19:40.301056 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m19:19:40.301675 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:40.302170 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m19:19:40.303192 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:19:40.310256 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m19:19:40.315219 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:19:40.315727 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m19:19:40.318261 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m19:19:40.321259 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m19:19:40.323212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e9ee0d-0b06-4bc5-9522-dbbe63a725bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef0e20>]}
[0m19:19:40.324002 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:19:40.324747 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m19:19:40.325976 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.326401 [debug] [MainThread]: On master: BEGIN
[0m19:19:40.326811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:40.350432 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:19:40.351039 [debug] [MainThread]: On master: COMMIT
[0m19:19:40.351501 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:40.351938 [debug] [MainThread]: On master: COMMIT
[0m19:19:40.352507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:40.352954 [debug] [MainThread]: On master: Close
[0m19:19:40.353526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:40.353938 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m19:19:40.354395 [info ] [MainThread]: 
[0m19:19:40.354909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m19:19:40.355793 [debug] [MainThread]: Command end result
[0m19:19:40.381502 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:19:40.383367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:19:40.391063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m19:19:40.391564 [info ] [MainThread]: 
[0m19:19:40.392201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:40.392659 [info ] [MainThread]: 
[0m19:19:40.393127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:40.395902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3690671, "process_in_blocks": "0", "process_kernel_time": 0.23586, "process_mem_max_rss": "117526528", "process_out_blocks": "0", "process_user_time": 2.375267}
[0m19:19:40.396533 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:40.396406 after 1.37 seconds
[0m19:19:40.397055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a68a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838c100>]}
[0m19:19:40.397576 [debug] [MainThread]: Flushing usage events
[0m19:19:41.211385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:12.343789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096432b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109643bb0>]}


============================== 19:43:12.349036 | 735bd517-c788-4d2f-b2d4-cd3f2951d4f8 ==============================
[0m19:43:12.349036 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:43:12.349794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:12.548836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e78b0>]}
[0m19:43:12.613359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ccd00>]}
[0m19:43:12.614845 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:43:12.738547 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:43:12.876647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:43:12.877145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:43:12.884178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m19:43:12.915405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31b130>]}
[0m19:43:12.993304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:43:12.996843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:43:13.021802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2efb50>]}
[0m19:43:13.022473 [info ] [MainThread]: Found 2 models, 433 macros
[0m19:43:13.022954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ef5b0>]}
[0m19:43:13.024463 [info ] [MainThread]: 
[0m19:43:13.024959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:43:13.025391 [info ] [MainThread]: 
[0m19:43:13.026081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:43:13.027144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m19:43:13.094594 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m19:43:13.095155 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m19:43:13.095632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:13.144203 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m19:43:13.146030 [debug] [ThreadPool]: On list_elt_project: Close
[0m19:43:13.151579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m19:43:13.158577 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:43:13.159112 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m19:43:13.159535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:13.182856 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m19:43:13.183399 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m19:43:13.183852 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:43:13.189542 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m19:43:13.191137 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m19:43:13.191746 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m19:43:13.196993 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.197471 [debug] [MainThread]: On master: BEGIN
[0m19:43:13.197876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:43:13.220538 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:43:13.221071 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.221581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:43:13.226437 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:43:13.227833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a333520>]}
[0m19:43:13.228403 [debug] [MainThread]: On master: ROLLBACK
[0m19:43:13.228959 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.229379 [debug] [MainThread]: On master: BEGIN
[0m19:43:13.230003 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:43:13.230447 [debug] [MainThread]: On master: COMMIT
[0m19:43:13.230880 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.231310 [debug] [MainThread]: On master: COMMIT
[0m19:43:13.231839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:43:13.232286 [debug] [MainThread]: On master: Close
[0m19:43:13.235226 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m19:43:13.235922 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m19:43:13.236553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m19:43:13.237084 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m19:43:13.247884 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m19:43:13.249500 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m19:43:13.290126 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m19:43:13.291066 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:43:13.291558 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m19:43:13.292010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:43:13.313755 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m19:43:13.314488 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:43:13.315168 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("minimum nights" as integer), 1) as minimum_nights,  -- Replaced NULL with 1
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("availability 365"  as integer ) < 0 then 0
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 0)
        end as availability_365,
        coalesce(house_rules, 'No rules') as house_rules -- null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m19:43:13.320741 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:43:13.328094 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:43:13.328623 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m19:43:13.329706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:43:13.345019 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m19:43:13.345572 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:43:13.346019 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m19:43:13.346905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:43:13.354082 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m19:43:13.359222 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m19:43:13.359791 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m19:43:13.360573 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:43:13.363487 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m19:43:13.365868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735bd517-c788-4d2f-b2d4-cd3f2951d4f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a23d0>]}
[0m19:43:13.366716 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m19:43:13.367467 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m19:43:13.369069 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.369495 [debug] [MainThread]: On master: BEGIN
[0m19:43:13.369890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:43:13.392795 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:43:13.393343 [debug] [MainThread]: On master: COMMIT
[0m19:43:13.393785 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:13.394205 [debug] [MainThread]: On master: COMMIT
[0m19:43:13.394792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:43:13.395225 [debug] [MainThread]: On master: Close
[0m19:43:13.395792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:13.396356 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m19:43:13.396827 [info ] [MainThread]: 
[0m19:43:13.397515 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m19:43:13.398457 [debug] [MainThread]: Command end result
[0m19:43:13.471137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m19:43:13.473102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m19:43:13.482029 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m19:43:13.482548 [info ] [MainThread]: 
[0m19:43:13.483163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:43:13.483676 [info ] [MainThread]: 
[0m19:43:13.484233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:43:13.488446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2262403, "process_in_blocks": "0", "process_kernel_time": 0.376111, "process_mem_max_rss": "113717248", "process_out_blocks": "0", "process_user_time": 2.367465}
[0m19:43:13.489194 [debug] [MainThread]: Command `dbt run` succeeded at 19:43:13.489053 after 1.23 seconds
[0m19:43:13.489780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109585f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a1ee0>]}
[0m19:43:13.490592 [debug] [MainThread]: Flushing usage events
[0m19:43:14.347730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:39.071572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11075ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8fbb0>]}


============================== 20:50:39.078930 | 8057c979-9038-4737-ab7c-960dc734f750 ==============================
[0m20:50:39.078930 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:39.079762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:39.308537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c5f10>]}
[0m20:50:39.375452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7dc70>]}
[0m20:50:39.376800 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:39.499725 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:39.635269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:39.635948 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:50:39.886717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:50:39.892229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112926130>]}
[0m20:50:39.968838 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:50:39.972431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:50:39.997066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112142310>]}
[0m20:50:39.997730 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:50:39.998198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11214d160>]}
[0m20:50:39.999588 [info ] [MainThread]: 
[0m20:50:40.000096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:40.000663 [info ] [MainThread]: 
[0m20:50:40.001332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:40.002348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:50:40.114259 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:50:40.114927 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:50:40.115465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:40.175693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m20:50:40.177264 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:50:40.182662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:50:40.189788 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:50:40.190266 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:50:40.190680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:40.213046 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:50:40.213627 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:50:40.214171 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:40.219881 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m20:50:40.221399 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:50:40.222001 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:50:40.227470 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.228090 [debug] [MainThread]: On master: BEGIN
[0m20:50:40.228504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:40.249698 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m20:50:40.250236 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.250756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:40.256912 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m20:50:40.258662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d02e0>]}
[0m20:50:40.259230 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:40.259813 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.260252 [debug] [MainThread]: On master: BEGIN
[0m20:50:40.260960 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:40.261443 [debug] [MainThread]: On master: COMMIT
[0m20:50:40.261877 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.262292 [debug] [MainThread]: On master: COMMIT
[0m20:50:40.262837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:40.263285 [debug] [MainThread]: On master: Close
[0m20:50:40.266259 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:50:40.267002 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:50:40.267630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:50:40.268146 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:50:40.277940 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:50:40.279878 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:50:40.321147 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:50:40.322056 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:50:40.322527 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:50:40.322969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:40.347175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m20:50:40.347779 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:50:40.348381 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1,
            else coalesce(cast("minimum nights" as integer), 1) ,  -- Replaced NULL with 1
        end as minimum_nights
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 3s65"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m20:50:40.350170 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 31: ...          when cast("minimum nights" as integer ) <0 then 1,
                                                                       ^

[0m20:50:40.350822 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:50:40.351644 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:50:40.363940 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 31: ...          when cast("minimum nights" as integer ) <0 then 1,
                                                                         ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:50:40.366493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8057c979-9038-4737-ab7c-960dc734f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3df40>]}
[0m20:50:40.367411 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.10s]
[0m20:50:40.368263 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:50:40.369018 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 31: ...          when cast("minimum nights" as integer ) <0 then 1,
                                                                         ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:50:40.370271 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.370735 [debug] [MainThread]: On master: BEGIN
[0m20:50:40.371156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:40.395020 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m20:50:40.395616 [debug] [MainThread]: On master: COMMIT
[0m20:50:40.396166 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:40.396724 [debug] [MainThread]: On master: COMMIT
[0m20:50:40.397376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:40.397870 [debug] [MainThread]: On master: Close
[0m20:50:40.398534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:40.398994 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:50:40.399483 [info ] [MainThread]: 
[0m20:50:40.399983 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:50:40.400890 [debug] [MainThread]: Command end result
[0m20:50:40.424185 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:50:40.426055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:50:40.434200 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:50:40.434710 [info ] [MainThread]: 
[0m20:50:40.435367 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:40.435869 [info ] [MainThread]: 
[0m20:50:40.436418 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near ","
  LINE 31: ...          when cast("minimum nights" as integer ) <0 then 1,
                                                                         ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:50:40.436878 [info ] [MainThread]: 
[0m20:50:40.437369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:50:40.441330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4614934, "process_in_blocks": "0", "process_kernel_time": 0.383869, "process_mem_max_rss": "117596160", "process_out_blocks": "0", "process_user_time": 2.485098}
[0m20:50:40.441976 [debug] [MainThread]: Command `dbt run` failed at 20:50:40.441846 after 1.46 seconds
[0m20:50:40.442533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11075ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110646fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff5fd0>]}
[0m20:50:40.443071 [debug] [MainThread]: Flushing usage events
[0m20:50:41.589302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:59.781001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f7ac0>]}


============================== 20:50:59.786594 | 2eb0c791-d51f-4848-891a-1b4c4cfcd8e1 ==============================
[0m20:50:59.786594 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:59.787357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:00.005021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a50d0>]}
[0m20:51:00.070298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cac2e0>]}
[0m20:51:00.071629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:00.200011 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:00.326317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:00.327045 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:51:00.587816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:51:00.593242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778d130>]}
[0m20:51:00.670583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:00.674151 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:00.694357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107751a30>]}
[0m20:51:00.695010 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:51:00.695489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107751dc0>]}
[0m20:51:00.696918 [info ] [MainThread]: 
[0m20:51:00.697397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:00.697815 [info ] [MainThread]: 
[0m20:51:00.698439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:00.699524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:51:00.804327 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:51:00.804991 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:51:00.805507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:00.856930 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m20:51:00.858484 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:51:00.863874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:51:00.871591 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:00.873023 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:51:00.874055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:00.896868 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m20:51:00.897432 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:00.897899 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:00.901832 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:51:00.903373 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:51:00.904008 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:51:00.909634 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:00.910152 [debug] [MainThread]: On master: BEGIN
[0m20:51:00.910678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:00.932449 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:51:00.932999 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:00.933522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:00.938534 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m20:51:00.940283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077374c0>]}
[0m20:51:00.940952 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:00.941578 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:00.942031 [debug] [MainThread]: On master: BEGIN
[0m20:51:00.942682 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:00.943126 [debug] [MainThread]: On master: COMMIT
[0m20:51:00.943561 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:00.943979 [debug] [MainThread]: On master: COMMIT
[0m20:51:00.944508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:00.944950 [debug] [MainThread]: On master: Close
[0m20:51:00.947782 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:51:00.948473 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:51:00.949086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:51:00.949591 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:51:00.960068 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:51:00.961007 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:51:01.002673 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:51:01.003724 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:01.004248 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:51:01.004760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:01.027710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m20:51:01.028330 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:01.028937 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 3s65"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m20:51:01.030420 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "case"
LINE 34:         case
                 ^

[0m20:51:01.030928 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:51:01.031669 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:51:01.040154 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 34:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:51:01.042380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb0c791-d51f-4848-891a-1b4c4cfcd8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a3490>]}
[0m20:51:01.043255 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:51:01.044025 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:51:01.044740 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 34:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:51:01.045980 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:01.046430 [debug] [MainThread]: On master: BEGIN
[0m20:51:01.046838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:01.071784 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m20:51:01.072374 [debug] [MainThread]: On master: COMMIT
[0m20:51:01.072849 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:01.073298 [debug] [MainThread]: On master: COMMIT
[0m20:51:01.073937 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:01.074428 [debug] [MainThread]: On master: Close
[0m20:51:01.075052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:01.075888 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:51:01.076812 [info ] [MainThread]: 
[0m20:51:01.077498 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:51:01.078815 [debug] [MainThread]: Command end result
[0m20:51:01.103664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:01.105396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:01.114054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:51:01.114570 [info ] [MainThread]: 
[0m20:51:01.115110 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:51:01.115581 [info ] [MainThread]: 
[0m20:51:01.116108 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  syntax error at or near "case"
  LINE 34:         case
                   ^
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:51:01.116545 [info ] [MainThread]: 
[0m20:51:01.117061 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:51:01.121348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4216197, "process_in_blocks": "0", "process_kernel_time": 0.323342, "process_mem_max_rss": "117551104", "process_out_blocks": "0", "process_user_time": 2.513372}
[0m20:51:01.142649 [debug] [MainThread]: Command `dbt run` failed at 20:51:01.122677 after 1.42 seconds
[0m20:51:01.160051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d24430>]}
[0m20:51:01.161098 [debug] [MainThread]: Flushing usage events
[0m20:51:06.178202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:29.163283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b37a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6cc10>]}


============================== 20:51:29.169307 | 0eda6291-7ce2-41f6-b43b-1bb702a4181f ==============================
[0m20:51:29.169307 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:51:29.170245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:29.394589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e11ee0>]}
[0m20:51:29.461333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e39a30>]}
[0m20:51:29.462723 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:29.587070 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:29.715299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:29.715993 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:51:29.972069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:51:29.977564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad02130>]}
[0m20:51:30.051957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:30.055406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:30.077043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0d430>]}
[0m20:51:30.077726 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:51:30.078241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab552e0>]}
[0m20:51:30.079831 [info ] [MainThread]: 
[0m20:51:30.080382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:30.080829 [info ] [MainThread]: 
[0m20:51:30.081470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:30.082492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:51:30.199838 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:51:30.200532 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:51:30.201072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:30.250156 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m20:51:30.251697 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:51:30.257073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:51:30.264123 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:30.264646 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:51:30.265078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:30.287523 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:51:30.288058 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:30.288513 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:30.292452 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:51:30.293961 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:51:30.294541 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:51:30.300124 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.300802 [debug] [MainThread]: On master: BEGIN
[0m20:51:30.301221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:30.322711 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m20:51:30.323251 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.323775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:30.328831 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m20:51:30.330609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bd0a0>]}
[0m20:51:30.331213 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:30.331831 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.332272 [debug] [MainThread]: On master: BEGIN
[0m20:51:30.332919 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:30.333360 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.333809 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.334231 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.334787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:30.335255 [debug] [MainThread]: On master: Close
[0m20:51:30.338000 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:51:30.338696 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:51:30.339315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:51:30.339833 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:51:30.349658 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:51:30.350758 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:51:30.392011 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:51:30.392941 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:30.393414 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:51:30.393866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:30.415839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m20:51:30.416474 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:30.417100 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 3s65"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m20:51:30.419429 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "availability 3s65" does not exist
LINE 37:             else coalesce(cast("availability 3s65"  as integ...
                                        ^
HINT:  Perhaps you meant to reference the column "source.availability 365".

[0m20:51:30.420008 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: ROLLBACK
[0m20:51:30.420775 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:51:30.430075 [debug] [Thread-1  ]: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability 3s65" does not exist
  LINE 37:             else coalesce(cast("availability 3s65"  as integ...
                                          ^
  HINT:  Perhaps you meant to reference the column "source.availability 365".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:51:30.432785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eda6291-7ce2-41f6-b43b-1bb702a4181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e06520>]}
[0m20:51:30.433722 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.airbnb_transformed ................. [[31mERROR[0m in 0.09s]
[0m20:51:30.434522 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:51:30.435259 [debug] [Thread-4  ]: Marking all children of 'model.first_elt.airbnb_transformed' to be skipped because of status 'error'.  Reason: Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability 3s65" does not exist
  LINE 37:             else coalesce(cast("availability 3s65"  as integ...
                                          ^
  HINT:  Perhaps you meant to reference the column "source.availability 365".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql.
[0m20:51:30.436500 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.436957 [debug] [MainThread]: On master: BEGIN
[0m20:51:30.437362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:30.460391 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:51:30.460975 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.461443 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:30.461881 [debug] [MainThread]: On master: COMMIT
[0m20:51:30.462460 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:30.463005 [debug] [MainThread]: On master: Close
[0m20:51:30.463608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:30.464038 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:51:30.464711 [info ] [MainThread]: 
[0m20:51:30.465251 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:51:30.466232 [debug] [MainThread]: Command end result
[0m20:51:30.491220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:30.493127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:30.501035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:51:30.501565 [info ] [MainThread]: 
[0m20:51:30.502090 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:51:30.502561 [info ] [MainThread]: 
[0m20:51:30.503086 [error] [MainThread]:   Database Error in model airbnb_transformed (./first_elt/models/airbnb_transformed.sql)
  column "availability 3s65" does not exist
  LINE 37:             else coalesce(cast("availability 3s65"  as integ...
                                          ^
  HINT:  Perhaps you meant to reference the column "source.availability 365".
  compiled code at target/run/first_elt/./first_elt/models/airbnb_transformed.sql
[0m20:51:30.503534 [info ] [MainThread]: 
[0m20:51:30.504009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:51:30.508066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4261317, "process_in_blocks": "0", "process_kernel_time": 0.326054, "process_mem_max_rss": "117166080", "process_out_blocks": "0", "process_user_time": 2.485206}
[0m20:51:30.508758 [debug] [MainThread]: Command `dbt run` failed at 20:51:30.508626 after 1.43 seconds
[0m20:51:30.509401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b37a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a5ac0>]}
[0m20:51:30.510316 [debug] [MainThread]: Flushing usage events
[0m20:51:35.519227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:42.740789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598dbb0>]}


============================== 20:51:42.745317 | 0a68d2cb-503f-44f3-ada2-643fbb8c7e89 ==============================
[0m20:51:42.745317 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:51:42.746039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m20:51:42.933257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d30d0>]}
[0m20:51:43.002810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c23940>]}
[0m20:51:43.003844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:43.121523 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:43.227595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:43.228339 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m20:51:43.483218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m20:51:43.488908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106825130>]}
[0m20:51:43.559634 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:43.562634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:43.573181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662fd60>]}
[0m20:51:43.573792 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:51:43.574247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3e1f0>]}
[0m20:51:43.575615 [info ] [MainThread]: 
[0m20:51:43.576079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:43.576470 [info ] [MainThread]: 
[0m20:51:43.577062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:43.577988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m20:51:43.668314 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m20:51:43.668993 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m20:51:43.669531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:43.715091 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m20:51:43.716740 [debug] [ThreadPool]: On list_elt_project: Close
[0m20:51:43.722343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m20:51:43.729612 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:43.730163 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m20:51:43.730599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:43.752230 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:51:43.752790 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m20:51:43.753262 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:43.757095 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:51:43.758521 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m20:51:43.759058 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m20:51:43.764274 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.764812 [debug] [MainThread]: On master: BEGIN
[0m20:51:43.765222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:43.788662 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:51:43.789201 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.789732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:43.794592 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m20:51:43.796231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106625100>]}
[0m20:51:43.796790 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:43.797360 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.797799 [debug] [MainThread]: On master: BEGIN
[0m20:51:43.798481 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:43.798934 [debug] [MainThread]: On master: COMMIT
[0m20:51:43.799370 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.799797 [debug] [MainThread]: On master: COMMIT
[0m20:51:43.800365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:43.800847 [debug] [MainThread]: On master: Close
[0m20:51:43.802973 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m20:51:43.803674 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m20:51:43.804289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m20:51:43.804807 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m20:51:43.814006 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m20:51:43.814869 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m20:51:43.862556 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m20:51:43.863487 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.863968 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m20:51:43.864419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:43.887866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m20:51:43.888461 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.889084 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m20:51:43.896134 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:51:43.903585 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.904160 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m20:51:43.905234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:43.908949 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.909632 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m20:51:43.910734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:43.930476 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m20:51:43.931162 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.931665 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m20:51:43.932634 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m20:51:43.939680 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m20:51:43.944739 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m20:51:43.945298 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m20:51:43.947329 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:51:43.950037 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m20:51:43.951891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a68d2cb-503f-44f3-ada2-643fbb8c7e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593e280>]}
[0m20:51:43.952722 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:51:43.953446 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m20:51:43.954713 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.955341 [debug] [MainThread]: On master: BEGIN
[0m20:51:43.956495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:43.984167 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:51:43.984747 [debug] [MainThread]: On master: COMMIT
[0m20:51:43.985220 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:43.985657 [debug] [MainThread]: On master: COMMIT
[0m20:51:43.986227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:43.986697 [debug] [MainThread]: On master: Close
[0m20:51:43.987291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:43.987726 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m20:51:43.988178 [info ] [MainThread]: 
[0m20:51:43.988676 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:51:43.989557 [debug] [MainThread]: Command end result
[0m20:51:44.015830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m20:51:44.018104 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m20:51:44.025815 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m20:51:44.026324 [info ] [MainThread]: 
[0m20:51:44.026879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:44.027344 [info ] [MainThread]: 
[0m20:51:44.027838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:51:44.030721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3691359, "process_in_blocks": "0", "process_kernel_time": 0.243733, "process_mem_max_rss": "117403648", "process_out_blocks": "0", "process_user_time": 2.43996}
[0m20:51:44.031387 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:44.031254 after 1.37 seconds
[0m20:51:44.031938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104544fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dc280>]}
[0m20:51:44.032520 [debug] [MainThread]: Flushing usage events
[0m20:51:44.542908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:40.164028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d66a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106099280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106099b80>]}


============================== 21:01:40.171986 | fce4c8c6-19be-48b5-ba14-31e1aad4ea89 ==============================
[0m21:01:40.171986 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:01:40.172863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:40.391043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063322b0>]}
[0m21:01:40.457862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605afa0>]}
[0m21:01:40.459479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:01:40.595845 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:01:40.739974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:40.740497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:40.747447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:01:40.777492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d72130>]}
[0m21:01:40.859440 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:01:40.863451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:01:40.889823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d47640>]}
[0m21:01:40.890513 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:01:40.891007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95460>]}
[0m21:01:40.892597 [info ] [MainThread]: 
[0m21:01:40.893122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:01:40.893581 [info ] [MainThread]: 
[0m21:01:40.894263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:40.895321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:01:40.970325 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:01:40.970918 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:01:40.971374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:41.073238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.101 seconds
[0m21:01:41.088989 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:01:41.096167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:01:41.104763 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:01:41.105573 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:01:41.106140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:41.135653 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m21:01:41.136338 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:01:41.136903 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:01:41.147223 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m21:01:41.149337 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:01:41.150058 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:01:41.156159 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.156770 [debug] [MainThread]: On master: BEGIN
[0m21:01:41.157253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:41.184382 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m21:01:41.185212 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.185915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:01:41.195636 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m21:01:41.198192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631cf40>]}
[0m21:01:41.198884 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:41.199740 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.200320 [debug] [MainThread]: On master: BEGIN
[0m21:01:41.201113 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:01:41.201610 [debug] [MainThread]: On master: COMMIT
[0m21:01:41.202110 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.202587 [debug] [MainThread]: On master: COMMIT
[0m21:01:41.203249 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:01:41.203798 [debug] [MainThread]: On master: Close
[0m21:01:41.206955 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:01:41.207723 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:01:41.208410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:01:41.209001 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:01:41.222212 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:01:41.223623 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:01:41.271878 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:01:41.272990 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:01:41.273520 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:01:41.274017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:41.300194 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m21:01:41.300864 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:01:41.301515 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:01:41.314055 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.012 seconds
[0m21:01:41.323387 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:01:41.324120 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m21:01:41.326356 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:01:41.345131 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:01:41.345860 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:01:41.346385 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:01:41.347639 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:01:41.355880 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m21:01:41.361353 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:01:41.361997 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m21:01:41.364536 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:01:41.368056 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:01:41.370469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce4c8c6-19be-48b5-ba14-31e1aad4ea89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fb250>]}
[0m21:01:41.371392 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:01:41.372223 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:01:41.374015 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.374549 [debug] [MainThread]: On master: BEGIN
[0m21:01:41.374999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:41.403193 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m21:01:41.403885 [debug] [MainThread]: On master: COMMIT
[0m21:01:41.404416 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:41.404916 [debug] [MainThread]: On master: COMMIT
[0m21:01:41.405491 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:01:41.405984 [debug] [MainThread]: On master: Close
[0m21:01:41.406625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:41.407084 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:01:41.407583 [info ] [MainThread]: 
[0m21:01:41.408111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m21:01:41.409189 [debug] [MainThread]: Command end result
[0m21:01:41.506420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:01:41.508550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:01:41.517553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:01:41.518209 [info ] [MainThread]: 
[0m21:01:41.518884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:41.519466 [info ] [MainThread]: 
[0m21:01:41.520086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:01:41.524383 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4496347, "process_in_blocks": "0", "process_kernel_time": 0.391762, "process_mem_max_rss": "114126848", "process_out_blocks": "0", "process_user_time": 2.506474}
[0m21:01:41.525142 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:41.524978 after 1.45 seconds
[0m21:01:41.525789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d66a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039dcf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107332760>]}
[0m21:01:41.526434 [debug] [MainThread]: Flushing usage events
[0m21:01:42.285574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:08.940552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a32a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d662b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d66bb0>]}


============================== 21:09:08.946124 | cf1d530e-441b-4c7e-81c0-53b3d404560d ==============================
[0m21:09:08.946124 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:09:08.946922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select airbnb_transformed', 'send_anonymous_usage_stats': 'True'}
[0m21:09:09.143459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800b8b0>]}
[0m21:09:09.208458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff0d00>]}
[0m21:09:09.209930 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:09:09.346274 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:09:09.477728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:09.478801 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:09:09.735832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:09:09.741507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfd130>]}
[0m21:09:09.817665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:09:09.821501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:09:09.843957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc0bb0>]}
[0m21:09:09.844759 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:09:09.845268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdd0a0>]}
[0m21:09:09.846782 [info ] [MainThread]: 
[0m21:09:09.847281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:09:09.847715 [info ] [MainThread]: 
[0m21:09:09.848369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:09:09.849427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:09:09.973637 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:09:09.974468 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:09:09.975074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:10.024153 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m21:09:10.026208 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:09:10.033039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:09:10.041990 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:09:10.042632 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:09:10.043122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:10.070470 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m21:09:10.071164 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:09:10.071705 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:09:10.076142 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:09:10.077908 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:09:10.078609 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:09:10.084669 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.085304 [debug] [MainThread]: On master: BEGIN
[0m21:09:10.085803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:10.109573 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:09:10.110305 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.110890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:09:10.115356 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:09:10.116998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089faee0>]}
[0m21:09:10.117623 [debug] [MainThread]: On master: ROLLBACK
[0m21:09:10.118238 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.118694 [debug] [MainThread]: On master: BEGIN
[0m21:09:10.119414 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:09:10.119902 [debug] [MainThread]: On master: COMMIT
[0m21:09:10.120372 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.120869 [debug] [MainThread]: On master: COMMIT
[0m21:09:10.121463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:10.121940 [debug] [MainThread]: On master: Close
[0m21:09:10.125725 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:09:10.126562 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:09:10.127284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:09:10.127820 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:09:10.138725 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:09:10.139873 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:09:10.185207 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:09:10.186276 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:09:10.186832 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:09:10.187350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:09:10.211155 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m21:09:10.211782 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:09:10.212416 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where id is not null
        and name is not null
        and price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:09:10.216918 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:09:10.224120 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:09:10.224649 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m21:09:10.225659 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:10.242998 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:09:10.243694 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:09:10.244201 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:09:10.245439 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:09:10.252924 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m21:09:10.258386 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:09:10.259005 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m21:09:10.259781 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:09:10.262654 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:09:10.264967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf1d530e-441b-4c7e-81c0-53b3d404560d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d239a0>]}
[0m21:09:10.265867 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:09:10.266629 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:09:10.268029 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.268500 [debug] [MainThread]: On master: BEGIN
[0m21:09:10.268918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:09:10.294716 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m21:09:10.295526 [debug] [MainThread]: On master: COMMIT
[0m21:09:10.296060 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:10.296542 [debug] [MainThread]: On master: COMMIT
[0m21:09:10.297284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:10.297876 [debug] [MainThread]: On master: Close
[0m21:09:10.298604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:10.299207 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:09:10.299739 [info ] [MainThread]: 
[0m21:09:10.300282 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:09:10.301269 [debug] [MainThread]: Command end result
[0m21:09:10.331799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:09:10.334049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:09:10.342172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:09:10.342698 [info ] [MainThread]: 
[0m21:09:10.343262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:10.343755 [info ] [MainThread]: 
[0m21:09:10.344245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:09:10.349262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4931617, "process_in_blocks": "0", "process_kernel_time": 0.360257, "process_mem_max_rss": "118501376", "process_out_blocks": "0", "process_user_time": 2.645788}
[0m21:09:10.350217 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:10.350044 after 1.49 seconds
[0m21:09:10.350913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a32a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc57f0>]}
[0m21:09:10.351566 [debug] [MainThread]: Flushing usage events
[0m21:09:11.044012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:34.357455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe30a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111632b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111163bb0>]}


============================== 21:16:34.363228 | 308a553f-ee9a-4223-8c3f-043eaf1be3e1 ==============================
[0m21:16:34.363228 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:16:34.364013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select airbnb_transformed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:34.573649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110faa0d0>]}
[0m21:16:34.640123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f8940>]}
[0m21:16:34.641529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:34.774525 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:16:34.917176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:34.917864 [debug] [MainThread]: Partial parsing: updated file: first_elt://./first_elt/models/airbnb_transformed.sql
[0m21:16:35.174820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m21:16:35.180693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffb130>]}
[0m21:16:35.259196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:16:35.263046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:16:35.283888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e05d60>]}
[0m21:16:35.284635 [info ] [MainThread]: Found 2 models, 433 macros
[0m21:16:35.285139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114131f0>]}
[0m21:16:35.286646 [info ] [MainThread]: 
[0m21:16:35.287136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:35.287561 [info ] [MainThread]: 
[0m21:16:35.288295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:35.289495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m21:16:35.419081 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m21:16:35.419766 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m21:16:35.420293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:35.471774 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m21:16:35.473817 [debug] [ThreadPool]: On list_elt_project: Close
[0m21:16:35.480107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m21:16:35.488597 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:16:35.489285 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m21:16:35.489807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:35.516511 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m21:16:35.517147 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m21:16:35.517678 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:16:35.522285 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:16:35.524084 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m21:16:35.524742 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m21:16:35.530756 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.531365 [debug] [MainThread]: On master: BEGIN
[0m21:16:35.531850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:35.557797 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m21:16:35.558596 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.559210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:35.567619 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m21:16:35.569594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f97c10>]}
[0m21:16:35.570239 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:35.570924 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.571429 [debug] [MainThread]: On master: BEGIN
[0m21:16:35.572228 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:16:35.572767 [debug] [MainThread]: On master: COMMIT
[0m21:16:35.573268 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.573744 [debug] [MainThread]: On master: COMMIT
[0m21:16:35.574338 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:35.574838 [debug] [MainThread]: On master: Close
[0m21:16:35.578029 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m21:16:35.578817 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m21:16:35.579525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m21:16:35.580135 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m21:16:35.591588 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m21:16:35.592686 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m21:16:35.644232 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m21:16:35.645769 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.646366 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m21:16:35.646888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:16:35.672489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m21:16:35.673204 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.673849 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where 
        name is not null
        and price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m21:16:35.678564 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:16:35.686862 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.687519 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed" rename to "airbnb_transformed__dbt_backup"
[0m21:16:35.688919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:16:35.693029 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.693610 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m21:16:35.694787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:16:35.715371 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:16:35.716059 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.716575 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m21:16:35.717702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:16:35.725232 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m21:16:35.730321 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m21:16:35.730905 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m21:16:35.733118 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m21:16:35.736122 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m21:16:35.738452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308a553f-ee9a-4223-8c3f-043eaf1be3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111117f0>]}
[0m21:16:35.739395 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:16:35.740277 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m21:16:35.741542 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.742004 [debug] [MainThread]: On master: BEGIN
[0m21:16:35.742430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:35.773740 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m21:16:35.775099 [debug] [MainThread]: On master: COMMIT
[0m21:16:35.775770 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:35.776297 [debug] [MainThread]: On master: COMMIT
[0m21:16:35.777042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:35.777599 [debug] [MainThread]: On master: Close
[0m21:16:35.778291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:35.778768 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m21:16:35.779278 [info ] [MainThread]: 
[0m21:16:35.779826 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m21:16:35.780862 [debug] [MainThread]: Command end result
[0m21:16:35.811949 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m21:16:35.814659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m21:16:35.824218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m21:16:35.825191 [info ] [MainThread]: 
[0m21:16:35.825870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:35.826369 [info ] [MainThread]: 
[0m21:16:35.826893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:16:35.831443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.565727, "process_in_blocks": "0", "process_kernel_time": 0.375171, "process_mem_max_rss": "117084160", "process_out_blocks": "0", "process_user_time": 2.694037}
[0m21:16:35.832444 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:35.832271 after 1.57 seconds
[0m21:16:35.833095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe30a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f83da30>]}
[0m21:16:35.833718 [debug] [MainThread]: Flushing usage events
[0m21:16:36.499570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:19.077782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fa280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fab80>]}


============================== 16:05:19.084971 | cabfdc8b-1631-4cfb-867d-b53578be1596 ==============================
[0m16:05:19.084971 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:05:19.086155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mac/Documents/Projets/DE/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select airbnb_transformed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:19.454356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b0b50>]}
[0m16:05:19.579810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0b7c0>]}
[0m16:05:19.582527 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:05:19.779810 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:05:19.991754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:19.992575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:20.006217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.first_elt.example
[0m16:05:20.059131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd3130>]}
[0m16:05:20.246800 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m16:05:20.253739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m16:05:20.300179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa75e0>]}
[0m16:05:20.301111 [info ] [MainThread]: Found 2 models, 433 macros
[0m16:05:20.301938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a5310>]}
[0m16:05:20.304020 [info ] [MainThread]: 
[0m16:05:20.304703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:20.305301 [info ] [MainThread]: 
[0m16:05:20.306268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:20.307719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_elt_project'
[0m16:05:20.445366 [debug] [ThreadPool]: Using postgres connection "list_elt_project"
[0m16:05:20.446113 [debug] [ThreadPool]: On list_elt_project: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project"} */

    select distinct nspname from pg_namespace
  
[0m16:05:20.446731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:20.506692 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m16:05:20.508780 [debug] [ThreadPool]: On list_elt_project: Close
[0m16:05:20.515671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_elt_project, now list_elt_project_public)
[0m16:05:20.525060 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m16:05:20.525681 [debug] [ThreadPool]: On list_elt_project_public: BEGIN
[0m16:05:20.526258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:20.556301 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:05:20.557057 [debug] [ThreadPool]: Using postgres connection "list_elt_project_public"
[0m16:05:20.557686 [debug] [ThreadPool]: On list_elt_project_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "list_elt_project_public"} */
select
      'elt_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'elt_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:05:20.573600 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m16:05:20.575620 [debug] [ThreadPool]: On list_elt_project_public: ROLLBACK
[0m16:05:20.576422 [debug] [ThreadPool]: On list_elt_project_public: Close
[0m16:05:20.583179 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.583791 [debug] [MainThread]: On master: BEGIN
[0m16:05:20.584356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:20.614161 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:05:20.614935 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.615687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:20.626141 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:05:20.628165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bbac0>]}
[0m16:05:20.628962 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:20.629784 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.630405 [debug] [MainThread]: On master: BEGIN
[0m16:05:20.631332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:05:20.631984 [debug] [MainThread]: On master: COMMIT
[0m16:05:20.632593 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.633178 [debug] [MainThread]: On master: COMMIT
[0m16:05:20.633969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:20.634609 [debug] [MainThread]: On master: Close
[0m16:05:20.639124 [debug] [Thread-1  ]: Began running node model.first_elt.airbnb_transformed
[0m16:05:20.640077 [info ] [Thread-1  ]: 1 of 1 START sql view model public.airbnb_transformed .......................... [RUN]
[0m16:05:20.640933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_elt_project_public, now model.first_elt.airbnb_transformed)
[0m16:05:20.641631 [debug] [Thread-1  ]: Began compiling node model.first_elt.airbnb_transformed
[0m16:05:20.655380 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_elt.airbnb_transformed"
[0m16:05:20.657514 [debug] [Thread-1  ]: Began executing node model.first_elt.airbnb_transformed
[0m16:05:20.713203 [debug] [Thread-1  ]: Writing runtime sql for node "model.first_elt.airbnb_transformed"
[0m16:05:20.715492 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m16:05:20.716292 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: BEGIN
[0m16:05:20.716943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:05:20.746770 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m16:05:20.747569 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m16:05:20.748384 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */

  create view "elt_project"."public"."airbnb_transformed__dbt_tmp"
    
    
  as (
    with source as (
    select * from "elt_project"."public"."airbnb_data"
),

cleaned as (
    select
        name,
        cast("host id" as bigint) as host_id,
        coalesce(cast("host_identity_verified" as varchar(25)), 'unconfirmed') as is_host_verified ,-- No need to COALESCE again
        cast("host name" as varchar(25)) as host_name,
        cast("neighbourhood group" as varchar(50)) as neighborhood_group,
        cast(neighbourhood as varchar(100)) as neighborhood,
        cast(lat as numeric(9,6)) as latitude,
        cast(long as numeric(9,6)) as longitude, -- Renamed
        coalesce(instant_bookable, false) as is_instant_bookable,  -- Replaced NULL with false (boolean column)
        cast(cancellation_policy as varchar(50)) as cancellation_policy,
        cast("room type" as varchar(50)) as room_type,
        cast(cast("Construction year" as numeric )as integer) as construction_year,
        cast(replace(replace(price, ',', ''), '$', '') as INTEGER) as price,
        cast(coalesce(replace(replace("service fee", ',', ''), '$', ''), '0') as INTEGER) as service_fee,
        case
            when cast("minimum nights" as integer ) <0 then 1
            else coalesce(cast("minimum nights" as integer), 1) -- Replaced NULL with 1
        end as minimum_nights,
        coalesce(cast("number of reviews" as integer), 0) as review_count,  -- Replaced NULL with 0
        coalesce(cast("review rate number" as INTEGER ) ,0) as review_rating,  -- Replaced NULL with 0
        coalesce(cast("calculated host listings count" as integer), 1) as host_listings_count,  -- Replaced NULL with 1
        case
            when cast("availability 365"  as integer ) < 0 then 1
            when cast("availability 365"  as integer )  > 365 then 365
            else coalesce(cast("availability 365"  as integer ) , 1)
        end as availability_365,
        regexp_replace(coalesce(house_rules, 'No rules'), '^[^a-zA-Z]+', '') as house_rules -- Symbols at the Beginning removed and null values replaced
    from source
    where 
        name is not null
        and price is not null
        and cancellation_policy is not null
        and "neighbourhood group" is not null
        and neighbourhood is not null
        and "room type" is not null
        and "host name" is not null
        and "Construction year" is not null
        and "host id" is not null
        and lat is not null
        and long is not null
)

select * from cleaned
  );
[0m16:05:20.767413 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.018 seconds
[0m16:05:20.778363 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m16:05:20.779200 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
alter table "elt_project"."public"."airbnb_transformed__dbt_tmp" rename to "airbnb_transformed"
[0m16:05:20.781834 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:05:20.804814 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m16:05:20.805618 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m16:05:20.806292 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: COMMIT
[0m16:05:20.807624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m16:05:20.817421 [debug] [Thread-1  ]: Applying DROP to: "elt_project"."public"."airbnb_transformed__dbt_backup"
[0m16:05:20.824363 [debug] [Thread-1  ]: Using postgres connection "model.first_elt.airbnb_transformed"
[0m16:05:20.825087 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "first_elt", "target_name": "dev", "node_id": "model.first_elt.airbnb_transformed"} */
drop view if exists "elt_project"."public"."airbnb_transformed__dbt_backup" cascade
[0m16:05:20.828045 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m16:05:20.832177 [debug] [Thread-1  ]: On model.first_elt.airbnb_transformed: Close
[0m16:05:20.835346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabfdc8b-1631-4cfb-867d-b53578be1596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845a2b0>]}
[0m16:05:20.836467 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.airbnb_transformed ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m16:05:20.837520 [debug] [Thread-1  ]: Finished running node model.first_elt.airbnb_transformed
[0m16:05:20.839226 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.839854 [debug] [MainThread]: On master: BEGIN
[0m16:05:20.840421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:20.871938 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m16:05:20.872653 [debug] [MainThread]: On master: COMMIT
[0m16:05:20.873259 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:20.873841 [debug] [MainThread]: On master: COMMIT
[0m16:05:20.874621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:05:20.875246 [debug] [MainThread]: On master: Close
[0m16:05:20.876010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:20.876632 [debug] [MainThread]: Connection 'model.first_elt.airbnb_transformed' was properly closed.
[0m16:05:20.877266 [info ] [MainThread]: 
[0m16:05:20.878045 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:05:20.879329 [debug] [MainThread]: Command end result
[0m16:05:20.962800 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Documents/Projets/DE/target/manifest.json
[0m16:05:20.964979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Documents/Projets/DE/target/semantic_manifest.json
[0m16:05:20.975498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Documents/Projets/DE/target/run_results.json
[0m16:05:20.976139 [info ] [MainThread]: 
[0m16:05:20.976869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:20.977473 [info ] [MainThread]: 
[0m16:05:20.978111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:20.986838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.035027, "process_in_blocks": "0", "process_kernel_time": 0.637486, "process_mem_max_rss": "114679808", "process_out_blocks": "0", "process_user_time": 3.434382}
[0m16:05:20.987729 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:20.987552 after 2.04 seconds
[0m16:05:20.988444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753bb50>]}
[0m16:05:20.989155 [debug] [MainThread]: Flushing usage events
[0m16:05:26.079824 [debug] [MainThread]: An error was encountered while trying to flush usage events
